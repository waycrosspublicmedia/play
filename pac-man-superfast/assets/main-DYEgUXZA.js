const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./browserAll-DneycU_B.js","./webworkerAll-B02ObO6x.js","./colorToUniform-Crx8K7LV.js","./getBatchSamplersUniformGroup-BRQqWQG9.js","./WebGPURenderer-BVrGIWip.js","./SharedSystems-5HIAtXJs.js","./WebGLRenderer-BFsvZTE6.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=t(s);fetch(s.href,n)}})();var Ct=(r=>(r[r.ROOT=0]="ROOT",r[r.SKIN=10]="SKIN",r[r.SPEED=11]="SPEED",r[r.STATE=100]="STATE",r[r.GAME=1e3]="GAME",r[r.CONGRA=1001]="CONGRA",r[r.SKIN_MENU=1e4]="SKIN_MENU",r))(Ct||{});globalThis.tileSize=8;globalThis.mapRows=36;globalThis.mapCols=28;globalThis.mapMargin=5;globalThis.mapCalibTop=105;globalThis.mapPad=tileSize/8;globalThis.mapWidth=mapCols*tileSize+mapPad*2;globalThis.mapHeight=mapRows*tileSize+mapPad*2;globalThis.skinWidth=720;globalThis.skinHeight=1600;globalThis.skinAspectRatio=1600/720;globalThis.skinMarginT=160;globalThis.skinScorePanelT=skinMarginT+65;globalThis.skinScorePanelH=130;globalThis.skinScorePanelB=skinScorePanelT+skinScorePanelH;globalThis.skinMainPanelT=skinScorePanelB+30;globalThis.skinMainPanelW=700;globalThis.skinMainPanelH=865;globalThis.skinMainPanelL=10;globalThis.skinMainPanelB=skinMainPanelT+skinMainPanelH;globalThis.screenWidth=mapWidth+mapMargin*2;globalThis.screenHeight=mapHeight+mapMargin*2;globalThis.g_coeffSkinToMap=screenWidth/skinWidth;globalThis.g_coeffMapToSkin=skinWidth/screenWidth;globalThis.renderScale=g_coeffMapToSkin;function Z(r){return r*g_coeffSkinToMap}function gr(r){return r*g_coeffSkinToMap*renderScale}function rs(r){return(r+mapMargin+mapPad+1)*renderScale}function ns(r){return(r+mapMargin+mapPad+mapCalibTop)*renderScale}globalThis.RF_PACMAN_VERSION="11/15/2024";globalThis.RF_FONT_FAMILY="Lexend Deca";globalThis.RF_FONT_SCALE_X=1.3;globalThis.RF_FONT_SCALE_Y=1.3;globalThis.RF_FONT_MARGIN_Y=-2.3;globalThis.RF_FONT_LETTER_SPACING=2;globalThis.RF_EXTRA_LIVES=5;globalThis.RF_EXTRA_LIVE_POINT=5e3;globalThis.RF_EXTRA_LIVE_ANI_BLINK_SPAN=12;globalThis.RF_FADE_DURATION=30;globalThis.RF_INPUT_QUEUE=!0;globalThis.RF_PELLET_COUNTER_LIFE_IN_FRAMES=30;globalThis.RF_PELLET_COUNTER_FONT_SIZE=12;globalThis.RF_PELLET_COUNTER_COUNT=5;globalThis.RF_ENERGIZER_DURATIONS=[6,5,4.5,4,3.7,3,3.5,3,3,2,2,1,1,1,1,1,1,1];globalThis.RF_MAX_HIGH_SCORE_COUNT=100;globalThis.RF_POWER_PELLET_BLINKING_PERIOD_IN_FRAMES=20;globalThis.RF_SPEED_BOOST_SPOOL_UP_TIME=14e3;globalThis.RF_SPEED_BOOST_ANIMATION_TIME=40;globalThis.RF_DEBUG_CLEAR_BY_10_DOTS=!1;globalThis.RF_DEBUG_FRUIT_WIN=!1;globalThis.RF_DEBUG_PACMAN_INVINCIBLE=!1;globalThis.RF_DEBUG_ACTOR_LAYER_GREEN_BG=!1;globalThis.RF_DEBUG_CONFIG_KEYS=!1;globalThis.RF_SPEED_RATIO_FROM_LEVEL=[1,1.02,1.04,1.06,1.11,1.16,1.2,1.24,1.3,1.35,1.4,1.45,1.5,1.52,1.55];globalThis.RF_SPEED_NOTICE_FROM_LEVEL=["EASY","STEADY","BRISK","FAST","VERY FAST","SUPER FAST","CRAZY","INSANE","MANIAC","MANIAC+","MANIAC++","MANIAC+++","DOOM","DOOM+","DOOM++"];globalThis.RF_FRUIT_ALL_EATEN_PRISE=2e4;globalThis.RF_FRUIT_GEN_DOT_LIMIT_LIST=[25,100,180];globalThis.RF_FRUIT_POINTS=[1e3,1200,1500,1800,2e3,2300,2700,3e3,3300,3800,4e3,4500,0];globalThis.DIR_UP=0;globalThis.DIR_LEFT=1;globalThis.DIR_DOWN=2;globalThis.DIR_RIGHT=3;const cd=r=>-r*Math.PI/2,ud=r=>(r+1)%4,dd=r=>(r+3)%4,Br=r=>(r+2)%4,fd=r=>r.x===-1?DIR_LEFT:r.x===1?DIR_RIGHT:r.y===-1?DIR_UP:DIR_DOWN;function Bi(r,e){const t=fd(r)!==e;if(e===DIR_UP)r.x=0,r.y=-1;else if(e===DIR_RIGHT)r.x=1,r.y=0;else if(e===DIR_DOWN)r.x=0,r.y=1;else if(e===DIR_LEFT)r.x=-1,r.y=0;else throw new Error("invalid dirEnum");return t}const nl=(r,e,t)=>{let i,s,n,a=1/0,o={x:0,y:0},l=0;for(let c=0;c<4;c++)t[c]&&(Bi(o,c),i=o.x+r.x-e.x,s=o.y+r.y-e.y,n=i*i+s*s,n<a&&(a=n,l=c));return l},al=(r,e)=>{var t=[!1,!1,!1,!1];t[DIR_UP]=map.isFloorTile(r.x,r.y-1),t[DIR_RIGHT]=map.isFloorTile(r.x+1,r.y),t[DIR_DOWN]=map.isFloorTile(r.x,r.y+1),t[DIR_LEFT]=map.isFloorTile(r.x-1,r.y);let i=0;if(e!==void 0){for(let n=0;n<4;n++)t[n]&&i++;var s=Br(e);i>1&&(t[s]=!1)}return t},Xo=(r,e)=>map.isFloorTile(r.x+e.x,r.y+e.y);globalThis.midTile={x:3,y:4};class pd{constructor(e,t,i){this.timeEaten={},this.dotsEaten=0,this.numDots=0,this.numEnergizers=0,this.energizers=[],this.paths=[],this.tunnelRows={},this.numCols=e,this.numRows=t,this.numTiles=e*t,this.widthPixels=e*tileSize,this.heightPixels=t*tileSize,this.tiles=i,this.doorTile={x:13,y:14},this.doorPixel={x:(this.doorTile.x+1)*tileSize-1,y:this.doorTile.y*tileSize+midTile.y},this.homeTopPixel=17*tileSize,this.homeBottomPixel=18*tileSize,this.resetCurrent(),this.parseDots(),this.parseTunnels(),this.parseWalls()}resetTimeEaten(){this.startTiles=[...this.currentTiles]}resetCurrent(){this.currentTiles=this.tiles.split(""),this.dotsEaten=0}parseWalls(){const e={},t={},i=(a,o)=>{if(a>=-2&&a<this.numCols+2&&o>=0&&o<this.numRows)return a+2+o*(this.numCols+4)};let s=0;for(let a=0;a<this.numRows;a++)for(let o=-2;o<this.numCols+2;o++,s++)this.getTile(o,a)==="|"&&(this.getTile(o-1,a)!=="|"||this.getTile(o+1,a)!=="|"||this.getTile(o,a-1)!=="|"||this.getTile(o,a+1)!=="|"||this.getTile(o-1,a-1)!=="|"||this.getTile(o-1,a+1)!=="|"||this.getTile(o+1,a-1)!=="|"||this.getTile(o+1,a+1)!=="|")&&(t[s]=!0);const n=(a,o)=>{let l={x:0,y:0},c;var u=i(a+1,o),h=i(a,o+1);if(u!==void 0&&u in t)c=DIR_RIGHT;else if(h!==void 0&&h in t)c=DIR_DOWN;else throw`Tile shouldn't be 1x1 at ${a},${o}`;Bi(l,c),a+=l.x,o+=l.y;const d=a,f=o,p=c,_=[];let g,m,x,S=!1,w=!1;const A=(k,P,E)=>{const b={x:0,y:0};Bi(b,E),i(k+b.y,P-b.x)in t?g=0:g=this.isFloorTile(k+b.y,P-b.x)?5:0;const M=-tileSize/2+g,N=tileSize/2,H=cd(E),L=Math.cos(H),F=Math.sin(H);return{x:M*L-N*F+(k+.5)*tileSize,y:M*F+N*L+(P+.5)*tileSize}};for(;;)if(e[i(a,o)]=!0,m=A(a,o,c),S&&(x=_[_.length-1],l.x===0?(m.cx=m.x,m.cy=x.y):(m.cx=x.x,m.cy=m.y)),S=!1,w=!1,i(a+l.y,o-l.x)in t?(c=ud(c),S=!0):i(a+l.x,o+l.y)in t||(i(a-l.y,o+l.x)in t?(c=dd(c),S=!0):(c=Br(c),w=!0)),Bi(l,c),_.push(m),w&&(_.push(A(a-l.x,o-l.y,Br(c))),_.push(A(a,o,c))),a+=l.x,o+=l.y,a===d&&o===f&&c===p){this.paths.push(_);break}};s=0;for(let a=0;a<this.numRows;a++)for(let o=-2;o<this.numCols+2;o++,s++)s in t&&!(s in e)&&(e[s]=!0,n(o,a))}parseDots(){this.numDots=0,this.numEnergizers=0,this.energizers=[];let e=0;for(let t=0;t<this.numRows;t++)for(let i=0;i<this.numCols;i++){const s=this.tiles[e];s==="."?this.numDots++:s==="o"&&(this.numDots++,this.numEnergizers++,this.energizers.push({x:i,y:t})),e++}}dotsLeft(){return RF_DEBUG_CLEAR_BY_10_DOTS&&this.dotsEaten>9?0:this.numDots-this.dotsEaten}allDotsEaten(){return this.dotsLeft()===0}parseTunnels(){const e=(i,s,n)=>{for(;!this.isFloorTile(i,s-1)&&!this.isFloorTile(i,s+1)&&this.isFloorTile(i,s);)i+=n;return i};this.tunnelRows={};for(let i=0;i<this.numRows;i++)this.isFloorTile(0,i)&&this.isFloorTile(this.numCols-1,i)&&(this.tunnelRows[i]={leftEntrance:e.call(this,0,i,1),rightEntrance:e.call(this,this.numCols-1,i,-1),leftExit:-2*tileSize,rightExit:(this.numCols+2)*tileSize-1})}teleport(e){const t=this.tunnelRows[e.tile.y];t&&(e.pixel.x<t.leftExit?e.pixel.x=t.rightExit:e.pixel.x>t.rightExit&&(e.pixel.x=t.leftExit))}posToIndex(e,t){if(e>=0&&e<this.numCols&&t>=0&&t<this.numRows)return e+t*this.numCols}isTunnelTile(e,t){const i=this.tunnelRows[t];return i&&(e<i.leftEntrance||e>i.rightEntrance)}getTile(e,t){if(e>=0&&e<this.numCols&&t>=0&&t<this.numRows)return this.currentTiles[this.posToIndex(e,t)];if((e<0||e>=this.numCols)&&(this.isTunnelTile(e,t-1)||this.isTunnelTile(e,t+1)))return"|";if(this.isTunnelTile(e,t))return" "}isFloorTileChar(e){return e===" "||e==="."||e==="o"}isFloorTile(e,t){return this.isFloorTileChar(this.getTile(e,t))}onDotEat(e,t){this.dotsEaten++;const i=this.posToIndex(e,t);i!==void 0&&(this.currentTiles[i]=" ",renderer.erasePellet(e,t))}constrainGhostTurns(e,t){(e.x===12||e.x===15)&&(e.y===14||e.y===26)&&(t[DIR_UP]=!1)}}globalThis.mapPacman=new pd(28,36,"____________________________________________________________________________________|||||||||||||||||||||||||||||............||............||.||||.|||||.||.|||||.||||.||o||||.|||||.||.|||||.||||o||.||||.|||||.||.|||||.||||.||..........................||.||||.||.||||||||.||.||||.||.||||.||.||||||||.||.||||.||......||....||....||......|||||||.||||| || |||||.||||||_____|.||||| || |||||.|__________|.||          ||.|__________|.|| |||--||| ||.|_____||||||.|| |______| ||.||||||      .   |______|   .      ||||||.|| |______| ||.||||||_____|.|| |||||||| ||.|__________|.||          ||.|__________|.|| |||||||| ||.|_____||||||.|| |||||||| ||.|||||||............||............||.||||.|||||.||.|||||.||||.||.||||.|||||.||.|||||.||||.||o..||.......  .......||..o||||.||.||.||||||||.||.||.||||||.||.||.||||||||.||.||.||||......||....||....||......||.||||||||||.||.||||||||||.||.||||||||||.||.||||||||||.||..........................|||||||||||||||||||||||||||||________________________________________________________");var Gi={},ol={},Jt={};Object.defineProperty(Jt,"__esModule",{value:!0});Jt.loop=Jt.conditional=Jt.parse=void 0;var _d=function r(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:i;if(Array.isArray(t))t.forEach(function(a){return r(e,a,i,s)});else if(typeof t=="function")t(e,i,s,r);else{var n=Object.keys(t)[0];Array.isArray(t[n])?(s[n]={},r(e,t[n],i,s[n])):s[n]=t[n](e,i,s,r)}return i};Jt.parse=_d;var gd=function(e,t){return function(i,s,n,a){t(i,s,n)&&a(i,e,s,n)}};Jt.conditional=gd;var md=function(e,t){return function(i,s,n,a){for(var o=[],l=i.pos;t(i,s,n);){var c={};if(a(i,e,s,c),i.pos===l)break;l=i.pos,o.push(c)}return o}};Jt.loop=md;var we={};Object.defineProperty(we,"__esModule",{value:!0});we.readBits=we.readArray=we.readUnsigned=we.readString=we.peekBytes=we.readBytes=we.peekByte=we.readByte=we.buildStream=void 0;var xd=function(e){return{data:e,pos:0}};we.buildStream=xd;var hl=function(){return function(e){return e.data[e.pos++]}};we.readByte=hl;var yd=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return function(t){return t.data[t.pos+e]}};we.peekByte=yd;var Qr=function(e){return function(t){return t.data.subarray(t.pos,t.pos+=e)}};we.readBytes=Qr;var Sd=function(e){return function(t){return t.data.subarray(t.pos,t.pos+e)}};we.peekBytes=Sd;var Td=function(e){return function(t){return Array.from(Qr(e)(t)).map(function(i){return String.fromCharCode(i)}).join("")}};we.readString=Td;var wd=function(e){return function(t){var i=Qr(2)(t);return e?(i[1]<<8)+i[0]:(i[0]<<8)+i[1]}};we.readUnsigned=wd;var vd=function(e,t){return function(i,s,n){for(var a=typeof t=="function"?t(i,s,n):t,o=Qr(e),l=new Array(a),c=0;c<a;c++)l[c]=o(i);return l}};we.readArray=vd;var bd=function(e,t,i){for(var s=0,n=0;n<i;n++)s+=e[t+n]&&Math.pow(2,i-n-1);return s},Ad=function(e){return function(t){for(var i=hl()(t),s=new Array(8),n=0;n<8;n++)s[7-n]=!!(i&1<<n);return Object.keys(e).reduce(function(a,o){var l=e[o];return l.length?a[o]=bd(s,l.index,l.length):a[o]=s[l.index],a},{})}};we.readBits=Ad;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var e=Jt,t=we,i={blocks:function(d){for(var f=0,p=[],_=d.data.length,g=0,m=(0,t.readByte)()(d);m!==f&&m;m=(0,t.readByte)()(d)){if(d.pos+m>=_){var x=_-d.pos;p.push((0,t.readBytes)(x)(d)),g+=x;break}p.push((0,t.readBytes)(m)(d)),g+=m}for(var S=new Uint8Array(g),w=0,A=0;A<p.length;A++)S.set(p[A],w),w+=p[A].length;return S}},s=(0,e.conditional)({gce:[{codes:(0,t.readBytes)(2)},{byteSize:(0,t.readByte)()},{extras:(0,t.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,t.readUnsigned)(!0)},{transparentColorIndex:(0,t.readByte)()},{terminator:(0,t.readByte)()}]},function(h){var d=(0,t.peekBytes)(2)(h);return d[0]===33&&d[1]===249}),n=(0,e.conditional)({image:[{code:(0,t.readByte)()},{descriptor:[{left:(0,t.readUnsigned)(!0)},{top:(0,t.readUnsigned)(!0)},{width:(0,t.readUnsigned)(!0)},{height:(0,t.readUnsigned)(!0)},{lct:(0,t.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,e.conditional)({lct:(0,t.readArray)(3,function(h,d,f){return Math.pow(2,f.descriptor.lct.size+1)})},function(h,d,f){return f.descriptor.lct.exists}),{data:[{minCodeSize:(0,t.readByte)()},i]}]},function(h){return(0,t.peekByte)()(h)===44}),a=(0,e.conditional)({text:[{codes:(0,t.readBytes)(2)},{blockSize:(0,t.readByte)()},{preData:function(d,f,p){return(0,t.readBytes)(p.text.blockSize)(d)}},i]},function(h){var d=(0,t.peekBytes)(2)(h);return d[0]===33&&d[1]===1}),o=(0,e.conditional)({application:[{codes:(0,t.readBytes)(2)},{blockSize:(0,t.readByte)()},{id:function(d,f,p){return(0,t.readString)(p.blockSize)(d)}},i]},function(h){var d=(0,t.peekBytes)(2)(h);return d[0]===33&&d[1]===255}),l=(0,e.conditional)({comment:[{codes:(0,t.readBytes)(2)},i]},function(h){var d=(0,t.peekBytes)(2)(h);return d[0]===33&&d[1]===254}),c=[{header:[{signature:(0,t.readString)(3)},{version:(0,t.readString)(3)}]},{lsd:[{width:(0,t.readUnsigned)(!0)},{height:(0,t.readUnsigned)(!0)},{gct:(0,t.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,t.readByte)()},{pixelAspectRatio:(0,t.readByte)()}]},(0,e.conditional)({gct:(0,t.readArray)(3,function(h,d){return Math.pow(2,d.lsd.gct.size+1)})},function(h,d){return d.lsd.gct.exists}),{frames:(0,e.loop)([s,o,l,n,a],function(h){var d=(0,t.peekByte)()(h);return d===33||d===44})}],u=c;r.default=u})(ol);var Jr={};Object.defineProperty(Jr,"__esModule",{value:!0});Jr.deinterlace=void 0;var Pd=function(e,t){for(var i=new Array(e.length),s=e.length/t,n=function(d,f){var p=e.slice(f*t,(f+1)*t);i.splice.apply(i,[d*t,t].concat(p))},a=[0,4,2,1],o=[8,8,4,2],l=0,c=0;c<4;c++)for(var u=a[c];u<s;u+=o[c])n(u,l),l++;return i};Jr.deinterlace=Pd;var en={};Object.defineProperty(en,"__esModule",{value:!0});en.lzw=void 0;var kd=function(e,t,i){var s=4096,n=-1,a=i,o,l,c,u,h,d,f,k,p,_,A,g,P,E,M,b,m=new Array(i),x=new Array(s),S=new Array(s),w=new Array(s+1);for(g=e,l=1<<g,h=l+1,o=l+2,f=n,u=g+1,c=(1<<u)-1,p=0;p<l;p++)x[p]=0,S[p]=p;var A,k,P,E,b,M;for(A=k=P=E=b=M=0,_=0;_<a;){if(E===0){if(k<u){A+=t[M]<<k,k+=8,M++;continue}if(p=A&c,A>>=u,k-=u,p>o||p==h)break;if(p==l){u=g+1,c=(1<<u)-1,o=l+2,f=n;continue}if(f==n){w[E++]=S[p],f=p,P=p;continue}for(d=p,p==o&&(w[E++]=P,p=f);p>l;)w[E++]=S[p],p=x[p];P=S[p]&255,w[E++]=P,o<s&&(x[o]=f,S[o]=P,o++,!(o&c)&&o<s&&(u++,c+=o)),f=d}E--,m[b++]=w[E],_++}for(_=b;_<a;_++)m[_]=0;return m};en.lzw=kd;Object.defineProperty(Gi,"__esModule",{value:!0});var ll=Gi.decompressFrames=Gi.decompressFrame=cl=Gi.parseGIF=void 0,Ed=Ld(ol),Cd=Jt,Md=we,Id=Jr,Rd=en;function Ld(r){return r&&r.__esModule?r:{default:r}}var Fd=function(e){var t=new Uint8Array(e);return(0,Cd.parse)((0,Md.buildStream)(t),Ed.default)},cl=Gi.parseGIF=Fd,Od=function(e){for(var t=e.pixels.length,i=new Uint8ClampedArray(t*4),s=0;s<t;s++){var n=s*4,a=e.pixels[s],o=e.colorTable[a]||[0,0,0];i[n]=o[0],i[n+1]=o[1],i[n+2]=o[2],i[n+3]=a!==e.transparentIndex?255:0}return i},ul=function(e,t,i){if(!e.image){console.warn("gif frame does not have associated image.");return}var s=e.image,n=s.descriptor.width*s.descriptor.height,a=(0,Rd.lzw)(s.data.minCodeSize,s.data.blocks,n);s.descriptor.lct.interlaced&&(a=(0,Id.deinterlace)(a,s.descriptor.width));var o={pixels:a,dims:{top:e.image.descriptor.top,left:e.image.descriptor.left,width:e.image.descriptor.width,height:e.image.descriptor.height}};return s.descriptor.lct&&s.descriptor.lct.exists?o.colorTable=s.lct:o.colorTable=t,e.gce&&(o.delay=(e.gce.delay||10)*10,o.disposalType=e.gce.extras.disposal,e.gce.extras.transparentColorGiven&&(o.transparentIndex=e.gce.transparentColorIndex)),i&&(o.patch=Od(o)),o};Gi.decompressFrame=ul;var Nd=function(e,t){return e.frames.filter(function(i){return i.image}).map(function(i){return ul(i,e.gct,t)})};ll=Gi.decompressFrames=Nd;const Bd="modulepreload",Gd=function(r,e){return new URL(r,e).href},$o={},Gr=function(e,t,i){let s=Promise.resolve();if(t&&t.length>0){const n=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=Promise.all(t.map(l=>{if(l=Gd(l,i),l in $o)return;$o[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(!!i)for(let f=n.length-1;f>=0;f--){const p=n[f];if(p.href===l&&(!c||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${u}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":Bd,c||(d.as="script",d.crossOrigin=""),d.href=l,o&&d.setAttribute("nonce",o),document.head.appendChild(d),c)return new Promise((f,p)=>{d.addEventListener("load",f),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}return s.then(()=>e()).catch(n=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=n,window.dispatchEvent(a),!a.defaultPrevented)throw n})};var W=(r=>(r.Application="application",r.WebGLPipes="webgl-pipes",r.WebGLPipesAdaptor="webgl-pipes-adaptor",r.WebGLSystem="webgl-system",r.WebGPUPipes="webgpu-pipes",r.WebGPUPipesAdaptor="webgpu-pipes-adaptor",r.WebGPUSystem="webgpu-system",r.CanvasSystem="canvas-system",r.CanvasPipesAdaptor="canvas-pipes-adaptor",r.CanvasPipes="canvas-pipes",r.Asset="asset",r.LoadParser="load-parser",r.ResolveParser="resolve-parser",r.CacheParser="cache-parser",r.DetectionParser="detection-parser",r.MaskEffect="mask-effect",r.BlendMode="blend-mode",r.TextureSource="texture-source",r.Environment="environment",r.ShapeBuilder="shape-builder",r))(W||{});const ca=r=>{if(typeof r=="function"||typeof r=="object"&&r.extension){if(!r.extension)throw new Error("Extension class must have an extension object");r={...typeof r.extension!="object"?{type:r.extension}:r.extension,ref:r}}if(typeof r=="object")r={...r};else throw new Error("Invalid extension type");return typeof r.type=="string"&&(r.type=[r.type]),r},mr=(r,e)=>ca(r).priority??e,ze={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...r){return r.map(ca).forEach(e=>{e.type.forEach(t=>{var i,s;return(s=(i=this._removeHandlers)[t])==null?void 0:s.call(i,e)})}),this},add(...r){return r.map(ca).forEach(e=>{e.type.forEach(t=>{var n,a;const i=this._addHandlers,s=this._queue;i[t]?(a=i[t])==null||a.call(i,e):(s[t]=s[t]||[],(n=s[t])==null||n.push(e))})}),this},handle(r,e,t){var a;const i=this._addHandlers,s=this._removeHandlers;if(i[r]||s[r])throw new Error(`Extension type ${r} already has a handler`);i[r]=e,s[r]=t;const n=this._queue;return n[r]&&((a=n[r])==null||a.forEach(o=>e(o)),delete n[r]),this},handleByMap(r,e){return this.handle(r,t=>{t.name&&(e[t.name]=t.ref)},t=>{t.name&&delete e[t.name]})},handleByNamedList(r,e,t=-1){return this.handle(r,i=>{e.findIndex(n=>n.name===i.name)>=0||(e.push({name:i.name,value:i.ref}),e.sort((n,a)=>mr(a.value,t)-mr(n.value,t)))},i=>{const s=e.findIndex(n=>n.name===i.name);s!==-1&&e.splice(s,1)})},handleByList(r,e,t=-1){return this.handle(r,i=>{e.includes(i.ref)||(e.push(i.ref),e.sort((s,n)=>mr(n,t)-mr(s,t)))},i=>{const s=e.indexOf(i.ref);s!==-1&&e.splice(s,1)})}},Dd={extension:{type:W.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await Gr(()=>import("./browserAll-DneycU_B.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)}},Hd={extension:{type:W.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await Gr(()=>import("./webworkerAll-B02ObO6x.js"),__vite__mapDeps([1,2,3]),import.meta.url)}};class Qe{constructor(e,t,i){this._x=t||0,this._y=i||0,this._observer=e}clone(e){return new Qe(e??this._observer,this._x,this._y)}set(e=0,t=e){return(this._x!==e||this._y!==t)&&(this._x=e,this._y=t,this._observer._onUpdate(this)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this._observer._onUpdate(this)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=0 y=0 scope=${this._observer}]`}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this._observer._onUpdate(this))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this._observer._onUpdate(this))}}var ks=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function rr(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var dl={exports:{}};(function(r){var e=Object.prototype.hasOwnProperty,t="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(t=!1));function s(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function n(l,c,u,h,d){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new s(u,h||l,d),p=t?t+c:c;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],f]:l._events[p].push(f):(l._events[p]=f,l._eventsCount++),l}function a(l,c){--l._eventsCount===0?l._events=new i:delete l._events[c]}function o(){this._events=new i,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],u,h;if(this._eventsCount===0)return c;for(h in u=this._events)e.call(u,h)&&c.push(t?h.slice(1):h);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},o.prototype.listeners=function(c){var u=t?t+c:c,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var d=0,f=h.length,p=new Array(f);d<f;d++)p[d]=h[d].fn;return p},o.prototype.listenerCount=function(c){var u=t?t+c:c,h=this._events[u];return h?h.fn?1:h.length:0},o.prototype.emit=function(c,u,h,d,f,p){var _=t?t+c:c;if(!this._events[_])return!1;var g=this._events[_],m=arguments.length,x,S;if(g.fn){switch(g.once&&this.removeListener(c,g.fn,void 0,!0),m){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,h),!0;case 4:return g.fn.call(g.context,u,h,d),!0;case 5:return g.fn.call(g.context,u,h,d,f),!0;case 6:return g.fn.call(g.context,u,h,d,f,p),!0}for(S=1,x=new Array(m-1);S<m;S++)x[S-1]=arguments[S];g.fn.apply(g.context,x)}else{var w=g.length,A;for(S=0;S<w;S++)switch(g[S].once&&this.removeListener(c,g[S].fn,void 0,!0),m){case 1:g[S].fn.call(g[S].context);break;case 2:g[S].fn.call(g[S].context,u);break;case 3:g[S].fn.call(g[S].context,u,h);break;case 4:g[S].fn.call(g[S].context,u,h,d);break;default:if(!x)for(A=1,x=new Array(m-1);A<m;A++)x[A-1]=arguments[A];g[S].fn.apply(g[S].context,x)}}return!0},o.prototype.on=function(c,u,h){return n(this,c,u,h,!1)},o.prototype.once=function(c,u,h){return n(this,c,u,h,!0)},o.prototype.removeListener=function(c,u,h,d){var f=t?t+c:c;if(!this._events[f])return this;if(!u)return a(this,f),this;var p=this._events[f];if(p.fn)p.fn===u&&(!d||p.once)&&(!h||p.context===h)&&a(this,f);else{for(var _=0,g=[],m=p.length;_<m;_++)(p[_].fn!==u||d&&!p[_].once||h&&p[_].context!==h)&&g.push(p[_]);g.length?this._events[f]=g.length===1?g[0]:g:a(this,f)}return this},o.prototype.removeAllListeners=function(c){var u;return c?(u=t?t+c:c,this._events[u]&&a(this,u)):(this._events=new i,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=t,o.EventEmitter=o,r.exports=o})(dl);var Ud=dl.exports;const Yt=rr(Ud),zd=Math.PI*2,Wd=180/Math.PI,Yd=Math.PI/180;class Ue{constructor(e=0,t=0){this.x=0,this.y=0,this.x=e,this.y=t}clone(){return new Ue(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,t=e){return this.x=e,this.y=t,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return vn.x=0,vn.y=0,vn}}const vn=new Ue;class re{constructor(e=1,t=0,i=0,s=1,n=0,a=0){this.array=null,this.a=e,this.b=t,this.c=i,this.d=s,this.tx=n,this.ty=a}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,t,i,s,n,a){return this.a=e,this.b=t,this.c=i,this.d=s,this.tx=n,this.ty=a,this}toArray(e,t){this.array||(this.array=new Float32Array(9));const i=t||this.array;return e?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(e,t){t=t||new Ue;const i=e.x,s=e.y;return t.x=this.a*i+this.c*s+this.tx,t.y=this.b*i+this.d*s+this.ty,t}applyInverse(e,t){t=t||new Ue;const i=this.a,s=this.b,n=this.c,a=this.d,o=this.tx,l=this.ty,c=1/(i*a+n*-s),u=e.x,h=e.y;return t.x=a*c*u+-n*c*h+(l*n-o*a)*c,t.y=i*c*h+-s*c*u+(-l*i+o*s)*c,t}translate(e,t){return this.tx+=e,this.ty+=t,this}scale(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this}rotate(e){const t=Math.cos(e),i=Math.sin(e),s=this.a,n=this.c,a=this.tx;return this.a=s*t-this.b*i,this.b=s*i+this.b*t,this.c=n*t-this.d*i,this.d=n*i+this.d*t,this.tx=a*t-this.ty*i,this.ty=a*i+this.ty*t,this}append(e){const t=this.a,i=this.b,s=this.c,n=this.d;return this.a=e.a*t+e.b*s,this.b=e.a*i+e.b*n,this.c=e.c*t+e.d*s,this.d=e.c*i+e.d*n,this.tx=e.tx*t+e.ty*s+this.tx,this.ty=e.tx*i+e.ty*n+this.ty,this}appendFrom(e,t){const i=e.a,s=e.b,n=e.c,a=e.d,o=e.tx,l=e.ty,c=t.a,u=t.b,h=t.c,d=t.d;return this.a=i*c+s*h,this.b=i*u+s*d,this.c=n*c+a*h,this.d=n*u+a*d,this.tx=o*c+l*h+t.tx,this.ty=o*u+l*d+t.ty,this}setTransform(e,t,i,s,n,a,o,l,c){return this.a=Math.cos(o+c)*n,this.b=Math.sin(o+c)*n,this.c=-Math.sin(o-l)*a,this.d=Math.cos(o-l)*a,this.tx=e-(i*this.a+s*this.c),this.ty=t-(i*this.b+s*this.d),this}prepend(e){const t=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const i=this.a,s=this.c;this.a=i*e.a+this.b*e.c,this.b=i*e.b+this.b*e.d,this.c=s*e.a+this.d*e.c,this.d=s*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this}decompose(e){const t=this.a,i=this.b,s=this.c,n=this.d,a=e.pivot,o=-Math.atan2(-s,n),l=Math.atan2(i,t),c=Math.abs(o+l);return c<1e-5||Math.abs(zd-c)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=o,e.skew.y=l),e.scale.x=Math.sqrt(t*t+i*i),e.scale.y=Math.sqrt(s*s+n*n),e.position.x=this.tx+(a.x*t+a.y*s),e.position.y=this.ty+(a.x*i+a.y*n),e}invert(){const e=this.a,t=this.b,i=this.c,s=this.d,n=this.tx,a=e*s-t*i;return this.a=s/a,this.b=-t/a,this.c=-i/a,this.d=e/a,this.tx=(i*this.ty-s*n)/a,this.ty=-(e*this.ty-t*n)/a,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new re;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}equals(e){return e.a===this.a&&e.b===this.b&&e.c===this.c&&e.d===this.d&&e.tx===this.tx&&e.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return Xd.identity()}static get shared(){return Vd.identity()}}const Vd=new re,Xd=new re,Ci=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Mi=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Ii=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Ri=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],ua=[],fl=[],xr=Math.sign;function $d(){for(let r=0;r<16;r++){const e=[];ua.push(e);for(let t=0;t<16;t++){const i=xr(Ci[r]*Ci[t]+Ii[r]*Mi[t]),s=xr(Mi[r]*Ci[t]+Ri[r]*Mi[t]),n=xr(Ci[r]*Ii[t]+Ii[r]*Ri[t]),a=xr(Mi[r]*Ii[t]+Ri[r]*Ri[t]);for(let o=0;o<16;o++)if(Ci[o]===i&&Mi[o]===s&&Ii[o]===n&&Ri[o]===a){e.push(o);break}}}for(let r=0;r<16;r++){const e=new re;e.set(Ci[r],Mi[r],Ii[r],Ri[r],0,0),fl.push(e)}}$d();const I={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:r=>Ci[r],uY:r=>Mi[r],vX:r=>Ii[r],vY:r=>Ri[r],inv:r=>r&8?r&15:-r&7,add:(r,e)=>ua[r][e],sub:(r,e)=>ua[r][I.inv(e)],rotate180:r=>r^4,isVertical:r=>(r&3)===2,byDirection:(r,e)=>Math.abs(r)*2<=Math.abs(e)?e>=0?I.S:I.N:Math.abs(e)*2<=Math.abs(r)?r>0?I.E:I.W:e>0?r>0?I.SE:I.SW:r>0?I.NE:I.NW,matrixAppendRotationInv:(r,e,t=0,i=0)=>{const s=fl[I.inv(e)];s.tx=t,s.ty=i,r.append(s)}},yr=[new Ue,new Ue,new Ue,new Ue];class ke{constructor(e=0,t=0,i=0,s=0){this.type="rectangle",this.x=Number(e),this.y=Number(t),this.width=Number(i),this.height=Number(s)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new ke(0,0,0,0)}clone(){return new ke(this.x,this.y,this.width,this.height)}copyFromBounds(e){return this.x=e.minX,this.y=e.minY,this.width=e.maxX-e.minX,this.height=e.maxY-e.minY,this}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,t){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height}strokeContains(e,t,i){const{width:s,height:n}=this;if(s<=0||n<=0)return!1;const a=this.x,o=this.y,l=a-i/2,c=a+s+i/2,u=o-i/2,h=o+n+i/2,d=a+i/2,f=a+s-i/2,p=o+i/2,_=o+n-i/2;return e>=l&&e<=c&&t>=u&&t<=h&&!(e>d&&e<f&&t>p&&t<_)}intersects(e,t){if(!t){const E=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=E)return!1;const M=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>M}const i=this.left,s=this.right,n=this.top,a=this.bottom;if(s<=i||a<=n)return!1;const o=yr[0].set(e.left,e.top),l=yr[1].set(e.left,e.bottom),c=yr[2].set(e.right,e.top),u=yr[3].set(e.right,e.bottom);if(c.x<=o.x||l.y<=o.y)return!1;const h=Math.sign(t.a*t.d-t.b*t.c);if(h===0||(t.apply(o,o),t.apply(l,l),t.apply(c,c),t.apply(u,u),Math.max(o.x,l.x,c.x,u.x)<=i||Math.min(o.x,l.x,c.x,u.x)>=s||Math.max(o.y,l.y,c.y,u.y)<=n||Math.min(o.y,l.y,c.y,u.y)>=a))return!1;const d=h*(l.y-o.y),f=h*(o.x-l.x),p=d*i+f*n,_=d*s+f*n,g=d*i+f*a,m=d*s+f*a;if(Math.max(p,_,g,m)<=d*o.x+f*o.y||Math.min(p,_,g,m)>=d*u.x+f*u.y)return!1;const x=h*(o.y-c.y),S=h*(c.x-o.x),w=x*i+S*n,A=x*s+S*n,k=x*i+S*a,P=x*s+S*a;return!(Math.max(w,A,k,P)<=x*o.x+S*o.y||Math.min(w,A,k,P)>=x*u.x+S*u.y)}pad(e=0,t=e){return this.x-=e,this.y-=t,this.width+=e*2,this.height+=t*2,this}fit(e){const t=Math.max(this.x,e.x),i=Math.min(this.x+this.width,e.x+e.width),s=Math.max(this.y,e.y),n=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(i-t,0),this.y=s,this.height=Math.max(n-s,0),this}ceil(e=1,t=.001){const i=Math.ceil((this.x+this.width-t)*e)/e,s=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=i-this.x,this.height=s-this.y,this}enlarge(e){const t=Math.min(this.x,e.x),i=Math.max(this.x+this.width,e.x+e.width),s=Math.min(this.y,e.y),n=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=i-t,this.y=s,this.height=n-s,this}getBounds(e){return e=e||new ke,e.copyFrom(this),e}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const bn={default:-1};function Ge(r="default"){return bn[r]===void 0&&(bn[r]=-1),++bn[r]}const jo={},ae="8.0.0";function oe(r,e,t=3){if(jo[e])return;let i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${r}`):(i=i.split(`
`).splice(t).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${r}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${r}`),console.warn(i))),jo[e]=!0}const pl=()=>{};function qo(r){return r+=r===0?1:0,--r,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r+1}function Ko(r){return!(r&r-1)&&!!r}function jd(r){const e={};for(const t in r)r[t]!==void 0&&(e[t]=r[t]);return e}const Zo=Object.create(null);function qd(r){const e=Zo[r];return e===void 0&&(Zo[r]=Ge("resource")),e}const _l=class gl extends Yt{constructor(e={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,e={...gl.defaultOptions,...e},this.addressMode=e.addressMode,this.addressModeU=e.addressModeU??this.addressModeU,this.addressModeV=e.addressModeV??this.addressModeV,this.addressModeW=e.addressModeW??this.addressModeW,this.scaleMode=e.scaleMode,this.magFilter=e.magFilter??this.magFilter,this.minFilter=e.minFilter??this.minFilter,this.mipmapFilter=e.mipmapFilter??this.mipmapFilter,this.lodMinClamp=e.lodMinClamp,this.lodMaxClamp=e.lodMaxClamp,this.compare=e.compare,this.maxAnisotropy=e.maxAnisotropy??1}set addressMode(e){this.addressModeU=e,this.addressModeV=e,this.addressModeW=e}get addressMode(){return this.addressModeU}set wrapMode(e){oe(ae,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=e}get wrapMode(){return this.addressMode}set scaleMode(e){this.magFilter=e,this.minFilter=e,this.mipmapFilter=e}get scaleMode(){return this.magFilter}set maxAnisotropy(e){this._maxAnisotropy=Math.min(e,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const e=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=qd(e),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};_l.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let Kd=_l;const ml=class xl extends Yt{constructor(e={}){super(),this.options=e,this.uid=Ge("textureSource"),this._resourceType="textureSource",this._resourceId=Ge("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,e={...xl.defaultOptions,...e},this.label=e.label??"",this.resource=e.resource,this.autoGarbageCollect=e.autoGarbageCollect,this._resolution=e.resolution,e.width?this.pixelWidth=e.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,e.height?this.pixelHeight=e.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=e.format,this.dimension=e.dimensions,this.mipLevelCount=e.mipLevelCount,this.autoGenerateMipmaps=e.autoGenerateMipmaps,this.sampleCount=e.sampleCount,this.antialias=e.antialias,this.alphaMode=e.alphaMode,this.style=new Kd(jd(e)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(e){var t,i;this.style!==e&&((t=this._style)==null||t.off("change",this._onStyleChange,this),this._style=e,(i=this._style)==null||i.on("change",this._onStyleChange,this),this._onStyleChange())}get addressMode(){return this._style.addressMode}set addressMode(e){this._style.addressMode=e}get repeatMode(){return this._style.addressMode}set repeatMode(e){this._style.addressMode=e}get magFilter(){return this._style.magFilter}set magFilter(e){this._style.magFilter=e}get minFilter(){return this._style.minFilter}set minFilter(e){this._style.minFilter=e}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(e){this._style.mipmapFilter=e}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(e){this._style.lodMinClamp=e}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(e){this._style.lodMaxClamp=e}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const e=this._resolution;if(this.resize(this.resourceWidth/e,this.resourceHeight/e))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=Ge("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:e}=this;return e.naturalWidth||e.videoWidth||e.displayWidth||e.width}get resourceHeight(){const{resource:e}=this;return e.naturalHeight||e.videoHeight||e.displayHeight||e.height}get resolution(){return this._resolution}set resolution(e){this._resolution!==e&&(this._resolution=e,this.width=this.pixelWidth/e,this.height=this.pixelHeight/e)}resize(e,t,i){i=i||this._resolution,e=e||this.width,t=t||this.height;const s=Math.round(e*i),n=Math.round(t*i);return this.width=s/i,this.height=n/i,this._resolution=i,this.pixelWidth===s&&this.pixelHeight===n?!1:(this._refreshPOT(),this.pixelWidth=s,this.pixelHeight=n,this.emit("resize",this),this._resourceId=Ge("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(e){this._style.wrapMode=e}get wrapMode(){return this._style.wrapMode}set scaleMode(e){this._style.scaleMode=e}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=Ko(this.pixelWidth)&&Ko(this.pixelHeight)}static test(e){throw new Error("Unimplemented")}};ml.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let ni=ml;class qa extends ni{constructor(e){const t=e.resource||new Float32Array(e.width*e.height*4);let i=e.format;i||(t instanceof Float32Array?i="rgba32float":t instanceof Int32Array||t instanceof Uint32Array?i="rgba32uint":t instanceof Int16Array||t instanceof Uint16Array?i="rgba16uint":(t instanceof Int8Array,i="bgra8unorm")),super({...e,resource:t,format:i}),this.uploadMethodId="buffer"}static test(e){return e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}qa.extension=W.TextureSource;const Qo=new re;class Zd{constructor(e,t){this.mapCoord=new re,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof t>"u"?this.clampMargin=e.width<10?0:.5:this.clampMargin=t,this.isSimple=!1,this.texture=e}get texture(){return this._texture}set texture(e){var t;this.texture!==e&&((t=this._texture)==null||t.removeListener("update",this.update,this),this._texture=e,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(e,t){t===void 0&&(t=e);const i=this.mapCoord;for(let s=0;s<e.length;s+=2){const n=e[s],a=e[s+1];t[s]=n*i.a+a*i.c+i.tx,t[s+1]=n*i.b+a*i.d+i.ty}return t}update(){const e=this._texture;this._updateID++;const t=e.uvs;this.mapCoord.set(t.x1-t.x0,t.y1-t.y0,t.x3-t.x0,t.y3-t.y0,t.x0,t.y0);const i=e.orig,s=e.trim;s&&(Qo.set(i.width/s.width,0,0,i.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(Qo));const n=e.source,a=this.uClampFrame,o=this.clampMargin/n._resolution,l=this.clampOffset/n._resolution;return a[0]=(e.frame.x+o+l)/n.width,a[1]=(e.frame.y+o+l)/n.height,a[2]=(e.frame.x+e.frame.width-o+l)/n.width,a[3]=(e.frame.y+e.frame.height-o+l)/n.height,this.uClampOffset[0]=this.clampOffset/n.pixelWidth,this.uClampOffset[1]=this.clampOffset/n.pixelHeight,this.isSimple=e.frame.width===n.width&&e.frame.height===n.height&&e.rotate===0,!0}}class q extends Yt{constructor({source:e,label:t,frame:i,orig:s,trim:n,defaultAnchor:a,defaultBorders:o,rotate:l,dynamic:c}={}){if(super(),this.uid=Ge("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new ke,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=t,this.source=(e==null?void 0:e.source)??new ni,this.noFrame=!i,i)this.frame.copyFrom(i);else{const{width:u,height:h}=this._source;this.frame.width=u,this.frame.height=h}this.orig=s||this.frame,this.trim=n,this.rotate=l??0,this.defaultAnchor=a,this.defaultBorders=o,this.destroyed=!1,this.dynamic=c||!1,this.updateUvs()}set source(e){this._source&&this._source.off("resize",this.update,this),this._source=e,e.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new Zd(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:e,frame:t}=this,{width:i,height:s}=this._source,n=t.x/i,a=t.y/s,o=t.width/i,l=t.height/s;let c=this.rotate;if(c){const u=o/2,h=l/2,d=n+u,f=a+h;c=I.add(c,I.NW),e.x0=d+u*I.uX(c),e.y0=f+h*I.uY(c),c=I.add(c,2),e.x1=d+u*I.uX(c),e.y1=f+h*I.uY(c),c=I.add(c,2),e.x2=d+u*I.uX(c),e.y2=f+h*I.uY(c),c=I.add(c,2),e.x3=d+u*I.uX(c),e.y3=f+h*I.uY(c)}else e.x0=n,e.y0=a,e.x1=n+o,e.y1=a,e.x2=n+o,e.y2=a+l,e.x3=n,e.y3=a+l}destroy(e=!1){this._source&&e&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return oe(ae,"Texture.baseTexture is now Texture.source"),this._source}}q.EMPTY=new q({label:"EMPTY",source:new ni({label:"EMPTY"})});q.EMPTY.destroy=pl;q.WHITE=new q({source:new qa({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});q.WHITE.destroy=pl;function Qd(r,e,t,i){const{width:s,height:n}=t.orig,a=t.trim;if(a){const o=a.width,l=a.height;r.minX=a.x-e._x*s-i,r.maxX=r.minX+o,r.minY=a.y-e._y*n-i,r.maxY=r.minY+l}else r.minX=-e._x*s-i,r.maxX=r.minX+s,r.minY=-e._y*n-i,r.maxY=r.minY+n}const Jo=new re;class zt{constructor(e=1/0,t=1/0,i=-1/0,s=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=Jo,this.minX=e,this.minY=t,this.maxX=i,this.maxY=s}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new ke);const e=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(e.x=0,e.y=0,e.width=0,e.height=0):e.copyFromBounds(this),e}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=Jo,this}set(e,t,i,s){this.minX=e,this.minY=t,this.maxX=i,this.maxY=s}addFrame(e,t,i,s,n){n||(n=this.matrix);const a=n.a,o=n.b,l=n.c,c=n.d,u=n.tx,h=n.ty;let d=this.minX,f=this.minY,p=this.maxX,_=this.maxY,g=a*e+l*t+u,m=o*e+c*t+h;g<d&&(d=g),m<f&&(f=m),g>p&&(p=g),m>_&&(_=m),g=a*i+l*t+u,m=o*i+c*t+h,g<d&&(d=g),m<f&&(f=m),g>p&&(p=g),m>_&&(_=m),g=a*e+l*s+u,m=o*e+c*s+h,g<d&&(d=g),m<f&&(f=m),g>p&&(p=g),m>_&&(_=m),g=a*i+l*s+u,m=o*i+c*s+h,g<d&&(d=g),m<f&&(f=m),g>p&&(p=g),m>_&&(_=m),this.minX=d,this.minY=f,this.maxX=p,this.maxY=_}addRect(e,t){this.addFrame(e.x,e.y,e.x+e.width,e.y+e.height,t)}addBounds(e,t){this.addFrame(e.minX,e.minY,e.maxX,e.maxY,t)}addBoundsMask(e){this.minX=this.minX>e.minX?this.minX:e.minX,this.minY=this.minY>e.minY?this.minY:e.minY,this.maxX=this.maxX<e.maxX?this.maxX:e.maxX,this.maxY=this.maxY<e.maxY?this.maxY:e.maxY}applyMatrix(e){const t=this.minX,i=this.minY,s=this.maxX,n=this.maxY,{a,b:o,c:l,d:c,tx:u,ty:h}=e;let d=a*t+l*i+u,f=o*t+c*i+h;this.minX=d,this.minY=f,this.maxX=d,this.maxY=f,d=a*s+l*i+u,f=o*s+c*i+h,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=a*t+l*n+u,f=o*t+c*n+h,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=a*s+l*n+u,f=o*s+c*n+h,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY}fit(e){return this.minX<e.left&&(this.minX=e.left),this.maxX>e.right&&(this.maxX=e.right),this.minY<e.top&&(this.minY=e.top),this.maxY>e.bottom&&(this.maxY=e.bottom),this}fitBounds(e,t,i,s){return this.minX<e&&(this.minX=e),this.maxX>t&&(this.maxX=t),this.minY<i&&(this.minY=i),this.maxY>s&&(this.maxY=s),this}pad(e,t=e){return this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new zt(this.minX,this.minY,this.maxX,this.maxY)}scale(e,t=e){return this.minX*=e,this.minY*=t,this.maxX*=e,this.maxY*=t,this}get x(){return this.minX}set x(e){const t=this.maxX-this.minX;this.minX=e,this.maxX=e+t}get y(){return this.minY}set y(e){const t=this.maxY-this.minY;this.minY=e,this.maxY=e+t}get width(){return this.maxX-this.minX}set width(e){this.maxX=this.minX+e}get height(){return this.maxY-this.minY}set height(e){this.maxY=this.minY+e}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(e,t,i,s){let n=this.minX,a=this.minY,o=this.maxX,l=this.maxY;s||(s=this.matrix);const c=s.a,u=s.b,h=s.c,d=s.d,f=s.tx,p=s.ty;for(let _=t;_<i;_+=2){const g=e[_],m=e[_+1],x=c*g+h*m+f,S=u*g+d*m+p;n=x<n?x:n,a=S<a?S:a,o=x>o?x:o,l=S>l?S:l}this.minX=n,this.minY=a,this.maxX=o,this.maxY=l}containsPoint(e,t){return this.minX<=e&&this.minY<=t&&this.maxX>=e&&this.maxY>=t}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}}var Jd={grad:.9,turn:360,rad:360/(2*Math.PI)},Kt=function(r){return typeof r=="string"?r.length>0:typeof r=="number"},Le=function(r,e,t){return e===void 0&&(e=0),t===void 0&&(t=Math.pow(10,e)),Math.round(t*r)/t+0},St=function(r,e,t){return e===void 0&&(e=0),t===void 0&&(t=1),r>t?t:r>e?r:e},yl=function(r){return(r=isFinite(r)?r%360:0)>0?r:r+360},eh=function(r){return{r:St(r.r,0,255),g:St(r.g,0,255),b:St(r.b,0,255),a:St(r.a)}},An=function(r){return{r:Le(r.r),g:Le(r.g),b:Le(r.b),a:Le(r.a,3)}},ef=/^#([0-9a-f]{3,8})$/i,Sr=function(r){var e=r.toString(16);return e.length<2?"0"+e:e},Sl=function(r){var e=r.r,t=r.g,i=r.b,s=r.a,n=Math.max(e,t,i),a=n-Math.min(e,t,i),o=a?n===e?(t-i)/a:n===t?2+(i-e)/a:4+(e-t)/a:0;return{h:60*(o<0?o+6:o),s:n?a/n*100:0,v:n/255*100,a:s}},Tl=function(r){var e=r.h,t=r.s,i=r.v,s=r.a;e=e/360*6,t/=100,i/=100;var n=Math.floor(e),a=i*(1-t),o=i*(1-(e-n)*t),l=i*(1-(1-e+n)*t),c=n%6;return{r:255*[i,o,a,a,l,i][c],g:255*[l,i,i,o,a,a][c],b:255*[a,a,l,i,i,o][c],a:s}},th=function(r){return{h:yl(r.h),s:St(r.s,0,100),l:St(r.l,0,100),a:St(r.a)}},ih=function(r){return{h:Le(r.h),s:Le(r.s),l:Le(r.l),a:Le(r.a,3)}},sh=function(r){return Tl((t=(e=r).s,{h:e.h,s:(t*=((i=e.l)<50?i:100-i)/100)>0?2*t/(i+t)*100:0,v:i+t,a:e.a}));var e,t,i},Gs=function(r){return{h:(e=Sl(r)).h,s:(s=(200-(t=e.s))*(i=e.v)/100)>0&&s<200?t*i/100/(s<=100?s:200-s)*100:0,l:s/2,a:e.a};var e,t,i,s},tf=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,sf=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,rf=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,nf=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,da={string:[[function(r){var e=ef.exec(r);return e?(r=e[1]).length<=4?{r:parseInt(r[0]+r[0],16),g:parseInt(r[1]+r[1],16),b:parseInt(r[2]+r[2],16),a:r.length===4?Le(parseInt(r[3]+r[3],16)/255,2):1}:r.length===6||r.length===8?{r:parseInt(r.substr(0,2),16),g:parseInt(r.substr(2,2),16),b:parseInt(r.substr(4,2),16),a:r.length===8?Le(parseInt(r.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(r){var e=rf.exec(r)||nf.exec(r);return e?e[2]!==e[4]||e[4]!==e[6]?null:eh({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(r){var e=tf.exec(r)||sf.exec(r);if(!e)return null;var t,i,s=th({h:(t=e[1],i=e[2],i===void 0&&(i="deg"),Number(t)*(Jd[i]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return sh(s)},"hsl"]],object:[[function(r){var e=r.r,t=r.g,i=r.b,s=r.a,n=s===void 0?1:s;return Kt(e)&&Kt(t)&&Kt(i)?eh({r:Number(e),g:Number(t),b:Number(i),a:Number(n)}):null},"rgb"],[function(r){var e=r.h,t=r.s,i=r.l,s=r.a,n=s===void 0?1:s;if(!Kt(e)||!Kt(t)||!Kt(i))return null;var a=th({h:Number(e),s:Number(t),l:Number(i),a:Number(n)});return sh(a)},"hsl"],[function(r){var e=r.h,t=r.s,i=r.v,s=r.a,n=s===void 0?1:s;if(!Kt(e)||!Kt(t)||!Kt(i))return null;var a=function(o){return{h:yl(o.h),s:St(o.s,0,100),v:St(o.v,0,100),a:St(o.a)}}({h:Number(e),s:Number(t),v:Number(i),a:Number(n)});return Tl(a)},"hsv"]]},rh=function(r,e){for(var t=0;t<e.length;t++){var i=e[t][0](r);if(i)return[i,e[t][1]]}return[null,void 0]},af=function(r){return typeof r=="string"?rh(r.trim(),da.string):typeof r=="object"&&r!==null?rh(r,da.object):[null,void 0]},Pn=function(r,e){var t=Gs(r);return{h:t.h,s:St(t.s+100*e,0,100),l:t.l,a:t.a}},kn=function(r){return(299*r.r+587*r.g+114*r.b)/1e3/255},nh=function(r,e){var t=Gs(r);return{h:t.h,s:t.s,l:St(t.l+100*e,0,100),a:t.a}},fa=function(){function r(e){this.parsed=af(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return r.prototype.isValid=function(){return this.parsed!==null},r.prototype.brightness=function(){return Le(kn(this.rgba),2)},r.prototype.isDark=function(){return kn(this.rgba)<.5},r.prototype.isLight=function(){return kn(this.rgba)>=.5},r.prototype.toHex=function(){return e=An(this.rgba),t=e.r,i=e.g,s=e.b,a=(n=e.a)<1?Sr(Le(255*n)):"","#"+Sr(t)+Sr(i)+Sr(s)+a;var e,t,i,s,n,a},r.prototype.toRgb=function(){return An(this.rgba)},r.prototype.toRgbString=function(){return e=An(this.rgba),t=e.r,i=e.g,s=e.b,(n=e.a)<1?"rgba("+t+", "+i+", "+s+", "+n+")":"rgb("+t+", "+i+", "+s+")";var e,t,i,s,n},r.prototype.toHsl=function(){return ih(Gs(this.rgba))},r.prototype.toHslString=function(){return e=ih(Gs(this.rgba)),t=e.h,i=e.s,s=e.l,(n=e.a)<1?"hsla("+t+", "+i+"%, "+s+"%, "+n+")":"hsl("+t+", "+i+"%, "+s+"%)";var e,t,i,s,n},r.prototype.toHsv=function(){return e=Sl(this.rgba),{h:Le(e.h),s:Le(e.s),v:Le(e.v),a:Le(e.a,3)};var e},r.prototype.invert=function(){return Nt({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},r.prototype.saturate=function(e){return e===void 0&&(e=.1),Nt(Pn(this.rgba,e))},r.prototype.desaturate=function(e){return e===void 0&&(e=.1),Nt(Pn(this.rgba,-e))},r.prototype.grayscale=function(){return Nt(Pn(this.rgba,-1))},r.prototype.lighten=function(e){return e===void 0&&(e=.1),Nt(nh(this.rgba,e))},r.prototype.darken=function(e){return e===void 0&&(e=.1),Nt(nh(this.rgba,-e))},r.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},r.prototype.alpha=function(e){return typeof e=="number"?Nt({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):Le(this.rgba.a,3);var t},r.prototype.hue=function(e){var t=Gs(this.rgba);return typeof e=="number"?Nt({h:e,s:t.s,l:t.l,a:t.a}):Le(t.h)},r.prototype.isEqual=function(e){return this.toHex()===Nt(e).toHex()},r}(),Nt=function(r){return r instanceof fa?r:new fa(r)},ah=[],of=function(r){r.forEach(function(e){ah.indexOf(e)<0&&(e(fa,da),ah.push(e))})};function hf(r,e){var t={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},i={};for(var s in t)i[t[s]]=s;var n={};r.prototype.toName=function(a){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var o,l,c=i[this.toHex()];if(c)return c;if(a!=null&&a.closest){var u=this.toRgb(),h=1/0,d="black";if(!n.length)for(var f in t)n[f]=new r(t[f]).toRgb();for(var p in t){var _=(o=u,l=n[p],Math.pow(o.r-l.r,2)+Math.pow(o.g-l.g,2)+Math.pow(o.b-l.b,2));_<h&&(h=_,d=p)}return d}},e.string.push([function(a){var o=a.toLowerCase(),l=o==="transparent"?"#0000":t[o];return l?new r(l).toRgb():null},"name"])}of([hf]);const us=class Ls{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof Ls)this._value=this._cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,e))&&(this._normalize(e),this._value=this._cloneSource(e))}}get value(){return this._value}_cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}_isSourceEqual(e,t){const i=typeof e;if(i!==typeof t)return!1;if(i==="number"||i==="string"||e instanceof Number)return e===t;if(Array.isArray(e)&&Array.isArray(t)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return e.length!==t.length?!1:e.every((n,a)=>n===t[a]);if(e!==null&&t!==null){const n=Object.keys(e),a=Object.keys(t);return n.length!==a.length?!1:n.every(o=>e[o]===t[o])}return e===t}toRgba(){const[e,t,i,s]=this._components;return{r:e,g:t,b:i,a:s}}toRgb(){const[e,t,i]=this._components;return{r:e,g:t,b:i}}toRgbaString(){const[e,t,i]=this.toUint8RgbArray();return`rgba(${e},${t},${i},${this.alpha})`}toUint8RgbArray(e){const[t,i,s]=this._components;return this._arrayRgb||(this._arrayRgb=[]),e=e||this._arrayRgb,e[0]=Math.round(t*255),e[1]=Math.round(i*255),e[2]=Math.round(s*255),e}toArray(e){this._arrayRgba||(this._arrayRgba=[]),e=e||this._arrayRgba;const[t,i,s,n]=this._components;return e[0]=t,e[1]=i,e[2]=s,e[3]=n,e}toRgbArray(e){this._arrayRgb||(this._arrayRgb=[]),e=e||this._arrayRgb;const[t,i,s]=this._components;return e[0]=t,e[1]=i,e[2]=s,e}toNumber(){return this._int}toBgrNumber(){const[e,t,i]=this.toUint8RgbArray();return(i<<16)+(t<<8)+e}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[t,i,s,n]=Ls._temp.setValue(e)._components;return this._components[0]*=t,this._components[1]*=i,this._components[2]*=s,this._components[3]*=n,this._refreshInt(),this._value=null,this}premultiply(e,t=!0){return t&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this._refreshInt(),this._value=null,this}toPremultiplied(e,t=!0){if(e===1)return(255<<24)+this._int;if(e===0)return t?0:this._int;let i=this._int>>16&255,s=this._int>>8&255,n=this._int&255;return t&&(i=i*e+.5|0,s=s*e+.5|0,n=n*e+.5|0),(e*255<<24)+(i<<16)+(s<<8)+n}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const t=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(e){return this._components[3]=this._clamp(e),this}_normalize(e){let t,i,s,n;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const a=e;t=(a>>16&255)/255,i=(a>>8&255)/255,s=(a&255)/255,n=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[t,i,s,n=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[t,i,s,n=255]=e,t/=255,i/=255,s/=255,n/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const o=Ls.HEX_PATTERN.exec(e);o&&(e=`#${o[2]}`)}const a=Nt(e);a.isValid()&&({r:t,g:i,b:s,a:n}=a.rgba,t/=255,i/=255,s/=255)}if(t!==void 0)this._components[0]=t,this._components[1]=i,this._components[2]=s,this._components[3]=n,this._refreshInt();else throw new Error(`Unable to convert color ${e}`)}_refreshInt(){this._clamp(this._components);const[e,t,i]=this._components;this._int=(e*255<<16)+(t*255<<8)+(i*255|0)}_clamp(e,t=0,i=1){return typeof e=="number"?Math.min(Math.max(e,t),i):(e.forEach((s,n)=>{e[n]=Math.min(Math.max(s,t),i)}),e)}static isColorLike(e){return typeof e=="number"||typeof e=="string"||e instanceof Number||e instanceof Ls||Array.isArray(e)||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Float32Array||e.r!==void 0&&e.g!==void 0&&e.b!==void 0||e.r!==void 0&&e.g!==void 0&&e.b!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0&&e.a!==void 0}};us.shared=new us;us._temp=new us;us.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let Ae=us;const lf={cullArea:null,cullable:!1,cullableChildren:!0};class Ka{constructor(e,t){this._pool=[],this._count=0,this._index=0,this._classType=e,t&&this.prepopulate(t)}prepopulate(e){for(let t=0;t<e;t++)this._pool[this._index++]=new this._classType;this._count+=e}get(e){var i;let t;return this._index>0?t=this._pool[--this._index]:t=new this._classType,(i=t.init)==null||i.call(t,e),t}return(e){var t;(t=e.reset)==null||t.call(e),this._pool[this._index++]=e}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){this._pool.length=0,this._index=0}}class cf{constructor(){this._poolsByClass=new Map}prepopulate(e,t){this.getPool(e).prepopulate(t)}get(e,t){return this.getPool(e).get(t)}return(e){this.getPool(e.constructor).return(e)}getPool(e){return this._poolsByClass.has(e)||this._poolsByClass.set(e,new Ka(e)),this._poolsByClass.get(e)}stats(){const e={};return this._poolsByClass.forEach(t=>{const i=e[t._classType.name]?t._classType.name+t._classType.ID:t._classType.name;e[i]={free:t.totalFree,used:t.totalUsed,size:t.totalSize}}),e}}const ei=new cf;function uf(r,e,t){const i=r.length;let s;if(e>=i||t===0)return;t=e+t>i?i-e:t;const n=i-t;for(s=e;s<n;++s)r[s]=r[s+t];r.length=n}const df={allowChildren:!0,removeChildren(r=0,e){const t=e??this.children.length,i=t-r,s=[];if(i>0&&i<=t){for(let a=t-1;a>=r;a--){const o=this.children[a];o&&(s.push(o),o.parent=null)}uf(this.children,r,t);const n=this.renderGroup||this.parentRenderGroup;n&&n.removeChildren(s);for(let a=0;a<s.length;++a)this.emit("childRemoved",s[a],this,a),s[a].emit("removed",this);return s}else if(i===0&&this.children.length===0)return s;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(r){const e=this.getChildAt(r);return this.removeChild(e)},getChildAt(r){if(r<0||r>=this.children.length)throw new Error(`getChildAt: Index (${r}) does not exist.`);return this.children[r]},setChildIndex(r,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);this.getChildIndex(r),this.addChildAt(r,e)},getChildIndex(r){const e=this.children.indexOf(r);if(e===-1)throw new Error("The supplied Container must be a child of the caller");return e},addChildAt(r,e){this.allowChildren||oe(ae,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:t}=this;if(e<0||e>t.length)throw new Error(`${r}addChildAt: The index ${e} supplied is out of bounds ${t.length}`);if(r.parent){const s=r.parent.children.indexOf(r);if(r.parent===this&&s===e)return r;s!==-1&&r.parent.children.splice(s,1)}e===t.length?t.push(r):t.splice(e,0,r),r.parent=this,r.didChange=!0,r.didViewUpdate=!1,r._updateFlags=15;const i=this.renderGroup||this.parentRenderGroup;return i&&i.addChild(r),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",r,this,e),r.emit("added",this),r},swapChildren(r,e){if(r===e)return;const t=this.getChildIndex(r),i=this.getChildIndex(e);this.children[t]=e,this.children[i]=r;const s=this.renderGroup||this.parentRenderGroup;s&&(s.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){var r;(r=this.parent)==null||r.removeChild(this)},reparentChild(...r){return r.length===1?this.reparentChildAt(r[0],this.children.length):(r.forEach(e=>this.reparentChildAt(e,this.children.length)),r[0])},reparentChildAt(r,e){if(r.parent===this)return this.setChildIndex(r,e),r;const t=r.worldTransform.clone();r.removeFromParent(),this.addChildAt(r,e);const i=this.worldTransform.clone();return i.invert(),t.prepend(i),r.setFromMatrix(t),r}};class oh{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let e=0;e<this.filters.length;e++)this.filters[e].destroy();this.filters=null,this.filterArea=null}}class ff{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(e=>{this.add({test:e.test,maskClass:e})}))}add(e){this._tests.push(e)}getMaskEffect(e){this._initialized||this.init();for(let t=0;t<this._tests.length;t++){const i=this._tests[t];if(i.test(e))return ei.get(i.maskClass,e)}return e}returnMaskEffect(e){ei.return(e)}}const pa=new ff;ze.handleByList(W.MaskEffect,pa._effectClasses);const pf={_maskEffect:null,_filterEffect:null,effects:[],addEffect(r){if(this.effects.indexOf(r)!==-1)return;this.effects.push(r),this.effects.sort((i,s)=>i.priority-s.priority);const t=this.renderGroup||this.parentRenderGroup;t&&(t.structureDidChange=!0),this._updateIsSimple()},removeEffect(r){const e=this.effects.indexOf(r);e!==-1&&(this.effects.splice(e,1),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateIsSimple())},set mask(r){const e=this._maskEffect;(e==null?void 0:e.mask)!==r&&(e&&(this.removeEffect(e),pa.returnMaskEffect(e),this._maskEffect=null),r!=null&&(this._maskEffect=pa.getMaskEffect(r),this.addEffect(this._maskEffect)))},get mask(){var r;return(r=this._maskEffect)==null?void 0:r.mask},set filters(r){var n;!Array.isArray(r)&&r&&(r=[r]);const e=this._filterEffect||(this._filterEffect=new oh);r=r;const t=(r==null?void 0:r.length)>0,i=((n=e.filters)==null?void 0:n.length)>0,s=t!==i;r=Array.isArray(r)?r.slice(0):r,e.filters=Object.freeze(r),s&&(t?this.addEffect(e):(this.removeEffect(e),e.filters=r??null))},get filters(){var r;return(r=this._filterEffect)==null?void 0:r.filters},set filterArea(r){this._filterEffect||(this._filterEffect=new oh),this._filterEffect.filterArea=r},get filterArea(){var r;return(r=this._filterEffect)==null?void 0:r.filterArea}},_f={label:null,get name(){return oe(ae,"Container.name property has been removed, use Container.label instead"),this.label},set name(r){oe(ae,"Container.name property has been removed, use Container.label instead"),this.label=r},getChildByName(r,e=!1){return this.getChildByLabel(r,e)},getChildByLabel(r,e=!1){const t=this.children;for(let i=0;i<t.length;i++){const s=t[i];if(s.label===r||r instanceof RegExp&&r.test(s.label))return s}if(e)for(let i=0;i<t.length;i++){const n=t[i].getChildByLabel(r,!0);if(n)return n}return null},getChildrenByLabel(r,e=!1,t=[]){const i=this.children;for(let s=0;s<i.length;s++){const n=i[s];(n.label===r||r instanceof RegExp&&r.test(n.label))&&t.push(n)}if(e)for(let s=0;s<i.length;s++)i[s].getChildrenByLabel(r,!0,t);return t}},ti=new Ka(re),ds=new Ka(zt);function wl(r,e,t){t.clear();let i,s;return r.parent?e?i=r.parent.worldTransform:(s=ti.get().identity(),i=Dr(r,s)):i=re.IDENTITY,vl(r,t,i,e),s&&ti.return(s),t.isValid||t.set(0,0,0,0),t}function vl(r,e,t,i){var o,l;if(!r.visible||!r.measurable)return;let s;i?s=r.worldTransform:(r.updateLocalTransform(),s=ti.get(),s.appendFrom(r.localTransform,t));const n=e,a=!!r.effects.length;if(a&&(e=ds.get().clear()),r.boundsArea)e.addRect(r.boundsArea,s);else{r.addBounds&&(e.matrix=s,r.addBounds(e));for(let c=0;c<r.children.length;c++)vl(r.children[c],e,s,i)}if(a){for(let c=0;c<r.effects.length;c++)(l=(o=r.effects[c]).addBounds)==null||l.call(o,e);n.addBounds(e,re.IDENTITY),ds.return(e)}i||ti.return(s)}function Dr(r,e){const t=r.parent;return t&&(Dr(t,e),t.updateLocalTransform(),e.append(t.localTransform)),e}let En=0;const hh=500;function Ee(...r){En!==hh&&(En++,En===hh?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...r))}function bl(r,e,t){return e.clear(),t||(t=re.IDENTITY),Al(r,e,t,r,!0),e.isValid||e.set(0,0,0,0),e}function Al(r,e,t,i,s){var l,c;let n;if(s)n=ti.get(),n=t.copyTo(n);else{if(!r.visible||!r.measurable)return;r.updateLocalTransform();const u=r.localTransform;n=ti.get(),n.appendFrom(u,t)}const a=e,o=!!r.effects.length;if(o&&(e=ds.get().clear()),r.boundsArea)e.addRect(r.boundsArea,n);else{r.renderPipeId&&(e.matrix=n,r.addBounds(e));const u=r.children;for(let h=0;h<u.length;h++)Al(u[h],e,n,i,!1)}if(o){for(let u=0;u<r.effects.length;u++)(c=(l=r.effects[u]).addLocalBounds)==null||c.call(l,e,i);a.addBounds(e,re.IDENTITY),ds.return(e)}ti.return(n)}function Pl(r,e){const t=r.children;for(let i=0;i<t.length;i++){const s=t[i],n=s.uid,a=(s._didViewChangeTick&65535)<<16|s._didContainerChangeTick&65535,o=e.index;(e.data[o]!==n||e.data[o+1]!==a)&&(e.data[e.index]=n,e.data[e.index+1]=a,e.didChange=!0),e.index=o+2,s.children.length&&Pl(s,e)}return e.didChange}const gf=new re,mf={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(r,e){const t=Math.sign(this.scale.x)||1;e!==0?this.scale.x=r/e*t:this.scale.x=t},_setHeight(r,e){const t=Math.sign(this.scale.y)||1;e!==0?this.scale.y=r/e*t:this.scale.y=t},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new zt});const r=this._localBoundsCacheData;return r.index=1,r.didChange=!1,r.data[0]!==this._didViewChangeTick&&(r.didChange=!0,r.data[0]=this._didViewChangeTick),Pl(this,r),r.didChange&&bl(this,r.localBounds,gf),r.localBounds},getBounds(r,e){return wl(this,r,e||new zt)}},xf={_onRender:null,set onRender(r){const e=this.renderGroup||this.parentRenderGroup;if(!r){this._onRender&&(e==null||e.removeOnRender(this)),this._onRender=null;return}this._onRender||e==null||e.addOnRender(this),this._onRender=r},get onRender(){return this._onRender}},yf={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(r){this._zIndex!==r&&(this._zIndex=r,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(Sf))}};function Sf(r,e){return r._zIndex-e._zIndex}const Tf={getGlobalPosition(r=new Ue,e=!1){return this.parent?this.parent.toGlobal(this._position,r,e):(r.x=this._position.x,r.y=this._position.y),r},toGlobal(r,e,t=!1){if(!t){this.updateLocalTransform();const i=Dr(this,new re);return i.append(this.localTransform),i.apply(r,e)}return this.worldTransform.apply(r,e)},toLocal(r,e,t,i){if(e&&(r=e.toGlobal(r,t,i)),!i){this.updateLocalTransform();const s=Dr(this,new re);return s.append(this.localTransform),s.applyInverse(r,t)}return this.worldTransform.applyInverse(r,t)}};let wf=0;class kl{constructor(){this.uid=Ge("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.tick=0}reset(){this.instructionSize=0,this.tick=wf++}add(e){this.instructions[this.instructionSize++]=e}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}class vf{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new re,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new kl,this._onRenderContainers=[]}init(e){this.root=e,e._onRender&&this.addOnRender(e),e.didChange=!0;const t=e.children;for(let i=0;i<t.length;i++)this.addChild(t[i])}reset(){this.renderGroupChildren.length=0;for(const e in this.childrenToUpdate){const t=this.childrenToUpdate[e];t.list.fill(null),t.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null}get localTransform(){return this.root.localTransform}addRenderGroupChild(e){e.renderGroupParent&&e.renderGroupParent._removeRenderGroupChild(e),e.renderGroupParent=this,this.renderGroupChildren.push(e)}_removeRenderGroupChild(e){const t=this.renderGroupChildren.indexOf(e);t>-1&&this.renderGroupChildren.splice(t,1),e.renderGroupParent=null}addChild(e){if(this.structureDidChange=!0,e.parentRenderGroup=this,e.updateTick=-1,e.parent===this.root?e.relativeRenderGroupDepth=1:e.relativeRenderGroupDepth=e.parent.relativeRenderGroupDepth+1,e.didChange=!0,this.onChildUpdate(e),e.renderGroup){this.addRenderGroupChild(e.renderGroup);return}e._onRender&&this.addOnRender(e);const t=e.children;for(let i=0;i<t.length;i++)this.addChild(t[i])}removeChild(e){if(this.structureDidChange=!0,e._onRender&&(e.renderGroup||this.removeOnRender(e)),e.parentRenderGroup=null,e.renderGroup){this._removeRenderGroupChild(e.renderGroup);return}const t=e.children;for(let i=0;i<t.length;i++)this.removeChild(t[i])}removeChildren(e){for(let t=0;t<e.length;t++)this.removeChild(e[t])}onChildUpdate(e){let t=this.childrenToUpdate[e.relativeRenderGroupDepth];t||(t=this.childrenToUpdate[e.relativeRenderGroupDepth]={index:0,list:[]}),t.list[t.index++]=e}updateRenderable(e){e.globalDisplayStatus<7||(e.didViewUpdate=!1,this.instructionSet.renderPipes[e.renderPipeId].updateRenderable(e))}onChildViewUpdate(e){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=e}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(e){this._onRenderContainers.push(e)}removeOnRender(e){this._onRenderContainers.splice(this._onRenderContainers.indexOf(e),1)}runOnRender(){for(let e=0;e<this._onRenderContainers.length;e++)this._onRenderContainers[e]._onRender()}destroy(){this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(e=[]){const t=this.root.children;for(let i=0;i<t.length;i++)this._getChildren(t[i],e);return e}_getChildren(e,t=[]){if(t.push(e),e.renderGroup)return t;const i=e.children;for(let s=0;s<i.length;s++)this._getChildren(i[s],t);return t}}function bf(r,e,t={}){for(const i in e)!t[i]&&e[i]!==void 0&&(r[i]=e[i])}const Cn=new Qe(null),Mn=new Qe(null),In=new Qe(null,1,1),lh=1,Af=2,Rn=4;class de extends Yt{constructor(e={}){var t,i;super(),this.uid=Ge("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new re,this.relativeGroupTransform=new re,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new Qe(this,0,0),this._scale=In,this._pivot=Mn,this._skew=Cn,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],bf(this,e,{children:!0,parent:!0,effects:!0}),(t=e.children)==null||t.forEach(s=>this.addChild(s)),(i=e.parent)==null||i.addChild(this)}static mixin(e){Object.defineProperties(de.prototype,Object.getOwnPropertyDescriptors(e))}set _didChangeId(e){this._didViewChangeTick=e>>12&4095,this._didContainerChangeTick=e&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...e){if(this.allowChildren||oe(ae,"addChild: Only Containers will be allowed to add children in v8.0.0"),e.length>1){for(let s=0;s<e.length;s++)this.addChild(e[s]);return e[0]}const t=e[0];if(t.parent===this)return this.children.splice(this.children.indexOf(t),1),this.children.push(t),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),t;t.parent&&t.parent.removeChild(t),this.children.push(t),this.sortableChildren&&(this.sortDirty=!0),t.parent=this,t.didChange=!0,t.didViewUpdate=!1,t._updateFlags=15;const i=this.renderGroup||this.parentRenderGroup;return i&&i.addChild(t),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this),this._didViewChangeTick++,t._zIndex!==0&&t.depthOfChildModified(),t}removeChild(...e){if(e.length>1){for(let s=0;s<e.length;s++)this.removeChild(e[s]);return e[0]}const t=e[0],i=this.children.indexOf(t);return i>-1&&(this._didViewChangeTick++,this.children.splice(i,1),this.renderGroup?this.renderGroup.removeChild(t):this.parentRenderGroup&&this.parentRenderGroup.removeChild(t),t.parent=null,this.emit("childRemoved",t,this,i),t.emit("removed",this)),t}_onUpdate(e){e&&e===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(e){!!this.renderGroup!==e&&(e?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const e=this.parentRenderGroup;e==null||e.removeChild(this),this.renderGroup=ei.get(vf,this),this.groupTransform=re.IDENTITY,e==null||e.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const e=this.parentRenderGroup;e==null||e.removeChild(this),ei.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,e==null||e.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new re),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(e){this._position.x=e}get y(){return this._position.y}set y(e){this._position.y=e}get position(){return this._position}set position(e){this._position.copyFrom(e)}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this._onUpdate(this._skew))}get angle(){return this.rotation*Wd}set angle(e){this.rotation=e*Yd}get pivot(){return this._pivot===Mn&&(this._pivot=new Qe(this,0,0)),this._pivot}set pivot(e){this._pivot===Mn&&(this._pivot=new Qe(this,0,0)),typeof e=="number"?this._pivot.set(e):this._pivot.copyFrom(e)}get skew(){return this._skew===Cn&&(this._skew=new Qe(this,0,0)),this._skew}set skew(e){this._skew===Cn&&(this._skew=new Qe(this,0,0)),this._skew.copyFrom(e)}get scale(){return this._scale===In&&(this._scale=new Qe(this,1,1)),this._scale}set scale(e){this._scale===In&&(this._scale=new Qe(this,0,0)),typeof e=="number"?this._scale.set(e):this._scale.copyFrom(e)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(e){const t=this.getLocalBounds().width;this._setWidth(e,t)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(e){const t=this.getLocalBounds().height;this._setHeight(e,t)}getSize(e){e||(e={});const t=this.getLocalBounds();return e.width=Math.abs(this.scale.x*t.width),e.height=Math.abs(this.scale.y*t.height),e}setSize(e,t){const i=this.getLocalBounds();let s,n;typeof e!="object"?(s=e,n=t??e):(s=e.width,n=e.height??e.width),s!==void 0&&this._setWidth(s,i.width),n!==void 0&&this._setHeight(n,i.height)}_updateSkew(){const e=this._rotation,t=this._skew;this._cx=Math.cos(e+t._y),this._sx=Math.sin(e+t._y),this._cy=-Math.sin(e-t._x),this._sy=Math.cos(e-t._x)}updateTransform(e){return this.position.set(typeof e.x=="number"?e.x:this.position.x,typeof e.y=="number"?e.y:this.position.y),this.scale.set(typeof e.scaleX=="number"?e.scaleX||1:this.scale.x,typeof e.scaleY=="number"?e.scaleY||1:this.scale.y),this.rotation=typeof e.rotation=="number"?e.rotation:this.rotation,this.skew.set(typeof e.skewX=="number"?e.skewX:this.skew.x,typeof e.skewY=="number"?e.skewY:this.skew.y),this.pivot.set(typeof e.pivotX=="number"?e.pivotX:this.pivot.x,typeof e.pivotY=="number"?e.pivotY:this.pivot.y),this}setFromMatrix(e){e.decompose(this)}updateLocalTransform(){const e=this._didContainerChangeTick;if(this._didLocalTransformChangeId===e)return;this._didLocalTransformChangeId=e;const t=this.localTransform,i=this._scale,s=this._pivot,n=this._position,a=i._x,o=i._y,l=s._x,c=s._y;t.a=this._cx*a,t.b=this._sx*a,t.c=this._cy*o,t.d=this._sy*o,t.tx=n._x-(l*t.a+c*t.c),t.ty=n._y-(l*t.b+c*t.d)}set alpha(e){e!==this.localAlpha&&(this.localAlpha=e,this._updateFlags|=lh,this._onUpdate())}get alpha(){return this.localAlpha}set tint(e){const i=Ae.shared.setValue(e??16777215).toBgrNumber();i!==this.localColor&&(this.localColor=i,this._updateFlags|=lh,this._onUpdate())}get tint(){const e=this.localColor;return((e&255)<<16)+(e&65280)+(e>>16&255)}set blendMode(e){this.localBlendMode!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Af,this.localBlendMode=e,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(e){const t=e?2:0;(this.localDisplayStatus&2)!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Rn,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(e){const t=e?0:4;(this.localDisplayStatus&4)!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Rn,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(e){const t=e?1:0;(this.localDisplayStatus&1)!==t&&(this._updateFlags|=Rn,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(e=!1){var s;if(this.destroyed)return;this.destroyed=!0;const t=this.removeChildren(0,this.children.length);if(this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),typeof e=="boolean"?e:e==null?void 0:e.children)for(let n=0;n<t.length;++n)t[n].destroy(e);(s=this.renderGroup)==null||s.destroy(),this.renderGroup=null}}de.mixin(df);de.mixin(Tf);de.mixin(xf);de.mixin(mf);de.mixin(pf);de.mixin(_f);de.mixin(yf);de.mixin(lf);class Za extends de{constructor(){super(...arguments),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=0,this._lastInstructionTick=-1,this._bounds=new zt(0,1,0,0),this._boundsDirty=!0}_updateBounds(){}get roundPixels(){return!!this._roundPixels}set roundPixels(e){this._roundPixels=e?1:0}containsPoint(e){const t=this.bounds,{x:i,y:s}=e;return i>=t.minX&&i<=t.maxX&&s>=t.minY&&s<=t.maxY}destroy(e){super.destroy(e),this._bounds=null}}class j extends Za{constructor(e=q.EMPTY){e instanceof q&&(e={texture:e});const{texture:t=q.EMPTY,anchor:i,roundPixels:s,width:n,height:a,...o}=e;super({label:"Sprite",...o}),this.renderPipeId="sprite",this.batched=!0,this._didSpriteUpdate=!1,this._sourceBounds={minX:0,maxX:1,minY:0,maxY:0},this._sourceBoundsDirty=!0,this._anchor=new Qe({_onUpdate:()=>{this.onViewUpdate()}}),i?this.anchor=i:t.defaultAnchor&&(this.anchor=t.defaultAnchor),this.texture=t,this.allowChildren=!1,this.roundPixels=s??!1,n!==void 0&&(this.width=n),a!==void 0&&(this.height=a)}static from(e,t=!1){return e instanceof q?new j(e):new j(q.from(e,t))}set texture(e){e||(e=q.EMPTY);const t=this._texture;t!==e&&(t&&t.dynamic&&t.off("update",this.onViewUpdate,this),e.dynamic&&e.on("update",this.onViewUpdate,this),this._texture=e,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get bounds(){return this._boundsDirty&&(this._updateBounds(),this._boundsDirty=!1),this._bounds}get sourceBounds(){return this._sourceBoundsDirty&&(this._updateSourceBounds(),this._sourceBoundsDirty=!1),this._sourceBounds}containsPoint(e){const t=this.sourceBounds;return e.x>=t.maxX&&e.x<=t.minX&&e.y>=t.maxY&&e.y<=t.minY}addBounds(e){const t=this._texture.trim?this.sourceBounds:this.bounds;e.addFrame(t.minX,t.minY,t.maxX,t.maxY)}onViewUpdate(){if(this._didViewChangeTick++,this._didSpriteUpdate=!0,this._sourceBoundsDirty=this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}_updateBounds(){Qd(this._bounds,this._anchor,this._texture,0)}_updateSourceBounds(){const e=this._anchor,t=this._texture,i=this._sourceBounds,{width:s,height:n}=t.orig;i.maxX=-e._x*s,i.minX=i.maxX+s,i.maxY=-e._y*n,i.minY=i.maxY+n}destroy(e=!1){if(super.destroy(e),typeof e=="boolean"?e:e==null?void 0:e.texture){const i=typeof e=="boolean"?e:e==null?void 0:e.textureSource;this._texture.destroy(i)}this._texture=null,this._bounds=null,this._sourceBounds=null,this._anchor=null}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this._setWidth(e,this._texture.orig.width),this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this._setHeight(e,this._texture.orig.height),this._height=e}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this._texture.orig.width,e.height=Math.abs(this.scale.y)*this._texture.orig.height,e}setSize(e,t){let i,s;typeof e!="object"?(i=e,s=t??e):(i=e.width,s=e.height??e.width),i!==void 0&&this._setWidth(i,this._texture.orig.width),s!==void 0&&this._setHeight(s,this._texture.orig.height)}}const Pf=new zt;function El(r,e,t){const i=Pf;r.measurable=!0,wl(r,t,i),e.addBoundsMask(i),r.measurable=!1}function Cl(r,e,t){const i=ds.get();r.measurable=!0;const s=ti.get().identity(),n=Ml(r,t,s);bl(r,i,n),r.measurable=!1,e.addBoundsMask(i),ti.return(s),ds.return(i)}function Ml(r,e,t){return r?(r!==e&&(Ml(r.parent,e,t),r.updateLocalTransform(),t.append(r.localTransform)),t):(Ee("Mask bounds, renderable is not inside the root container"),t)}class Il{constructor(e){this.priority=0,this.pipe="alphaMask",e!=null&&e.mask&&this.init(e.mask)}init(e){this.mask=e,this.renderMaskToTexture=!(e instanceof j),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(e,t){El(this.mask,e,t)}addLocalBounds(e,t){Cl(this.mask,e,t)}containsPoint(e,t){const i=this.mask;return t(i,e)}destroy(){this.reset()}static test(e){return e instanceof j}}Il.extension=W.MaskEffect;class Rl{constructor(e){this.priority=0,this.pipe="colorMask",e!=null&&e.mask&&this.init(e.mask)}init(e){this.mask=e}destroy(){}static test(e){return typeof e=="number"}}Rl.extension=W.MaskEffect;class Ll{constructor(e){this.priority=0,this.pipe="stencilMask",e!=null&&e.mask&&this.init(e.mask)}init(e){this.mask=e,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(e,t){El(this.mask,e,t)}addLocalBounds(e,t){Cl(this.mask,e,t)}containsPoint(e,t){const i=this.mask;return t(i,e)}destroy(){this.reset()}static test(e){return e instanceof de}}Ll.extension=W.MaskEffect;const kf={createCanvas:(r,e)=>{const t=document.createElement("canvas");return t.width=r,t.height=e,t},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(r,e)=>fetch(r,e),parseXML:r=>new DOMParser().parseFromString(r,"text/xml")};let ch=kf;const ue={get(){return ch},set(r){ch=r}};class Fl extends ni{constructor(e){e.resource||(e.resource=ue.get().createCanvas()),e.width||(e.width=e.resource.width,e.autoDensity||(e.width/=e.resolution)),e.height||(e.height=e.resource.height,e.autoDensity||(e.height/=e.resolution)),super(e),this.uploadMethodId="image",this.autoDensity=e.autoDensity;const t=e.resource;(this.pixelWidth!==t.width||this.pixelWidth!==t.height)&&this.resizeCanvas(),this.transparent=!!e.transparent}resizeCanvas(){this.autoDensity&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(e=this.width,t=this.height,i=this._resolution){const s=super.resize(e,t,i);return s&&this.resizeCanvas(),s}static test(e){return globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&e instanceof OffscreenCanvas}}Fl.extension=W.TextureSource;class Ss extends ni{constructor(e){if(e.resource&&globalThis.HTMLImageElement&&e.resource instanceof HTMLImageElement){const t=ue.get().createCanvas(e.resource.width,e.resource.height);t.getContext("2d").drawImage(e.resource,0,0,e.resource.width,e.resource.height),e.resource=t,Ee("ImageSource: Image element passed, converting to canvas. Use CanvasSource instead.")}super(e),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(e){return globalThis.HTMLImageElement&&e instanceof HTMLImageElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||globalThis.VideoFrame&&e instanceof VideoFrame}}Ss.extension=W.TextureSource;var Hr=(r=>(r[r.INTERACTION=50]="INTERACTION",r[r.HIGH=25]="HIGH",r[r.NORMAL=0]="NORMAL",r[r.LOW=-25]="LOW",r[r.UTILITY=-50]="UTILITY",r))(Hr||{});class Ln{constructor(e,t=null,i=0,s=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=e,this._context=t,this.priority=i,this._once=s}match(e,t=null){return this._fn===e&&this._context===t}emit(e){this._fn&&(this._context?this._fn.call(this._context,e):this._fn(e));const t=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),t}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const t=this.next;return this.next=e?null:t,this.previous=null,t}}const Ol=class ht{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Ln(null,null,1/0),this.deltaMS=1/ht.targetFPMS,this.elapsedMS=1/ht.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,t,i=Hr.NORMAL){return this._addListener(new Ln(e,t,i))}addOnce(e,t,i=Hr.NORMAL){return this._addListener(new Ln(e,t,i,!0))}_addListener(e){let t=this._head.next,i=this._head;if(!t)e.connect(i);else{for(;t;){if(e.priority>t.priority){e.connect(i);break}i=t,t=t.next}e.previous||e.connect(i)}return this._startIfPossible(),this}remove(e,t){let i=this._head.next;for(;i;)i.match(e,t)?i=i.destroy():i=i.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,t=this._head;for(;t=t.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let t;if(e>this.lastTime){if(t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const n=e-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=e-n%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*ht.targetFPMS;const i=this._head;let s=i.next;for(;s;)s=s.emit(this);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const t=Math.min(this.maxFPS,e),i=Math.min(Math.max(0,t)/1e3,ht.targetFPMS);this._maxElapsedMS=1/i}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!ht._shared){const e=ht._shared=new ht;e.autoStart=!0,e._protected=!0}return ht._shared}static get system(){if(!ht._system){const e=ht._system=new ht;e.autoStart=!0,e._protected=!0}return ht._system}};Ol.targetFPMS=.06;let kt=Ol,Fn;async function Nl(){return Fn??(Fn=(async()=>{var a;const e=document.createElement("canvas").getContext("webgl");if(!e)return"premultiply-alpha-on-upload";const t=await new Promise(o=>{const l=document.createElement("video");l.onloadeddata=()=>o(l),l.onerror=()=>o(null),l.autoplay=!1,l.crossOrigin="anonymous",l.preload="auto",l.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",l.load()});if(!t)return"premultiply-alpha-on-upload";const i=e.createTexture();e.bindTexture(e.TEXTURE_2D,i);const s=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,s),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,i,0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t);const n=new Uint8Array(4);return e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,n),e.deleteFramebuffer(s),e.deleteTexture(i),(a=e.getExtension("WEBGL_lose_context"))==null||a.loseContext(),n[0]<=n[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),Fn}const tn=class Bl extends ni{constructor(e){super(e),this.isReady=!1,this.uploadMethodId="video",e={...Bl.defaultOptions,...e},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this.alphaMode=e.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),e.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const e=kt.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const e=this.resource,t=this.options;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(t.preload||e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlayThrough),e.addEventListener("error",this._onError,!0)),this.alphaMode=await Nl(),this._load=new Promise((i,s)=>{this.isValid?i(this):(this._resolve=i,this._reject=s,t.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${t.preloadTimeoutMs}ms`))})),e.load())}),this._load}_onError(e){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.resource;return!e.paused&&!e.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const e=this.resource;this.isValid&&(this.isReady=!0,this.resize(e.videoWidth,e.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const e=this.resource;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlayThrough),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(kt.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(kt.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(kt.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement}};tn.extension=W.TextureSource;tn.defaultOptions={...ni.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};tn.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let Rr=tn;const Et=(r,e,t=!1)=>(Array.isArray(r)||(r=[r]),e?r.map(i=>typeof i=="string"||t?e(i):i):r);class Ef{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const t=this._cache.get(e);return t||Ee(`[Assets] Asset id ${e} was not found in the Cache`),t}set(e,t){const i=Et(e);let s;for(let l=0;l<this.parsers.length;l++){const c=this.parsers[l];if(c.test(t)){s=c.getCacheableAssets(i,t);break}}const n=new Map(Object.entries(s||{}));s||i.forEach(l=>{n.set(l,t)});const a=[...n.keys()],o={cacheKeys:a,keys:i};i.forEach(l=>{this._cacheMap.set(l,o)}),a.forEach(l=>{const c=s?s[l]:t;this._cache.has(l)&&this._cache.get(l)!==c&&Ee("[Cache] already has key:",l),this._cache.set(l,n.get(l))})}remove(e){if(!this._cacheMap.has(e)){Ee(`[Assets] Asset id ${e} was not found in the Cache`);return}const t=this._cacheMap.get(e);t.cacheKeys.forEach(s=>{this._cache.delete(s)}),t.keys.forEach(s=>{this._cacheMap.delete(s)})}get parsers(){return this._parsers}}const pe=new Ef,_a=[];ze.handleByList(W.TextureSource,_a);function Gl(r={}){const e=r&&r.resource,t=e?r.resource:r,i=e?r:{resource:r};for(let s=0;s<_a.length;s++){const n=_a[s];if(n.test(t))return new n(i)}throw new Error(`Could not find a source type for resource: ${i.resource}`)}function Cf(r={},e=!1){const t=r&&r.resource,i=t?r.resource:r,s=t?r:{resource:r};if(!e&&pe.has(i))return pe.get(i);const n=new q({source:Gl(s)});return n.on("destroy",()=>{pe.has(i)&&pe.remove(i)}),e||pe.set(i,n),n}function Mf(r,e=!1){return typeof r=="string"?pe.get(r):r instanceof ni?new q({source:r}):Cf(r,e)}q.from=Mf;ni.from=Gl;ze.add(Il,Rl,Ll,Rr,Ss,Fl,qa);var yi=(r=>(r[r.Low=0]="Low",r[r.Normal=1]="Normal",r[r.High=2]="High",r))(yi||{});function Pt(r){if(typeof r!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(r)}`)}function Es(r){return r.split("?")[0].split("#")[0]}function If(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Rf(r,e,t){return r.replace(new RegExp(If(e),"g"),t)}function Lf(r,e){let t="",i=0,s=-1,n=0,a=-1;for(let o=0;o<=r.length;++o){if(o<r.length)a=r.charCodeAt(o);else{if(a===47)break;a=47}if(a===47){if(!(s===o-1||n===1))if(s!==o-1&&n===2){if(t.length<2||i!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){const l=t.lastIndexOf("/");if(l!==t.length-1){l===-1?(t="",i=0):(t=t.slice(0,l),i=t.length-1-t.lastIndexOf("/")),s=o,n=0;continue}}else if(t.length===2||t.length===1){t="",i=0,s=o,n=0;continue}}}else t.length>0?t+=`/${r.slice(s+1,o)}`:t=r.slice(s+1,o),i=o-s-1;s=o,n=0}else a===46&&n!==-1?++n:n=-1}return t}const et={toPosix(r){return Rf(r,"\\","/")},isUrl(r){return/^https?:/.test(this.toPosix(r))},isDataUrl(r){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(r)},isBlobUrl(r){return r.startsWith("blob:")},hasProtocol(r){return/^[^/:]+:/.test(this.toPosix(r))},getProtocol(r){Pt(r),r=this.toPosix(r);const e=/^file:\/\/\//.exec(r);if(e)return e[0];const t=/^[^/:]+:\/{0,2}/.exec(r);return t?t[0]:""},toAbsolute(r,e,t){if(Pt(r),this.isDataUrl(r)||this.isBlobUrl(r))return r;const i=Es(this.toPosix(e??ue.get().getBaseUrl())),s=Es(this.toPosix(t??this.rootname(i)));return r=this.toPosix(r),r.startsWith("/")?et.join(s,r.slice(1)):this.isAbsolute(r)?r:this.join(i,r)},normalize(r){if(Pt(r),r.length===0)return".";if(this.isDataUrl(r)||this.isBlobUrl(r))return r;r=this.toPosix(r);let e="";const t=r.startsWith("/");this.hasProtocol(r)&&(e=this.rootname(r),r=r.slice(e.length));const i=r.endsWith("/");return r=Lf(r),r.length>0&&i&&(r+="/"),t?`/${r}`:e+r},isAbsolute(r){return Pt(r),r=this.toPosix(r),this.hasProtocol(r)?!0:r.startsWith("/")},join(...r){if(r.length===0)return".";let e;for(let t=0;t<r.length;++t){const i=r[t];if(Pt(i),i.length>0)if(e===void 0)e=i;else{const s=r[t-1]??"";this.joinExtensions.includes(this.extname(s).toLowerCase())?e+=`/../${i}`:e+=`/${i}`}}return e===void 0?".":this.normalize(e)},dirname(r){if(Pt(r),r.length===0)return".";r=this.toPosix(r);let e=r.charCodeAt(0);const t=e===47;let i=-1,s=!0;const n=this.getProtocol(r),a=r;r=r.slice(n.length);for(let o=r.length-1;o>=1;--o)if(e=r.charCodeAt(o),e===47){if(!s){i=o;break}}else s=!1;return i===-1?t?"/":this.isUrl(a)?n+r:n:t&&i===1?"//":n+r.slice(0,i)},rootname(r){Pt(r),r=this.toPosix(r);let e="";if(r.startsWith("/")?e="/":e=this.getProtocol(r),this.isUrl(r)){const t=r.indexOf("/",e.length);t!==-1?e=r.slice(0,t):e=r,e.endsWith("/")||(e+="/")}return e},basename(r,e){Pt(r),e&&Pt(e),r=Es(this.toPosix(r));let t=0,i=-1,s=!0,n;if(e!==void 0&&e.length>0&&e.length<=r.length){if(e.length===r.length&&e===r)return"";let a=e.length-1,o=-1;for(n=r.length-1;n>=0;--n){const l=r.charCodeAt(n);if(l===47){if(!s){t=n+1;break}}else o===-1&&(s=!1,o=n+1),a>=0&&(l===e.charCodeAt(a)?--a===-1&&(i=n):(a=-1,i=o))}return t===i?i=o:i===-1&&(i=r.length),r.slice(t,i)}for(n=r.length-1;n>=0;--n)if(r.charCodeAt(n)===47){if(!s){t=n+1;break}}else i===-1&&(s=!1,i=n+1);return i===-1?"":r.slice(t,i)},extname(r){Pt(r),r=Es(this.toPosix(r));let e=-1,t=0,i=-1,s=!0,n=0;for(let a=r.length-1;a>=0;--a){const o=r.charCodeAt(a);if(o===47){if(!s){t=a+1;break}continue}i===-1&&(s=!1,i=a+1),o===46?e===-1?e=a:n!==1&&(n=1):e!==-1&&(n=-1)}return e===-1||i===-1||n===0||n===1&&e===i-1&&e===t+1?"":r.slice(e,i)},parse(r){Pt(r);const e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;r=Es(this.toPosix(r));let t=r.charCodeAt(0);const i=this.isAbsolute(r);let s;e.root=this.rootname(r),i||this.hasProtocol(r)?s=1:s=0;let n=-1,a=0,o=-1,l=!0,c=r.length-1,u=0;for(;c>=s;--c){if(t=r.charCodeAt(c),t===47){if(!l){a=c+1;break}continue}o===-1&&(l=!1,o=c+1),t===46?n===-1?n=c:u!==1&&(u=1):n!==-1&&(u=-1)}return n===-1||o===-1||u===0||u===1&&n===o-1&&n===a+1?o!==-1&&(a===0&&i?e.base=e.name=r.slice(1,o):e.base=e.name=r.slice(a,o)):(a===0&&i?(e.name=r.slice(1,n),e.base=r.slice(1,o)):(e.name=r.slice(a,n),e.base=r.slice(a,o)),e.ext=r.slice(n,o)),e.dir=this.dirname(r),e},sep:"/",delimiter:":",joinExtensions:[".html"]};function Dl(r,e,t,i,s){const n=e[t];for(let a=0;a<n.length;a++){const o=n[a];t<e.length-1?Dl(r.replace(i[t],o),e,t+1,i,s):s.push(r.replace(i[t],o))}}function Ff(r){const e=/\{(.*?)\}/g,t=r.match(e),i=[];if(t){const s=[];t.forEach(n=>{const a=n.substring(1,n.length-1).split(",");s.push(a)}),Dl(r,s,0,t,i)}else i.push(r);return i}const Ur=r=>!Array.isArray(r);class Ts{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,t)=>`${e}${this._bundleIdConnector}${t}`,extractAssetIdFromBundle:(e,t)=>t.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(t=>{this._preferredOrder.push(t),t.priority||(t.priority=Object.keys(t.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const t=e;this._defaultSearchParams=Object.keys(t).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(t[i])}`).join("&")}}getAlias(e){const{alias:t,src:i}=e;return Et(t||i,n=>typeof n=="string"?n:Array.isArray(n)?n.map(a=>(a==null?void 0:a.src)??a):n!=null&&n.src?n.src:n,!0)}addManifest(e){this._manifest&&Ee("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(t=>{this.addBundle(t.name,t.assets)})}addBundle(e,t){const i=[];let s=t;Array.isArray(t)||(s=Object.entries(t).map(([n,a])=>typeof a=="string"||Array.isArray(a)?{alias:n,src:a}:{alias:n,...a})),s.forEach(n=>{const a=n.src,o=n.alias;let l;if(typeof o=="string"){const c=this._createBundleAssetId(e,o);i.push(c),l=[o,c]}else{const c=o.map(u=>this._createBundleAssetId(e,u));i.push(...c),l=[...o,...c]}this.add({...n,alias:l,src:a})}),this._bundles[e]=i}add(e){const t=[];Array.isArray(e)?t.push(...e):t.push(e);let i;i=n=>{this.hasKey(n)&&Ee(`[Resolver] already has key: ${n} overwriting`)},Et(t).forEach(n=>{const{src:a}=n;let{data:o,format:l,loadParser:c}=n;const u=Et(a).map(f=>typeof f=="string"?Ff(f):Array.isArray(f)?f:[f]),h=this.getAlias(n);Array.isArray(h)?h.forEach(i):i(h);const d=[];u.forEach(f=>{f.forEach(p=>{let _={};if(typeof p!="object"){_.src=p;for(let g=0;g<this._parsers.length;g++){const m=this._parsers[g];if(m.test(p)){_=m.parse(p);break}}}else o=p.data??o,l=p.format??l,c=p.loadParser??c,_={..._,...p};if(!h)throw new Error(`[Resolver] alias is undefined for this asset: ${_.src}`);_=this._buildResolvedAsset(_,{aliases:h,data:o,format:l,loadParser:c}),d.push(_)})}),h.forEach(f=>{this._assetMap[f]=d})})}resolveBundle(e){const t=Ur(e);e=Et(e);const i={};return e.forEach(s=>{const n=this._bundles[s];if(n){const a=this.resolve(n),o={};for(const l in a){const c=a[l];o[this._extractAssetIdFromBundle(s,l)]=c}i[s]=o}}),t?i[e[0]]:i}resolveUrl(e){const t=this.resolve(e);if(typeof e!="string"){const i={};for(const s in t)i[s]=t[s].src;return i}return t.src}resolve(e){const t=Ur(e);e=Et(e);const i={};return e.forEach(s=>{if(!this._resolverHash[s])if(this._assetMap[s]){let n=this._assetMap[s];const a=this._getPreferredOrder(n);a==null||a.priority.forEach(o=>{a.params[o].forEach(l=>{const c=n.filter(u=>u[o]?u[o]===l:!1);c.length&&(n=c)})}),this._resolverHash[s]=n[0]}else this._resolverHash[s]=this._buildResolvedAsset({alias:[s],src:s},{});i[s]=this._resolverHash[s]}),t?i[e[0]]:i}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let t=0;t<e.length;t++){const i=e[0],s=this._preferredOrder.find(n=>n.params.format.includes(i.format));if(s)return s}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const t=/\?/.test(e)?"&":"?";return`${e}${t}${this._defaultSearchParams}`}_buildResolvedAsset(e,t){const{aliases:i,data:s,loadParser:n,format:a}=t;return(this._basePath||this._rootPath)&&(e.src=et.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=i??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...s||{},...e.data},e.loadParser=n??e.loadParser,e.format=a??e.format??Of(e.src),e}}Ts.RETINA_PREFIX=/@([0-9\.]+)x/;function Of(r){return r.split(".").pop().split("?").shift().split("#").shift()}const ga=(r,e)=>{const t=e.split("?")[1];return t&&(r+=`?${t}`),r},Hl=class Fs{constructor(e,t){this.linkedSheets=[],this._texture=e instanceof q?e:null,this.textureSource=e.source,this.textures={},this.animations={},this.data=t;const i=parseFloat(t.meta.scale);i?(this.resolution=i,e.source.resolution=this.resolution):this.resolution=e.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=Fs.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let t=e;const i=Fs.BATCH_SIZE;for(;t-e<i&&t<this._frameKeys.length;){const s=this._frameKeys[t],n=this._frames[s],a=n.frame;if(a){let o=null,l=null;const c=n.trimmed!==!1&&n.sourceSize?n.sourceSize:n.frame,u=new ke(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);n.rotated?o=new ke(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.h)/this.resolution,Math.floor(a.w)/this.resolution):o=new ke(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution),n.trimmed!==!1&&n.spriteSourceSize&&(l=new ke(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution)),this.textures[s]=new q({source:this.textureSource,frame:o,orig:u,trim:l,rotate:n.rotated?2:0,defaultAnchor:n.anchor,defaultBorders:n.borders,label:s.toString()})}t++}}_processAnimations(){const e=this.data.animations||{};for(const t in e){this.animations[t]=[];for(let i=0;i<e[t].length;i++){const s=e[t][i];this.animations[t].push(this.textures[s])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Fs.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Fs.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){var t;for(const i in this.textures)this.textures[i].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&((t=this._texture)==null||t.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};Hl.BATCH_SIZE=1e3;let ma=Hl;const Nf=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function Ul(r,e,t){const i={};if(r.forEach(s=>{i[s]=e}),Object.keys(e.textures).forEach(s=>{i[s]=e.textures[s]}),!t){const s=et.dirname(r[0]);e.linkedSheets.forEach((n,a)=>{const o=Ul([`${s}/${e.data.meta.related_multi_packs[a]}`],n,!0);Object.assign(i,o)})}return i}const Bf={extension:W.Asset,cache:{test:r=>r instanceof ma,getCacheableAssets:(r,e)=>Ul(r,e,!1)},resolver:{extension:{type:W.ResolveParser,name:"resolveSpritesheet"},test:r=>{const t=r.split("?")[0].split("."),i=t.pop(),s=t.pop();return i==="json"&&Nf.includes(s)},parse:r=>{var t;const e=r.split(".");return{resolution:parseFloat(((t=Ts.RETINA_PREFIX.exec(r))==null?void 0:t[1])??"1"),format:e[e.length-2],src:r}}},loader:{name:"spritesheetLoader",extension:{type:W.LoadParser,priority:yi.Normal,name:"spritesheetLoader"},async testParse(r,e){return et.extname(e.src).toLowerCase()===".json"&&!!r.frames},async parse(r,e,t){var c,u;const{texture:i,imageFilename:s}=(e==null?void 0:e.data)??{};let n=et.dirname(e.src);n&&n.lastIndexOf("/")!==n.length-1&&(n+="/");let a;if(i instanceof q)a=i;else{const h=ga(n+(s??r.meta.image),e.src);a=(await t.load([h]))[h]}const o=new ma(a.source,r);await o.parse();const l=(c=r==null?void 0:r.meta)==null?void 0:c.related_multi_packs;if(Array.isArray(l)){const h=[];for(const f of l){if(typeof f!="string")continue;let p=n+f;(u=e.data)!=null&&u.ignoreMultiPack||(p=ga(p,e.src),h.push(t.load({src:p,data:{ignoreMultiPack:!0}})))}const d=await Promise.all(h);o.linkedSheets=d,d.forEach(f=>{f.linkedSheets=[o].concat(o.linkedSheets.filter(p=>p!==f))})}return o},async unload(r,e,t){await t.unload(r.textureSource._sourceOrigin),r.destroy(!1)}}};ze.add(Bf);let ji;function Gf(){return(!ji||ji!=null&&ji.isContextLost())&&(ji=ue.get().createCanvas().getContext("webgl",{})),ji}class Df{constructor(e){this.resources=Object.create(null),this._dirty=!0;let t=0;for(const i in e){const s=e[i];this.setResource(s,t++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const e=[];let t=0;for(const i in this.resources)e[t++]=this.resources[i]._resourceId;this._key=e.join("|")}setResource(e,t){var s,n;const i=this.resources[t];e!==i&&(i&&((s=e.off)==null||s.call(e,"change",this.onResourceChange,this)),(n=e.on)==null||n.call(e,"change",this.onResourceChange,this),this.resources[t]=e,this._dirty=!0)}getResource(e){return this.resources[e]}_touch(e){const t=this.resources;for(const i in t)t[i]._touched=e}destroy(){var t;const e=this.resources;for(const i in e){const s=e[i];(t=s.off)==null||t.call(s,"change",this.onResourceChange,this)}this.resources=null}onResourceChange(e){if(this._dirty=!0,e.destroyed){const t=this.resources;for(const i in t)t[i]===e&&(t[i]=null)}else this._updateKey()}}const xa=[];ze.handleByNamedList(W.Environment,xa);async function Hf(r){if(!r)for(let e=0;e<xa.length;e++){const t=xa[e];if(t.value.test()){await t.value.load();return}}}let Cs;function Uf(){if(typeof Cs=="boolean")return Cs;try{Cs=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Cs=!1}return Cs}var Qa={exports:{}};Qa.exports=sn;Qa.exports.default=sn;function sn(r,e,t){t=t||2;var i=e&&e.length,s=i?e[0]*t:r.length,n=zl(r,0,s,t,!0),a=[];if(!n||n.next===n.prev)return a;var o,l,c,u,h,d,f;if(i&&(n=Xf(r,e,n,t)),r.length>80*t){o=c=r[0],l=u=r[1];for(var p=t;p<s;p+=t)h=r[p],d=r[p+1],h<o&&(o=h),d<l&&(l=d),h>c&&(c=h),d>u&&(u=d);f=Math.max(c-o,u-l),f=f!==0?32767/f:0}return Ys(n,a,t,o,l,f,0),a}function zl(r,e,t,i,s){var n,a;if(s===Ta(r,e,t,i)>0)for(n=e;n<t;n+=i)a=uh(n,r[n],r[n+1],a);else for(n=t-i;n>=e;n-=i)a=uh(n,r[n],r[n+1],a);return a&&rn(a,a.next)&&(Xs(a),a=a.next),a}function Wi(r,e){if(!r)return r;e||(e=r);var t=r,i;do if(i=!1,!t.steiner&&(rn(t,t.next)||ge(t.prev,t,t.next)===0)){if(Xs(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function Ys(r,e,t,i,s,n,a){if(r){!a&&n&&Zf(r,i,s,n);for(var o=r,l,c;r.prev!==r.next;){if(l=r.prev,c=r.next,n?Wf(r,i,s,n):zf(r)){e.push(l.i/t|0),e.push(r.i/t|0),e.push(c.i/t|0),Xs(r),r=c.next,o=c.next;continue}if(r=c,r===o){a?a===1?(r=Yf(Wi(r),e,t),Ys(r,e,t,i,s,n,2)):a===2&&Vf(r,e,t,i,s,n):Ys(Wi(r),e,t,i,s,n,1);break}}}}function zf(r){var e=r.prev,t=r,i=r.next;if(ge(e,t,i)>=0)return!1;for(var s=e.x,n=t.x,a=i.x,o=e.y,l=t.y,c=i.y,u=s<n?s<a?s:a:n<a?n:a,h=o<l?o<c?o:c:l<c?l:c,d=s>n?s>a?s:a:n>a?n:a,f=o>l?o>c?o:c:l>c?l:c,p=i.next;p!==e;){if(p.x>=u&&p.x<=d&&p.y>=h&&p.y<=f&&ts(s,o,n,l,a,c,p.x,p.y)&&ge(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Wf(r,e,t,i){var s=r.prev,n=r,a=r.next;if(ge(s,n,a)>=0)return!1;for(var o=s.x,l=n.x,c=a.x,u=s.y,h=n.y,d=a.y,f=o<l?o<c?o:c:l<c?l:c,p=u<h?u<d?u:d:h<d?h:d,_=o>l?o>c?o:c:l>c?l:c,g=u>h?u>d?u:d:h>d?h:d,m=ya(f,p,e,t,i),x=ya(_,g,e,t,i),S=r.prevZ,w=r.nextZ;S&&S.z>=m&&w&&w.z<=x;){if(S.x>=f&&S.x<=_&&S.y>=p&&S.y<=g&&S!==s&&S!==a&&ts(o,u,l,h,c,d,S.x,S.y)&&ge(S.prev,S,S.next)>=0||(S=S.prevZ,w.x>=f&&w.x<=_&&w.y>=p&&w.y<=g&&w!==s&&w!==a&&ts(o,u,l,h,c,d,w.x,w.y)&&ge(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;S&&S.z>=m;){if(S.x>=f&&S.x<=_&&S.y>=p&&S.y<=g&&S!==s&&S!==a&&ts(o,u,l,h,c,d,S.x,S.y)&&ge(S.prev,S,S.next)>=0)return!1;S=S.prevZ}for(;w&&w.z<=x;){if(w.x>=f&&w.x<=_&&w.y>=p&&w.y<=g&&w!==s&&w!==a&&ts(o,u,l,h,c,d,w.x,w.y)&&ge(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function Yf(r,e,t){var i=r;do{var s=i.prev,n=i.next.next;!rn(s,n)&&Wl(s,i,i.next,n)&&Vs(s,n)&&Vs(n,s)&&(e.push(s.i/t|0),e.push(i.i/t|0),e.push(n.i/t|0),Xs(i),Xs(i.next),i=r=n),i=i.next}while(i!==r);return Wi(i)}function Vf(r,e,t,i,s,n){var a=r;do{for(var o=a.next.next;o!==a.prev;){if(a.i!==o.i&&ep(a,o)){var l=Yl(a,o);a=Wi(a,a.next),l=Wi(l,l.next),Ys(a,e,t,i,s,n,0),Ys(l,e,t,i,s,n,0);return}o=o.next}a=a.next}while(a!==r)}function Xf(r,e,t,i){var s=[],n,a,o,l,c;for(n=0,a=e.length;n<a;n++)o=e[n]*i,l=n<a-1?e[n+1]*i:r.length,c=zl(r,o,l,i,!1),c===c.next&&(c.steiner=!0),s.push(Jf(c));for(s.sort($f),n=0;n<s.length;n++)t=jf(s[n],t);return t}function $f(r,e){return r.x-e.x}function jf(r,e){var t=qf(r,e);if(!t)return e;var i=Yl(t,r);return Wi(i,i.next),Wi(t,t.next)}function qf(r,e){var t=e,i=r.x,s=r.y,n=-1/0,a;do{if(s<=t.y&&s>=t.next.y&&t.next.y!==t.y){var o=t.x+(s-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(o<=i&&o>n&&(n=o,a=t.x<t.next.x?t:t.next,o===i))return a}t=t.next}while(t!==e);if(!a)return null;var l=a,c=a.x,u=a.y,h=1/0,d;t=a;do i>=t.x&&t.x>=c&&i!==t.x&&ts(s<u?i:n,s,c,u,s<u?n:i,s,t.x,t.y)&&(d=Math.abs(s-t.y)/(i-t.x),Vs(t,r)&&(d<h||d===h&&(t.x>a.x||t.x===a.x&&Kf(a,t)))&&(a=t,h=d)),t=t.next;while(t!==l);return a}function Kf(r,e){return ge(r.prev,r,e.prev)<0&&ge(e.next,r,r.next)<0}function Zf(r,e,t,i){var s=r;do s.z===0&&(s.z=ya(s.x,s.y,e,t,i)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==r);s.prevZ.nextZ=null,s.prevZ=null,Qf(s)}function Qf(r){var e,t,i,s,n,a,o,l,c=1;do{for(t=r,r=null,n=null,a=0;t;){for(a++,i=t,o=0,e=0;e<c&&(o++,i=i.nextZ,!!i);e++);for(l=c;o>0||l>0&&i;)o!==0&&(l===0||!i||t.z<=i.z)?(s=t,t=t.nextZ,o--):(s=i,i=i.nextZ,l--),n?n.nextZ=s:r=s,s.prevZ=n,n=s;t=i}n.nextZ=null,c*=2}while(a>1);return r}function ya(r,e,t,i,s){return r=(r-t)*s|0,e=(e-i)*s|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,r|e<<1}function Jf(r){var e=r,t=r;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==r);return t}function ts(r,e,t,i,s,n,a,o){return(s-a)*(e-o)>=(r-a)*(n-o)&&(r-a)*(i-o)>=(t-a)*(e-o)&&(t-a)*(n-o)>=(s-a)*(i-o)}function ep(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!tp(r,e)&&(Vs(r,e)&&Vs(e,r)&&ip(r,e)&&(ge(r.prev,r,e.prev)||ge(r,e.prev,e))||rn(r,e)&&ge(r.prev,r,r.next)>0&&ge(e.prev,e,e.next)>0)}function ge(r,e,t){return(e.y-r.y)*(t.x-e.x)-(e.x-r.x)*(t.y-e.y)}function rn(r,e){return r.x===e.x&&r.y===e.y}function Wl(r,e,t,i){var s=wr(ge(r,e,t)),n=wr(ge(r,e,i)),a=wr(ge(t,i,r)),o=wr(ge(t,i,e));return!!(s!==n&&a!==o||s===0&&Tr(r,t,e)||n===0&&Tr(r,i,e)||a===0&&Tr(t,r,i)||o===0&&Tr(t,e,i))}function Tr(r,e,t){return e.x<=Math.max(r.x,t.x)&&e.x>=Math.min(r.x,t.x)&&e.y<=Math.max(r.y,t.y)&&e.y>=Math.min(r.y,t.y)}function wr(r){return r>0?1:r<0?-1:0}function tp(r,e){var t=r;do{if(t.i!==r.i&&t.next.i!==r.i&&t.i!==e.i&&t.next.i!==e.i&&Wl(t,t.next,r,e))return!0;t=t.next}while(t!==r);return!1}function Vs(r,e){return ge(r.prev,r,r.next)<0?ge(r,e,r.next)>=0&&ge(r,r.prev,e)>=0:ge(r,e,r.prev)<0||ge(r,r.next,e)<0}function ip(r,e){var t=r,i=!1,s=(r.x+e.x)/2,n=(r.y+e.y)/2;do t.y>n!=t.next.y>n&&t.next.y!==t.y&&s<(t.next.x-t.x)*(n-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==r);return i}function Yl(r,e){var t=new Sa(r.i,r.x,r.y),i=new Sa(e.i,e.x,e.y),s=r.next,n=e.prev;return r.next=e,e.prev=r,t.next=s,s.prev=t,i.next=t,t.prev=i,n.next=i,i.prev=n,i}function uh(r,e,t,i){var s=new Sa(r,e,t);return i?(s.next=i.next,s.prev=i,i.next.prev=s,i.next=s):(s.prev=s,s.next=s),s}function Xs(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Sa(r,e,t){this.i=r,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}sn.deviation=function(r,e,t,i){var s=e&&e.length,n=s?e[0]*t:r.length,a=Math.abs(Ta(r,0,n,t));if(s)for(var o=0,l=e.length;o<l;o++){var c=e[o]*t,u=o<l-1?e[o+1]*t:r.length;a-=Math.abs(Ta(r,c,u,t))}var h=0;for(o=0;o<i.length;o+=3){var d=i[o]*t,f=i[o+1]*t,p=i[o+2]*t;h+=Math.abs((r[d]-r[p])*(r[f+1]-r[d+1])-(r[d]-r[f])*(r[p+1]-r[d+1]))}return a===0&&h===0?0:Math.abs((h-a)/a)};function Ta(r,e,t,i){for(var s=0,n=e,a=t-i;n<t;n+=i)s+=(r[a]-r[n])*(r[n+1]+r[a+1]),a=n;return s}sn.flatten=function(r){for(var e=r[0][0].length,t={vertices:[],holes:[],dimensions:e},i=0,s=0;s<r.length;s++){for(var n=0;n<r[s].length;n++)for(var a=0;a<e;a++)t.vertices.push(r[s][n][a]);s>0&&(i+=r[s-1].length,t.holes.push(i))}return t};var sp=Qa.exports;const rp=rr(sp);var Vl=(r=>(r[r.NONE=0]="NONE",r[r.COLOR=16384]="COLOR",r[r.STENCIL=1024]="STENCIL",r[r.DEPTH=256]="DEPTH",r[r.COLOR_DEPTH=16640]="COLOR_DEPTH",r[r.COLOR_STENCIL=17408]="COLOR_STENCIL",r[r.DEPTH_STENCIL=1280]="DEPTH_STENCIL",r[r.ALL=17664]="ALL",r))(Vl||{});class np{constructor(e){this.items=[],this._name=e}emit(e,t,i,s,n,a,o,l){const{name:c,items:u}=this;for(let h=0,d=u.length;h<d;h++)u[h][c](e,t,i,s,n,a,o,l);return this}add(e){return e[this._name]&&(this.remove(e),this.items.push(e)),this}remove(e){const t=this.items.indexOf(e);return t!==-1&&this.items.splice(t,1),this}contains(e){return this.items.indexOf(e)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const ap=["init","destroy","contextChange","resolutionChange","reset","renderEnd","renderStart","render","update","postrender","prerender"],Xl=class $l extends Yt{constructor(e){super(),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=e.type,this.name=e.name,this.config=e;const t=[...ap,...this.config.runners??[]];this._addRunners(...t),this._unsafeEvalCheck()}async init(e={}){const t=e.skipExtensionImports===!0?!0:e.manageImports===!1;await Hf(t),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const i in this._systemsHash)e={...this._systemsHash[i].constructor.defaultOptions,...e};e={...$l.defaultOptions,...e},this._roundPixels=e.roundPixels?1:0;for(let i=0;i<this.runners.init.items.length;i++)await this.runners.init.items[i].init(e);this._initOptions=e}render(e,t){let i=e;if(i instanceof de&&(i={container:i},t&&(oe(ae,"passing a second argument is deprecated, please use render options instead"),i.target=t.renderTexture)),i.target||(i.target=this.view.renderTarget),i.target===this.view.renderTarget&&(this._lastObjectRendered=i.container,i.clearColor=this.background.colorRgba),i.clearColor){const s=Array.isArray(i.clearColor)&&i.clearColor.length===4;i.clearColor=s?i.clearColor:Ae.shared.setValue(i.clearColor).toArray()}i.transform||(i.container.updateLocalTransform(),i.transform=i.container.localTransform),this.runners.prerender.emit(i),this.runners.renderStart.emit(i),this.runners.render.emit(i),this.runners.renderEnd.emit(i),this.runners.postrender.emit(i)}resize(e,t,i){this.view.resize(e,t,i),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution)}clear(e={}){const t=this;e.target||(e.target=t.renderTarget.renderTarget),e.clearColor||(e.clearColor=this.background.colorRgba),e.clear??(e.clear=Vl.ALL);const{clear:i,clearColor:s,target:n}=e;Ae.shared.setValue(s??this.background.colorRgba),t.renderTarget.clear(n,i,Ae.shared.toArray())}get resolution(){return this.view.resolution}set resolution(e){this.view.resolution=e,this.runners.resolutionChange.emit(e)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...e){e.forEach(t=>{this.runners[t]=new np(t)})}_addSystems(e){let t;for(t in e){const i=e[t];this._addSystem(i.value,i.name)}}_addSystem(e,t){const i=new e(this);if(this[t])throw new Error(`Whoops! The name "${t}" is already in use`);this[t]=i,this._systemsHash[t]=i;for(const s in this.runners)this.runners[s].add(i);return this}_addPipes(e,t){const i=t.reduce((s,n)=>(s[n.name]=n.value,s),{});e.forEach(s=>{const n=s.value,a=s.name,o=i[a];this.renderPipes[a]=new n(this,o?new o:null)})}destroy(e=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(e),Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(e){return this.textureGenerator.generateTexture(e)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!Uf())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}};Xl.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let jl=Xl,vr;function op(r){return vr!==void 0||(vr=(()=>{var t;const e={stencil:!0,failIfMajorPerformanceCaveat:r??jl.defaultOptions.failIfMajorPerformanceCaveat};try{if(!ue.get().getWebGLRenderingContext())return!1;let s=ue.get().createCanvas().getContext("webgl",e);const n=!!((t=s==null?void 0:s.getContextAttributes())!=null&&t.stencil);if(s){const a=s.getExtension("WEBGL_lose_context");a&&a.loseContext()}return s=null,n}catch{return!1}})()),vr}let br;async function hp(r={}){return br!==void 0||(br=await(async()=>{const e=ue.get().getNavigator().gpu;if(!e)return!1;try{return await(await e.requestAdapter(r)).requestDevice(),!0}catch{return!1}})()),br}const dh=["webgl","webgpu","canvas"];async function lp(r){let e=[];r.preference?(e.push(r.preference),dh.forEach(n=>{n!==r.preference&&e.push(n)})):e=dh.slice();let t,i={};for(let n=0;n<e.length;n++){const a=e[n];if(a==="webgpu"&&await hp()){const{WebGPURenderer:o}=await Gr(async()=>{const{WebGPURenderer:l}=await import("./WebGPURenderer-BVrGIWip.js");return{WebGPURenderer:l}},__vite__mapDeps([4,2,5]),import.meta.url);t=o,i={...r,...r.webgpu};break}else if(a==="webgl"&&op(r.failIfMajorPerformanceCaveat??jl.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:o}=await Gr(async()=>{const{WebGLRenderer:l}=await import("./WebGLRenderer-BFsvZTE6.js");return{WebGLRenderer:l}},__vite__mapDeps([6,2,3,5]),import.meta.url);t=o,i={...r,...r.webgl};break}else if(a==="canvas")throw i={...r},new Error("CanvasRenderer is not yet implemented")}if(delete i.webgpu,delete i.webgl,!t)throw new Error("No available renderer for the current environment");const s=new t;return await s.init(i),s}class ql{static init(){var e;(e=globalThis.__PIXI_APP_INIT__)==null||e.call(globalThis,this)}static destroy(){}}ql.extension=W.Application;class cp{constructor(e){this._renderer=e}init(){var e;(e=globalThis.__PIXI_RENDERER_INIT__)==null||e.call(globalThis,this._renderer)}destroy(){this._renderer=null}}cp.extension={type:[W.WebGLSystem,W.WebGPUSystem],name:"initHook",priority:-10};const Kl=class wa{constructor(...e){this.stage=new de,e[0]!==void 0&&oe(ae,"Application constructor options are deprecated, please use Application.init() instead.")}async init(e){e={...e},this.renderer=await lp(e),wa._plugins.forEach(t=>{t.init.call(this,e)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return oe(ae,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(e=!1,t=!1){const i=wa._plugins.slice(0);i.reverse(),i.forEach(s=>{s.destroy.call(this)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(e),this.renderer=null}};Kl._plugins=[];let Zl=Kl;ze.handleByList(W.Application,Zl._plugins);ze.add(ql);class Ql extends Yt{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return oe(ae,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return oe(ae,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return oe(ae,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return oe(ae,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return oe(ae,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(e=!1){var t;this.emit("destroy",this),this.removeAllListeners();for(const i in this.chars)(t=this.chars[i].texture)==null||t.destroy();this.chars=null,e&&(this.pages.forEach(i=>i.texture.destroy(!0)),this.pages=null)}}const Jl=class va{constructor(e,t,i,s){this.uid=Ge("fillGradient"),this.type="linear",this.gradientStops=[],this._styleKey=null,this.x0=e,this.y0=t,this.x1=i,this.y1=s}addColorStop(e,t){return this.gradientStops.push({offset:e,color:Ae.shared.setValue(t).toHexa()}),this._styleKey=null,this}buildLinearGradient(){const e=va.defaultTextureSize,{gradientStops:t}=this,i=ue.get().createCanvas();i.width=e,i.height=e;const s=i.getContext("2d"),n=s.createLinearGradient(0,0,va.defaultTextureSize,1);for(let _=0;_<t.length;_++){const g=t[_];n.addColorStop(g.offset,g.color)}s.fillStyle=n,s.fillRect(0,0,e,e),this.texture=new q({source:new Ss({resource:i,addressModeU:"clamp-to-edge",addressModeV:"repeat"})});const{x0:a,y0:o,x1:l,y1:c}=this,u=new re,h=l-a,d=c-o,f=Math.sqrt(h*h+d*d),p=Math.atan2(d,h);u.translate(-a,-o),u.scale(1/e,1/e),u.rotate(-p),u.scale(256/f,1),this.transform=u,this._styleKey=null}get styleKey(){if(this._styleKey)return this._styleKey;const e=this.gradientStops.map(s=>`${s.offset}-${s.color}`).join("-"),t=this.texture.uid,i=this.transform.toArray().join("-");return`fill-gradient-${this.uid}-${e}-${t}-${i}-${this.x0}-${this.y0}-${this.x1}-${this.y1}`}};Jl.defaultTextureSize=256;let $s=Jl;const fh={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class nn{constructor(e,t){this.uid=Ge("fillPattern"),this.transform=new re,this._styleKey=null,this.texture=e,this.transform.scale(1/e.frame.width,1/e.frame.height),t&&(e.source.style.addressModeU=fh[t].addressModeU,e.source.style.addressModeV=fh[t].addressModeV)}setTransform(e){const t=this.texture;this.transform.copyFrom(e),this.transform.invert(),this.transform.scale(1/t.frame.width,1/t.frame.height),this._styleKey=null}get styleKey(){return this._styleKey?this._styleKey:(this._styleKey=`fill-pattern-${this.uid}-${this.texture.uid}-${this.transform.toArray().join("-")}`,this._styleKey)}}var up=fp,On={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},dp=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function fp(r){var e=[];return r.replace(dp,function(t,i,s){var n=i.toLowerCase();for(s=_p(s),n=="m"&&s.length>2&&(e.push([i].concat(s.splice(0,2))),n="l",i=i=="m"?"l":"L");;){if(s.length==On[n])return s.unshift(i),e.push(s);if(s.length<On[n])throw new Error("malformed path data");e.push([i].concat(s.splice(0,On[n])))}}),e}var pp=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function _p(r){var e=r.match(pp);return e?e.map(Number):[]}const gp=rr(up);function mp(r,e){const t=gp(r),i=[];let s=null,n=0,a=0;for(let o=0;o<t.length;o++){const l=t[o],c=l[0],u=l;switch(c){case"M":n=u[1],a=u[2],e.moveTo(n,a);break;case"m":n+=u[1],a+=u[2],e.moveTo(n,a);break;case"H":n=u[1],e.lineTo(n,a);break;case"h":n+=u[1],e.lineTo(n,a);break;case"V":a=u[1],e.lineTo(n,a);break;case"v":a+=u[1],e.lineTo(n,a);break;case"L":n=u[1],a=u[2],e.lineTo(n,a);break;case"l":n+=u[1],a+=u[2],e.lineTo(n,a);break;case"C":n=u[5],a=u[6],e.bezierCurveTo(u[1],u[2],u[3],u[4],n,a);break;case"c":e.bezierCurveTo(n+u[1],a+u[2],n+u[3],a+u[4],n+u[5],a+u[6]),n+=u[5],a+=u[6];break;case"S":n=u[3],a=u[4],e.bezierCurveToShort(u[1],u[2],n,a);break;case"s":e.bezierCurveToShort(n+u[1],a+u[2],n+u[3],a+u[4]),n+=u[3],a+=u[4];break;case"Q":n=u[3],a=u[4],e.quadraticCurveTo(u[1],u[2],n,a);break;case"q":e.quadraticCurveTo(n+u[1],a+u[2],n+u[3],a+u[4]),n+=u[3],a+=u[4];break;case"T":n=u[1],a=u[2],e.quadraticCurveToShort(n,a);break;case"t":n+=u[1],a+=u[2],e.quadraticCurveToShort(n,a);break;case"A":n=u[6],a=u[7],e.arcToSvg(u[1],u[2],u[3],u[4],u[5],n,a);break;case"a":n+=u[6],a+=u[7],e.arcToSvg(u[1],u[2],u[3],u[4],u[5],n,a);break;case"Z":case"z":e.closePath(),i.length>0&&(s=i.pop(),s?(n=s.startX,a=s.startY):(n=0,a=0)),s=null;break;default:Ee(`Unknown SVG path command: ${c}`)}c!=="Z"&&c!=="z"&&s===null&&(s={startX:n,startY:a},i.push(s))}return e}class Ja{constructor(e=0,t=0,i=0){this.type="circle",this.x=e,this.y=t,this.radius=i}clone(){return new Ja(this.x,this.y,this.radius)}contains(e,t){if(this.radius<=0)return!1;const i=this.radius*this.radius;let s=this.x-e,n=this.y-t;return s*=s,n*=n,s+n<=i}strokeContains(e,t,i){if(this.radius===0)return!1;const s=this.x-e,n=this.y-t,a=this.radius,o=i/2,l=Math.sqrt(s*s+n*n);return l<a+o&&l>a-o}getBounds(e){return e=e||new ke,e.x=this.x-this.radius,e.y=this.y-this.radius,e.width=this.radius*2,e.height=this.radius*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.radius=e.radius,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class eo{constructor(e=0,t=0,i=0,s=0){this.type="ellipse",this.x=e,this.y=t,this.halfWidth=i,this.halfHeight=s}clone(){return new eo(this.x,this.y,this.halfWidth,this.halfHeight)}contains(e,t){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let i=(e-this.x)/this.halfWidth,s=(t-this.y)/this.halfHeight;return i*=i,s*=s,i+s<=1}strokeContains(e,t,i){const{halfWidth:s,halfHeight:n}=this;if(s<=0||n<=0)return!1;const a=i/2,o=s-a,l=n-a,c=s+a,u=n+a,h=e-this.x,d=t-this.y,f=h*h/(o*o)+d*d/(l*l),p=h*h/(c*c)+d*d/(u*u);return f>1&&p<=1}getBounds(e){return e=e||new ke,e.x=this.x-this.halfWidth,e.y=this.y-this.halfHeight,e.width=this.halfWidth*2,e.height=this.halfHeight*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.halfWidth=e.halfWidth,this.halfHeight=e.halfHeight,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function xp(r,e,t,i,s,n){const a=r-t,o=e-i,l=s-t,c=n-i,u=a*l+o*c,h=l*l+c*c;let d=-1;h!==0&&(d=u/h);let f,p;d<0?(f=t,p=i):d>1?(f=s,p=n):(f=t+d*l,p=i+d*c);const _=r-f,g=e-p;return _*_+g*g}class Ds{constructor(...e){this.type="polygon";let t=Array.isArray(e[0])?e[0]:e;if(typeof t[0]!="number"){const i=[];for(let s=0,n=t.length;s<n;s++)i.push(t[s].x,t[s].y);t=i}this.points=t,this.closePath=!0}clone(){const e=this.points.slice(),t=new Ds(e);return t.closePath=this.closePath,t}contains(e,t){let i=!1;const s=this.points.length/2;for(let n=0,a=s-1;n<s;a=n++){const o=this.points[n*2],l=this.points[n*2+1],c=this.points[a*2],u=this.points[a*2+1];l>t!=u>t&&e<(c-o)*((t-l)/(u-l))+o&&(i=!i)}return i}strokeContains(e,t,i){const s=i/2,n=s*s,{points:a}=this,o=a.length-(this.closePath?0:2);for(let l=0;l<o;l+=2){const c=a[l],u=a[l+1],h=a[(l+2)%a.length],d=a[(l+3)%a.length];if(xp(e,t,c,u,h,d)<=n)return!0}return!1}getBounds(e){e=e||new ke;const t=this.points;let i=1/0,s=-1/0,n=1/0,a=-1/0;for(let o=0,l=t.length;o<l;o+=2){const c=t[o],u=t[o+1];i=c<i?c:i,s=c>s?c:s,n=u<n?u:n,a=u>a?u:a}return e.x=i,e.width=s-i,e.y=n,e.height=a-n,e}copyFrom(e){return this.points=e.points.slice(),this.closePath=e.closePath,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((e,t)=>`${e}, ${t}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}const Ar=(r,e,t,i,s,n)=>{const a=r-t,o=e-i,l=Math.sqrt(a*a+o*o);return l>=s-n&&l<=s+n};class to{constructor(e=0,t=0,i=0,s=0,n=20){this.type="roundedRectangle",this.x=e,this.y=t,this.width=i,this.height=s,this.radius=n}getBounds(e){return e=e||new ke,e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}clone(){return new to(this.x,this.y,this.width,this.height,this.radius)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){const i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(t>=this.y+i&&t<=this.y+this.height-i||e>=this.x+i&&e<=this.x+this.width-i)return!0;let s=e-(this.x+i),n=t-(this.y+i);const a=i*i;if(s*s+n*n<=a||(s=e-(this.x+this.width-i),s*s+n*n<=a)||(n=t-(this.y+this.height-i),s*s+n*n<=a)||(s=e-(this.x+i),s*s+n*n<=a))return!0}return!1}strokeContains(e,t,i){const{x:s,y:n,width:a,height:o,radius:l}=this,c=i/2,u=s+l,h=n+l,d=a-l*2,f=o-l*2,p=s+a,_=n+o;return(e>=s-c&&e<=s+c||e>=p-c&&e<=p+c)&&t>=h&&t<=h+f||(t>=n-c&&t<=n+c||t>=_-c&&t<=_+c)&&e>=u&&e<=u+d?!0:e<u&&t<h&&Ar(e,t,u,h,l,c)||e>p-l&&t<h&&Ar(e,t,p-l,h,l,c)||e>p-l&&t>_-l&&Ar(e,t,p-l,_-l,l,c)||e<u&&t>_-l&&Ar(e,t,u,_-l,l,c)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const yp=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function Sp(r){let e="";for(let t=0;t<r;++t)t>0&&(e+=`
else `),t<r-1&&(e+=`if(test == ${t}.0){}`);return e}function Tp(r,e){if(r===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const t=e.createShader(e.FRAGMENT_SHADER);try{for(;;){const i=yp.replace(/%forloop%/gi,Sp(r));if(e.shaderSource(t,i),e.compileShader(t),!e.getShaderParameter(t,e.COMPILE_STATUS))r=r/2|0;else break}}finally{e.deleteShader(t)}return r}let qi=null;function ec(){var e;if(qi)return qi;const r=Gf();return qi=r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS),qi=Tp(qi,r),(e=r.getExtension("WEBGL_lose_context"))==null||e.loseContext(),qi}const tc={};function wp(r,e){let t=2166136261;for(let i=0;i<e;i++)t^=r[i].uid,t=Math.imul(t,16777619),t>>>=0;return tc[t]||vp(r,e,t)}let Nn=0;function vp(r,e,t){const i={};let s=0;Nn||(Nn=ec());for(let a=0;a<Nn;a++){const o=a<e?r[a]:q.EMPTY.source;i[s++]=o.source,i[s++]=o.style}const n=new Df(i);return tc[t]=n,n}class ph{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}function _h(r,e){const t=r.byteLength/8|0,i=new Float64Array(r,0,t);new Float64Array(e,0,t).set(i);const n=r.byteLength-t*8;if(n>0){const a=new Uint8Array(r,t*8,n);new Uint8Array(e,t*8,n).set(a)}}const bp={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var Ap=(r=>(r[r.DISABLED=0]="DISABLED",r[r.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",r[r.MASK_ACTIVE=2]="MASK_ACTIVE",r[r.RENDERING_MASK_REMOVE=3]="RENDERING_MASK_REMOVE",r[r.NONE=4]="NONE",r))(Ap||{});function gh(r,e){return e.alphaMode==="no-premultiply-alpha"&&bp[r]||r}class Pp{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let e=0;e<this.count;e++){const t=this.textures[e];this.textures[e]=null,this.ids[t.uid]=null}this.count=0}}class kp{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new Pp,this.blendMode="normal",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const ic=[];let ba=0;function mh(){return ba>0?ic[--ba]:new kp}function xh(r){ic[ba++]=r}let Ms=0;const sc=class Lr{constructor(e={}){this.uid=Ge("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._vertexSize=6,this._elements=[],Lr.defaultOptions.maxTextures=Lr.defaultOptions.maxTextures??ec(),e={...Lr.defaultOptions,...e};const{vertexSize:t,indexSize:i,maxTextures:s}=e;this.attributeBuffer=new ph(t*this._vertexSize*4),this.indexBuffer=new Uint16Array(i),this.maxTextures=s}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let e=0;e<this.batchIndex;e++)xh(this.batches[e]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(e){this._elements[this.elementSize++]=e,e.indexStart=this.indexSize,e.location=this.attributeSize,e.batcher=this,this.indexSize+=e.indexSize,this.attributeSize+=e.vertexSize*this._vertexSize}checkAndUpdateTexture(e,t){const i=e.batch.textures.ids[t._source.uid];return!i&&i!==0?!1:(e.textureId=i,e.texture=t,!0)}updateElement(e){this.dirty=!0,e.packAttributes(this.attributeBuffer.float32View,this.attributeBuffer.uint32View,e.location,e.textureId)}break(e){const t=this._elements;if(!t[this.elementStart])return;let i=mh(),s=i.textures;s.clear();const n=t[this.elementStart];let a=gh(n.blendMode,n.texture._source);this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const o=this.attributeBuffer.float32View,l=this.attributeBuffer.uint32View,c=this.indexBuffer;let u=this._batchIndexSize,h=this._batchIndexStart,d="startBatch";const f=this.maxTextures;for(let p=this.elementStart;p<this.elementSize;++p){const _=t[p];t[p]=null;const m=_.texture._source,x=gh(_.blendMode,m),S=a!==x;if(m._batchTick===Ms&&!S){_.textureId=m._textureBindLocation,u+=_.indexSize,_.packAttributes(o,l,_.location,_.textureId),_.packIndex(c,_.indexStart,_.location/this._vertexSize),_.batch=i;continue}m._batchTick=Ms,(s.count>=f||S)&&(this._finishBatch(i,h,u-h,s,a,e,d),d="renderBatch",h=u,a=x,i=mh(),s=i.textures,s.clear(),++Ms),_.textureId=m._textureBindLocation=s.count,s.ids[m.uid]=s.count,s.textures[s.count++]=m,_.batch=i,u+=_.indexSize,_.packAttributes(o,l,_.location,_.textureId),_.packIndex(c,_.indexStart,_.location/this._vertexSize)}s.count>0&&(this._finishBatch(i,h,u-h,s,a,e,d),h=u,++Ms),this.elementStart=this.elementSize,this._batchIndexStart=h,this._batchIndexSize=u}_finishBatch(e,t,i,s,n,a,o){e.gpuBindGroup=null,e.bindGroup=null,e.action=o,e.batcher=this,e.textures=s,e.blendMode=n,e.start=t,e.size=i,++Ms,this.batches[this.batchIndex++]=e,a.add(e)}finish(e){this.break(e)}ensureAttributeBuffer(e){e*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(e*4)}ensureIndexBuffer(e){e<=this.indexBuffer.length||this._resizeIndexBuffer(e)}_resizeAttributeBuffer(e){const t=Math.max(e,this.attributeBuffer.size*2),i=new ph(t);_h(this.attributeBuffer.rawBinaryData,i.rawBinaryData),this.attributeBuffer=i}_resizeIndexBuffer(e){const t=this.indexBuffer;let i=Math.max(e,t.length*1.5);i+=i%2;const s=i>65535?new Uint32Array(i):new Uint16Array(i);if(s.BYTES_PER_ELEMENT!==t.BYTES_PER_ELEMENT)for(let n=0;n<t.length;n++)s[n]=t[n];else _h(t.buffer,s.buffer);this.indexBuffer=s}destroy(){for(let e=0;e<this.batches.length;e++)xh(this.batches[e]);this.batches=null;for(let e=0;e<this._elements.length;e++)this._elements[e].batch=null;this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}};sc.defaultOptions={vertexSize:4,indexSize:6,maxTextures:null};let Ep=sc;var Je=(r=>(r[r.MAP_READ=1]="MAP_READ",r[r.MAP_WRITE=2]="MAP_WRITE",r[r.COPY_SRC=4]="COPY_SRC",r[r.COPY_DST=8]="COPY_DST",r[r.INDEX=16]="INDEX",r[r.VERTEX=32]="VERTEX",r[r.UNIFORM=64]="UNIFORM",r[r.STORAGE=128]="STORAGE",r[r.INDIRECT=256]="INDIRECT",r[r.QUERY_RESOLVE=512]="QUERY_RESOLVE",r[r.STATIC=1024]="STATIC",r))(Je||{});class js extends Yt{constructor(e){let{data:t,size:i}=e;const{usage:s,label:n,shrinkToFit:a}=e;super(),this.uid=Ge("buffer"),this._resourceType="buffer",this._resourceId=Ge("resource"),this._touched=0,this._updateID=1,this.shrinkToFit=!0,this.destroyed=!1,t instanceof Array&&(t=new Float32Array(t)),this._data=t,i=i??(t==null?void 0:t.byteLength);const o=!!t;this.descriptor={size:i,usage:s,mappedAtCreation:o,label:n},this.shrinkToFit=a??!0}get data(){return this._data}set data(e){this.setDataWithSize(e,e.length,!0)}get static(){return!!(this.descriptor.usage&Je.STATIC)}set static(e){e?this.descriptor.usage|=Je.STATIC:this.descriptor.usage&=~Je.STATIC}setDataWithSize(e,t,i){if(this._updateID++,this._updateSize=t*e.BYTES_PER_ELEMENT,this._data===e){i&&this.emit("update",this);return}const s=this._data;if(this._data=e,s.length!==e.length){!this.shrinkToFit&&e.byteLength<s.byteLength?i&&this.emit("update",this):(this.descriptor.size=e.byteLength,this._resourceId=Ge("resource"),this.emit("change",this));return}i&&this.emit("update",this)}update(e){this._updateSize=e??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}function rc(r,e){if(!(r instanceof js)){let t=e?Je.INDEX:Je.VERTEX;r instanceof Array&&(e?(r=new Uint32Array(r),t=Je.INDEX|Je.COPY_DST):(r=new Float32Array(r),t=Je.VERTEX|Je.COPY_DST)),r=new js({data:r,label:e?"index-mesh-buffer":"vertex-mesh-buffer",usage:t})}return r}function Cp(r,e,t){const i=r.getAttribute(e);if(!i)return t.minX=0,t.minY=0,t.maxX=0,t.maxY=0,t;const s=i.buffer.data;let n=1/0,a=1/0,o=-1/0,l=-1/0;const c=s.BYTES_PER_ELEMENT,u=(i.offset||0)/c,h=(i.stride||2*4)/c;for(let d=u;d<s.length;d+=h){const f=s[d],p=s[d+1];f>o&&(o=f),p>l&&(l=p),f<n&&(n=f),p<a&&(a=p)}return t.minX=n,t.minY=a,t.maxX=o,t.maxY=l,t}function Mp(r){return(r instanceof js||Array.isArray(r)||r.BYTES_PER_ELEMENT)&&(r={buffer:r}),r.buffer=rc(r.buffer,!1),r}class Ip extends Yt{constructor(e){const{attributes:t,indexBuffer:i,topology:s}=e;super(),this.uid=Ge("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new zt,this._boundsDirty=!0,this.attributes=t,this.buffers=[],this.instanceCount=e.instanceCount||1;for(const n in t){const a=t[n]=Mp(t[n]);this.buffers.indexOf(a.buffer)===-1&&(this.buffers.push(a.buffer),a.buffer.on("update",this.onBufferUpdate,this),a.buffer.on("change",this.onBufferUpdate,this))}i&&(this.indexBuffer=rc(i,!0),this.buffers.push(this.indexBuffer)),this.topology=s||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(e){return this.attributes[e]}getIndex(){return this.indexBuffer}getBuffer(e){return this.getAttribute(e).buffer}getSize(){for(const e in this.attributes){const t=this.attributes[e];return t.buffer.data.length/(t.stride/4||t.size)}return 0}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,Cp(this,"aPosition",this._bounds)):this._bounds}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners(),e&&this.buffers.forEach(t=>t.destroy()),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const Rp=new Float32Array(1),Lp=new Uint32Array(1);class Fp extends Ip{constructor(){const t=new js({data:Rp,label:"attribute-batch-buffer",usage:Je.VERTEX|Je.COPY_DST,shrinkToFit:!1}),i=new js({data:Lp,label:"index-batch-buffer",usage:Je.INDEX|Je.COPY_DST,shrinkToFit:!1}),s=6*4;super({attributes:{aPosition:{buffer:t,format:"float32x2",stride:s,offset:0},aUV:{buffer:t,format:"float32x2",stride:s,offset:2*4},aColor:{buffer:t,format:"unorm8x4",stride:s,offset:4*4},aTextureIdAndRound:{buffer:t,format:"uint16x2",stride:s,offset:5*4}},indexBuffer:i})}}function Op(r,e,t,i,s,n,a,o=null){let l=0;t*=e,s*=n;const c=o.a,u=o.b,h=o.c,d=o.d,f=o.tx,p=o.ty;for(;l<a;){const _=r[t],g=r[t+1];i[s]=c*_+h*g+f,i[s+1]=u*_+d*g+p,s+=n,t+=e,l++}}function Np(r,e,t,i){let s=0;for(e*=t;s<i;)r[e]=0,r[e+1]=0,e+=t,s++}function nc(r,e,t,i,s){const n=e.a,a=e.b,o=e.c,l=e.d,c=e.tx,u=e.ty;t=t||0,i=i||2,s=s||r.length/i-t;let h=t*i;for(let d=0;d<s;d++){const f=r[h],p=r[h+1];r[h]=n*f+o*p+c,r[h+1]=a*f+l*p+u,h+=i}}function Bp(r,e){if(r===16777215||!e)return e;if(e===16777215||!r)return r;const t=r>>16&255,i=r>>8&255,s=r&255,n=e>>16&255,a=e>>8&255,o=e&255,l=t*n/255,c=i*a/255,u=s*o/255;return(l<<16)+(c<<8)+u}class ac{constructor(){this.batcher=null,this.batch=null,this.applyTransform=!0,this.roundPixels=0}get blendMode(){return this.applyTransform?this.renderable.groupBlendMode:"normal"}packIndex(e,t,i){const s=this.geometryData.indices;for(let n=0;n<this.indexSize;n++)e[t++]=s[n+this.indexOffset]+i-this.vertexOffset}packAttributes(e,t,i,s){const n=this.geometryData,a=this.renderable,o=n.vertices,l=n.uvs,c=this.vertexOffset*2,u=(this.vertexOffset+this.vertexSize)*2,h=this.color,d=h>>16|h&65280|(h&255)<<16;if(this.applyTransform){const f=Bp(d,a.groupColor)+(this.alpha*a.groupAlpha*255<<24),p=a.groupTransform,_=s<<16|this.roundPixels&65535,g=p.a,m=p.b,x=p.c,S=p.d,w=p.tx,A=p.ty;for(let k=c;k<u;k+=2){const P=o[k],E=o[k+1];e[i]=g*P+x*E+w,e[i+1]=m*P+S*E+A,e[i+2]=l[k],e[i+3]=l[k+1],t[i+4]=f,t[i+5]=_,i+=6}}else{const f=d+(this.alpha*255<<24);for(let p=c;p<u;p+=2)e[i]=o[p],e[i+1]=o[p+1],e[i+2]=l[p],e[i+3]=l[p+1],t[i+4]=f,t[i+5]=s<<16,i+=6}}get vertSize(){return this.vertexSize}copyTo(e){e.indexOffset=this.indexOffset,e.indexSize=this.indexSize,e.vertexOffset=this.vertexOffset,e.vertexSize=this.vertexSize,e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.geometryData=this.geometryData}reset(){this.applyTransform=!0}}const qs={extension:{type:W.ShapeBuilder,name:"circle"},build(r,e){let t,i,s,n,a,o;if(r.type==="circle"){const w=r;t=w.x,i=w.y,a=o=w.radius,s=n=0}else if(r.type==="ellipse"){const w=r;t=w.x,i=w.y,a=w.halfWidth,o=w.halfHeight,s=n=0}else{const w=r,A=w.width/2,k=w.height/2;t=w.x+A,i=w.y+k,a=o=Math.max(0,Math.min(w.radius,Math.min(A,k))),s=A-a,n=k-o}if(!(a>=0&&o>=0&&s>=0&&n>=0))return e;const l=Math.ceil(2.3*Math.sqrt(a+o)),c=l*8+(s?4:0)+(n?4:0);if(c===0)return e;if(l===0)return e[0]=e[6]=t+s,e[1]=e[3]=i+n,e[2]=e[4]=t-s,e[5]=e[7]=i-n,e;let u=0,h=l*4+(s?2:0)+2,d=h,f=c,p=s+a,_=n,g=t+p,m=t-p,x=i+_;if(e[u++]=g,e[u++]=x,e[--h]=x,e[--h]=m,n){const w=i-_;e[d++]=m,e[d++]=w,e[--f]=w,e[--f]=g}for(let w=1;w<l;w++){const A=Math.PI/2*(w/l),k=s+Math.cos(A)*a,P=n+Math.sin(A)*o,E=t+k,b=t-k,M=i+P,N=i-P;e[u++]=E,e[u++]=M,e[--h]=M,e[--h]=b,e[d++]=b,e[d++]=N,e[--f]=N,e[--f]=E}p=s,_=n+o,g=t+p,m=t-p,x=i+_;const S=i-_;return e[u++]=g,e[u++]=x,e[--f]=S,e[--f]=g,s&&(e[u++]=m,e[u++]=x,e[--f]=S,e[--f]=m),e},triangulate(r,e,t,i,s,n){if(r.length===0)return;let a=0,o=0;for(let u=0;u<r.length;u+=2)a+=r[u],o+=r[u+1];a/=r.length/2,o/=r.length/2;let l=i;e[l*t]=a,e[l*t+1]=o;const c=l++;for(let u=0;u<r.length;u+=2)e[l*t]=r[u],e[l*t+1]=r[u+1],u>0&&(s[n++]=l,s[n++]=c,s[n++]=l-1),l++;s[n++]=c+1,s[n++]=c,s[n++]=l-1}},Gp={...qs,extension:{...qs.extension,name:"ellipse"}},Dp={...qs,extension:{...qs.extension,name:"roundedRectangle"}},Hp=1e-4,yh=1e-4;function Up(r){const e=r.length;if(e<6)return 1;let t=0;for(let i=0,s=r[e-2],n=r[e-1];i<e;i+=2){const a=r[i],o=r[i+1];t+=(a-s)*(o+n),s=a,n=o}return t<0?-1:1}function Sh(r,e,t,i,s,n,a,o){const l=r-t*s,c=e-i*s,u=r+t*n,h=e+i*n;let d,f;a?(d=i,f=-t):(d=-i,f=t);const p=l+d,_=c+f,g=u+d,m=h+f;return o.push(p,_),o.push(g,m),2}function Pi(r,e,t,i,s,n,a,o){const l=t-r,c=i-e;let u=Math.atan2(l,c),h=Math.atan2(s-r,n-e);o&&u<h?u+=Math.PI*2:!o&&u>h&&(h+=Math.PI*2);let d=u;const f=h-u,p=Math.abs(f),_=Math.sqrt(l*l+c*c),g=(15*p*Math.sqrt(_)/Math.PI>>0)+1,m=f/g;if(d+=m,o){a.push(r,e),a.push(t,i);for(let x=1,S=d;x<g;x++,S+=m)a.push(r,e),a.push(r+Math.sin(S)*_,e+Math.cos(S)*_);a.push(r,e),a.push(s,n)}else{a.push(t,i),a.push(r,e);for(let x=1,S=d;x<g;x++,S+=m)a.push(r+Math.sin(S)*_,e+Math.cos(S)*_),a.push(r,e);a.push(s,n),a.push(r,e)}return g*2}function zp(r,e,t,i,s,n,a,o,l){const c=Hp;if(r.length===0)return;const u=e;let h=u.alignment;if(e.alignment!==.5){let D=Up(r);h=(h-.5)*D+.5}const d=new Ue(r[0],r[1]),f=new Ue(r[r.length-2],r[r.length-1]),p=i,_=Math.abs(d.x-f.x)<c&&Math.abs(d.y-f.y)<c;if(p){r=r.slice(),_&&(r.pop(),r.pop(),f.set(r[r.length-2],r[r.length-1]));const D=(d.x+f.x)*.5,at=(f.y+d.y)*.5;r.unshift(D,at),r.push(D,at)}const g=s,m=r.length/2;let x=r.length;const S=g.length/2,w=u.width/2,A=w*w,k=u.miterLimit*u.miterLimit;let P=r[0],E=r[1],b=r[2],M=r[3],N=0,H=0,L=-(E-M),F=P-b,G=0,$=0,K=Math.sqrt(L*L+F*F);L/=K,F/=K,L*=w,F*=w;const Se=h,U=(1-Se)*2,Y=Se*2;p||(u.cap==="round"?x+=Pi(P-L*(U-Y)*.5,E-F*(U-Y)*.5,P-L*U,E-F*U,P+L*Y,E+F*Y,g,!0)+2:u.cap==="square"&&(x+=Sh(P,E,L,F,U,Y,!0,g))),g.push(P-L*U,E-F*U),g.push(P+L*Y,E+F*Y);for(let D=1;D<m-1;++D){P=r[(D-1)*2],E=r[(D-1)*2+1],b=r[D*2],M=r[D*2+1],N=r[(D+1)*2],H=r[(D+1)*2+1],L=-(E-M),F=P-b,K=Math.sqrt(L*L+F*F),L/=K,F/=K,L*=w,F*=w,G=-(M-H),$=b-N,K=Math.sqrt(G*G+$*$),G/=K,$/=K,G*=w,$*=w;const at=b-P,Pe=E-M,Ve=b-N,wi=H-M,Ce=at*Ve+Pe*wi,gt=Pe*Ve-wi*at,le=gt<0;if(Math.abs(gt)<.001*Math.abs(Ce)){g.push(b-L*U,M-F*U),g.push(b+L*Y,M+F*Y),Ce>=0&&(u.join==="round"?x+=Pi(b,M,b-L*U,M-F*U,b-G*U,M-$*U,g,!1)+4:x+=2,g.push(b-G*Y,M-$*Y),g.push(b+G*U,M+$*U));continue}const Ne=(-L+P)*(-F+M)-(-L+b)*(-F+E),vi=(-G+N)*(-$+M)-(-G+b)*(-$+H),It=(at*vi-Ve*Ne)/gt,Rt=(wi*Ne-Pe*vi)/gt,$t=(It-b)*(It-b)+(Rt-M)*(Rt-M),ot=b+(It-b)*U,Me=M+(Rt-M)*U,Xe=b-(It-b)*Y,Lt=M-(Rt-M)*Y,or=Math.min(at*at+Pe*Pe,Ve*Ve+wi*wi),bi=le?U:Y,Ke=or+bi*bi*A;$t<=Ke?u.join==="bevel"||$t/A>k?(le?(g.push(ot,Me),g.push(b+L*Y,M+F*Y),g.push(ot,Me),g.push(b+G*Y,M+$*Y)):(g.push(b-L*U,M-F*U),g.push(Xe,Lt),g.push(b-G*U,M-$*U),g.push(Xe,Lt)),x+=2):u.join==="round"?le?(g.push(ot,Me),g.push(b+L*Y,M+F*Y),x+=Pi(b,M,b+L*Y,M+F*Y,b+G*Y,M+$*Y,g,!0)+4,g.push(ot,Me),g.push(b+G*Y,M+$*Y)):(g.push(b-L*U,M-F*U),g.push(Xe,Lt),x+=Pi(b,M,b-L*U,M-F*U,b-G*U,M-$*U,g,!1)+4,g.push(b-G*U,M-$*U),g.push(Xe,Lt)):(g.push(ot,Me),g.push(Xe,Lt)):(g.push(b-L*U,M-F*U),g.push(b+L*Y,M+F*Y),u.join==="round"?le?x+=Pi(b,M,b+L*Y,M+F*Y,b+G*Y,M+$*Y,g,!0)+2:x+=Pi(b,M,b-L*U,M-F*U,b-G*U,M-$*U,g,!1)+2:u.join==="miter"&&$t/A<=k&&(le?(g.push(Xe,Lt),g.push(Xe,Lt)):(g.push(ot,Me),g.push(ot,Me)),x+=2),g.push(b-G*U,M-$*U),g.push(b+G*Y,M+$*Y),x+=2)}P=r[(m-2)*2],E=r[(m-2)*2+1],b=r[(m-1)*2],M=r[(m-1)*2+1],L=-(E-M),F=P-b,K=Math.sqrt(L*L+F*F),L/=K,F/=K,L*=w,F*=w,g.push(b-L*U,M-F*U),g.push(b+L*Y,M+F*Y),p||(u.cap==="round"?x+=Pi(b-L*(U-Y)*.5,M-F*(U-Y)*.5,b-L*U,M-F*U,b+L*Y,M+F*Y,g,!1)+2:u.cap==="square"&&(x+=Sh(b,M,L,F,U,Y,!1,g)));const Te=yh*yh;for(let D=S;D<x+S-2;++D)P=g[D*2],E=g[D*2+1],b=g[(D+1)*2],M=g[(D+1)*2+1],N=g[(D+2)*2],H=g[(D+2)*2+1],!(Math.abs(P*(M-H)+b*(H-E)+N*(E-M))<Te)&&o.push(D,D+1,D+2)}function oc(r,e,t,i,s,n,a){const o=rp(r,e,2);if(!o)return;for(let c=0;c<o.length;c+=3)n[a++]=o[c]+s,n[a++]=o[c+1]+s,n[a++]=o[c+2]+s;let l=s*i;for(let c=0;c<r.length;c+=2)t[l]=r[c],t[l+1]=r[c+1],l+=i}const Wp=[],Yp={extension:{type:W.ShapeBuilder,name:"polygon"},build(r,e){for(let t=0;t<r.points.length;t++)e[t]=r.points[t];return e},triangulate(r,e,t,i,s,n){oc(r,Wp,e,t,i,s,n)}},Vp={extension:{type:W.ShapeBuilder,name:"rectangle"},build(r,e){const t=r,i=t.x,s=t.y,n=t.width,a=t.height;return n>=0&&a>=0&&(e[0]=i,e[1]=s,e[2]=i+n,e[3]=s,e[4]=i+n,e[5]=s+a,e[6]=i,e[7]=s+a),e},triangulate(r,e,t,i,s,n){let a=0;i*=t,e[i+a]=r[0],e[i+a+1]=r[1],a+=t,e[i+a]=r[2],e[i+a+1]=r[3],a+=t,e[i+a]=r[6],e[i+a+1]=r[7],a+=t,e[i+a]=r[4],e[i+a+1]=r[5],a+=t;const o=i/t;s[n++]=o,s[n++]=o+1,s[n++]=o+2,s[n++]=o+1,s[n++]=o+3,s[n++]=o+2}},Xp={extension:{type:W.ShapeBuilder,name:"triangle"},build(r,e){return e[0]=r.x,e[1]=r.y,e[2]=r.x2,e[3]=r.y2,e[4]=r.x3,e[5]=r.y3,e},triangulate(r,e,t,i,s,n){let a=0;i*=t,e[i+a]=r[0],e[i+a+1]=r[1],a+=t,e[i+a]=r[2],e[i+a+1]=r[3],a+=t,e[i+a]=r[4],e[i+a+1]=r[5];const o=i/t;s[n++]=o,s[n++]=o+1,s[n++]=o+2}},an={};ze.handleByMap(W.ShapeBuilder,an);ze.add(Vp,Yp,Xp,qs,Gp,Dp);const $p=new ke;function jp(r,e){const{geometryData:t,batches:i}=e;i.length=0,t.indices.length=0,t.vertices.length=0,t.uvs.length=0;for(let s=0;s<r.instructions.length;s++){const n=r.instructions[s];if(n.action==="texture")qp(n.data,i,t);else if(n.action==="fill"||n.action==="stroke"){const a=n.action==="stroke",o=n.data.path.shapePath,l=n.data.style,c=n.data.hole;a&&c&&Th(c.shapePath,l,null,!0,i,t),Th(o,l,c,a,i,t)}}}function qp(r,e,t){const{vertices:i,uvs:s,indices:n}=t,a=n.length,o=i.length/2,l=[],c=an.rectangle,u=$p,h=r.image;u.x=r.dx,u.y=r.dy,u.width=r.dw,u.height=r.dh;const d=r.transform;c.build(u,l),d&&nc(l,d),c.triangulate(l,i,2,o,n,a);const f=h.uvs;s.push(f.x0,f.y0,f.x1,f.y1,f.x3,f.y3,f.x2,f.y2);const p=ei.get(ac);p.indexOffset=a,p.indexSize=n.length-a,p.vertexOffset=o,p.vertexSize=i.length/2-o,p.color=r.style,p.alpha=r.alpha,p.texture=h,p.geometryData=t,e.push(p)}function Th(r,e,t,i,s,n){const{vertices:a,uvs:o,indices:l}=n,c=r.shapePrimitives.length-1;r.shapePrimitives.forEach(({shape:u,transform:h},d)=>{const f=l.length,p=a.length/2,_=[],g=an[u.type];if(g.build(u,_),h&&nc(_,h),i){const w=u.closePath??!0;zp(_,e,!1,w,a,2,p,l)}else if(t&&c===d){c!==0&&console.warn("[Pixi Graphics] only the last shape have be cut out");const w=[],A=_.slice();Kp(t.shapePath).forEach(P=>{w.push(A.length/2),A.push(...P)}),oc(A,w,a,2,p,l,f)}else g.triangulate(_,a,2,p,l,f);const m=o.length/2,x=e.texture;if(x!==q.WHITE){const w=e.matrix;w&&(h&&w.append(h.clone().invert()),Op(a,2,p,o,m,2,a.length/2-p,w))}else Np(o,m,2,a.length/2-p);const S=ei.get(ac);S.indexOffset=f,S.indexSize=l.length-f,S.vertexOffset=p,S.vertexSize=a.length/2-p,S.color=e.color,S.alpha=e.alpha,S.texture=x,S.geometryData=n,s.push(S)})}function Kp(r){if(!r)return[];const e=r.shapePrimitives,t=[];for(let i=0;i<e.length;i++){const s=e[i].shape,n=[];an[s.type].build(s,n),t.push(n)}return t}class Zp{constructor(){this.batcher=new Ep,this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class Qp{constructor(){this.geometry=new Fp,this.instructions=new kl}init(){this.instructions.reset()}}const io=class Aa{constructor(){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null)}init(e){Aa.defaultOptions.bezierSmoothness=(e==null?void 0:e.bezierSmoothness)??Aa.defaultOptions.bezierSmoothness}getContextRenderData(e){return this._graphicsDataContextHash[e.uid]||this._initContextRenderData(e)}updateGpuContext(e){let t=this._gpuContextHash[e.uid]||this._initContext(e);if(e.dirty){t?this._cleanGraphicsContextData(e):t=this._initContext(e),jp(e,t);const i=e.batchMode;e.customShader||i==="no-batch"?t.isBatchable=!1:i==="auto"&&(t.isBatchable=t.geometryData.vertices.length<400),e.dirty=!1}return t}getGpuContext(e){return this._gpuContextHash[e.uid]||this._initContext(e)}_initContextRenderData(e){const t=ei.get(Qp),{batches:i,geometryData:s,batcher:n}=this._gpuContextHash[e.uid],a=s.vertices.length,o=s.indices.length;for(let u=0;u<i.length;u++)i[u].applyTransform=!1;n.ensureAttributeBuffer(a),n.ensureIndexBuffer(o),n.begin();for(let u=0;u<i.length;u++){const h=i[u];n.add(h)}n.finish(t.instructions);const l=t.geometry;l.indexBuffer.setDataWithSize(n.indexBuffer,n.indexSize,!0),l.buffers[0].setDataWithSize(n.attributeBuffer.float32View,n.attributeSize,!0);const c=n.batches;for(let u=0;u<c.length;u++){const h=c[u];h.bindGroup=wp(h.textures.textures,h.textures.count)}return this._graphicsDataContextHash[e.uid]=t,t}_initContext(e){const t=new Zp;return t.context=e,this._gpuContextHash[e.uid]=t,e.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]}onGraphicsContextDestroy(e){this._cleanGraphicsContextData(e),e.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]=null}_cleanGraphicsContextData(e){const t=this._gpuContextHash[e.uid];t.isBatchable||this._graphicsDataContextHash[e.uid]&&(ei.return(this.getContextRenderData(e)),this._graphicsDataContextHash[e.uid]=null),t.batches&&t.batches.forEach(i=>{ei.return(i)})}destroy(){for(const e in this._gpuContextHash)this._gpuContextHash[e]&&this.onGraphicsContextDestroy(this._gpuContextHash[e].context)}};io.extension={type:[W.WebGLSystem,W.WebGPUSystem,W.CanvasSystem],name:"graphicsContext"};io.defaultOptions={bezierSmoothness:.5};let hc=io;const Jp=8,Pr=11920929e-14,e_=1;function lc(r,e,t,i,s,n,a,o,l,c){const h=Math.min(.99,Math.max(0,c??hc.defaultOptions.bezierSmoothness));let d=(e_-h)/1;return d*=d,t_(e,t,i,s,n,a,o,l,r,d),r}function t_(r,e,t,i,s,n,a,o,l,c){Pa(r,e,t,i,s,n,a,o,l,c,0),l.push(a,o)}function Pa(r,e,t,i,s,n,a,o,l,c,u){if(u>Jp)return;const h=(r+t)/2,d=(e+i)/2,f=(t+s)/2,p=(i+n)/2,_=(s+a)/2,g=(n+o)/2,m=(h+f)/2,x=(d+p)/2,S=(f+_)/2,w=(p+g)/2,A=(m+S)/2,k=(x+w)/2;if(u>0){let P=a-r,E=o-e;const b=Math.abs((t-a)*E-(i-o)*P),M=Math.abs((s-a)*E-(n-o)*P);if(b>Pr&&M>Pr){if((b+M)*(b+M)<=c*(P*P+E*E)){l.push(A,k);return}}else if(b>Pr){if(b*b<=c*(P*P+E*E)){l.push(A,k);return}}else if(M>Pr){if(M*M<=c*(P*P+E*E)){l.push(A,k);return}}else if(P=A-(r+a)/2,E=k-(e+o)/2,P*P+E*E<=c){l.push(A,k);return}}Pa(r,e,h,d,m,x,A,k,l,c,u+1),Pa(A,k,S,w,_,g,a,o,l,c,u+1)}const i_=8,s_=11920929e-14,r_=1;function n_(r,e,t,i,s,n,a,o){const c=Math.min(.99,Math.max(0,o??hc.defaultOptions.bezierSmoothness));let u=(r_-c)/1;return u*=u,a_(e,t,i,s,n,a,r,u),r}function a_(r,e,t,i,s,n,a,o){ka(a,r,e,t,i,s,n,o,0),a.push(s,n)}function ka(r,e,t,i,s,n,a,o,l){if(l>i_)return;const c=(e+i)/2,u=(t+s)/2,h=(i+n)/2,d=(s+a)/2,f=(c+h)/2,p=(u+d)/2;let _=n-e,g=a-t;const m=Math.abs((i-n)*g-(s-a)*_);if(m>s_){if(m*m<=o*(_*_+g*g)){r.push(f,p);return}}else if(_=f-(e+n)/2,g=p-(t+a)/2,_*_+g*g<=o){r.push(f,p);return}ka(r,e,t,c,u,f,p,o,l+1),ka(r,f,p,h,d,n,a,o,l+1)}function cc(r,e,t,i,s,n,a,o){let l=Math.abs(s-n);(!a&&s>n||a&&n>s)&&(l=2*Math.PI-l),o=o||Math.max(6,Math.floor(6*Math.pow(i,1/3)*(l/Math.PI))),o=Math.max(o,3);let c=l/o,u=s;c*=a?-1:1;for(let h=0;h<o+1;h++){const d=Math.cos(u),f=Math.sin(u),p=e+d*i,_=t+f*i;r.push(p,_),u+=c}}function o_(r,e,t,i,s,n){const a=r[r.length-2],l=r[r.length-1]-t,c=a-e,u=s-t,h=i-e,d=Math.abs(l*h-c*u);if(d<1e-8||n===0){(r[r.length-2]!==e||r[r.length-1]!==t)&&r.push(e,t);return}const f=l*l+c*c,p=u*u+h*h,_=l*u+c*h,g=n*Math.sqrt(f)/d,m=n*Math.sqrt(p)/d,x=g*_/f,S=m*_/p,w=g*h+m*c,A=g*u+m*l,k=c*(m+x),P=l*(m+x),E=h*(g+S),b=u*(g+S),M=Math.atan2(P-A,k-w),N=Math.atan2(b-A,E-w);cc(r,w+e,A+t,n,M,N,c*u>h*l)}const Hs=Math.PI*2,Bn={centerX:0,centerY:0,ang1:0,ang2:0},Gn=({x:r,y:e},t,i,s,n,a,o,l)=>{r*=t,e*=i;const c=s*r-n*e,u=n*r+s*e;return l.x=c+a,l.y=u+o,l};function h_(r,e){const t=e===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(e/4),i=e===1.5707963267948966?.551915024494:t,s=Math.cos(r),n=Math.sin(r),a=Math.cos(r+e),o=Math.sin(r+e);return[{x:s-n*i,y:n+s*i},{x:a+o*i,y:o-a*i},{x:a,y:o}]}const wh=(r,e,t,i)=>{const s=r*i-e*t<0?-1:1;let n=r*t+e*i;return n>1&&(n=1),n<-1&&(n=-1),s*Math.acos(n)},l_=(r,e,t,i,s,n,a,o,l,c,u,h,d)=>{const f=Math.pow(s,2),p=Math.pow(n,2),_=Math.pow(u,2),g=Math.pow(h,2);let m=f*p-f*g-p*_;m<0&&(m=0),m/=f*g+p*_,m=Math.sqrt(m)*(a===o?-1:1);const x=m*s/n*h,S=m*-n/s*u,w=c*x-l*S+(r+t)/2,A=l*x+c*S+(e+i)/2,k=(u-x)/s,P=(h-S)/n,E=(-u-x)/s,b=(-h-S)/n,M=wh(1,0,k,P);let N=wh(k,P,E,b);o===0&&N>0&&(N-=Hs),o===1&&N<0&&(N+=Hs),d.centerX=w,d.centerY=A,d.ang1=M,d.ang2=N};function c_(r,e,t,i,s,n,a,o=0,l=0,c=0){if(n===0||a===0)return;const u=Math.sin(o*Hs/360),h=Math.cos(o*Hs/360),d=h*(e-i)/2+u*(t-s)/2,f=-u*(e-i)/2+h*(t-s)/2;if(d===0&&f===0)return;n=Math.abs(n),a=Math.abs(a);const p=Math.pow(d,2)/Math.pow(n,2)+Math.pow(f,2)/Math.pow(a,2);p>1&&(n*=Math.sqrt(p),a*=Math.sqrt(p)),l_(e,t,i,s,n,a,l,c,u,h,d,f,Bn);let{ang1:_,ang2:g}=Bn;const{centerX:m,centerY:x}=Bn;let S=Math.abs(g)/(Hs/4);Math.abs(1-S)<1e-7&&(S=1);const w=Math.max(Math.ceil(S),1);g/=w;let A=r[r.length-2],k=r[r.length-1];const P={x:0,y:0};for(let E=0;E<w;E++){const b=h_(_,g),{x:M,y:N}=Gn(b[0],n,a,h,u,m,x,P),{x:H,y:L}=Gn(b[1],n,a,h,u,m,x,P),{x:F,y:G}=Gn(b[2],n,a,h,u,m,x,P);lc(r,A,k,M,N,H,L,F,G),A=F,k=G,_+=g}}function u_(r,e,t){const i=(a,o)=>{const l=o.x-a.x,c=o.y-a.y,u=Math.sqrt(l*l+c*c),h=l/u,d=c/u;return{len:u,nx:h,ny:d}},s=(a,o)=>{a===0?r.moveTo(o.x,o.y):r.lineTo(o.x,o.y)};let n=e[e.length-1];for(let a=0;a<e.length;a++){const o=e[a%e.length],l=o.radius??t;if(l<=0){s(a,o),n=o;continue}const c=e[(a+1)%e.length],u=i(o,n),h=i(o,c);if(u.len<1e-4||h.len<1e-4){s(a,o),n=o;continue}let d=Math.asin(u.nx*h.ny-u.ny*h.nx),f=1,p=!1;u.nx*h.nx-u.ny*-h.ny<0?d<0?d=Math.PI+d:(d=Math.PI-d,f=-1,p=!0):d>0&&(f=-1,p=!0);const _=d/2;let g,m=Math.abs(Math.cos(_)*l/Math.sin(_));m>Math.min(u.len/2,h.len/2)?(m=Math.min(u.len/2,h.len/2),g=Math.abs(m*Math.sin(_)/Math.cos(_))):g=l;const x=o.x+h.nx*m+-h.ny*g*f,S=o.y+h.ny*m+h.nx*g*f,w=Math.atan2(u.ny,u.nx)+Math.PI/2*f,A=Math.atan2(h.ny,h.nx)-Math.PI/2*f;a===0&&r.moveTo(x+Math.cos(w)*g,S+Math.sin(w)*g),r.arc(x,S,g,w,A,p),n=o}}function d_(r,e,t,i){const s=(o,l)=>Math.sqrt((o.x-l.x)**2+(o.y-l.y)**2),n=(o,l,c)=>({x:o.x+(l.x-o.x)*c,y:o.y+(l.y-o.y)*c}),a=e.length;for(let o=0;o<a;o++){const l=e[(o+1)%a],c=l.radius??t;if(c<=0){o===0?r.moveTo(l.x,l.y):r.lineTo(l.x,l.y);continue}const u=e[o],h=e[(o+2)%a],d=s(u,l);let f;if(d<1e-4)f=l;else{const g=Math.min(d/2,c);f=n(l,u,g/d)}const p=s(h,l);let _;if(p<1e-4)_=l;else{const g=Math.min(p/2,c);_=n(l,h,g/p)}o===0?r.moveTo(f.x,f.y):r.lineTo(f.x,f.y),r.quadraticCurveTo(l.x,l.y,_.x,_.y,i)}}const f_=new ke;class p_{constructor(e){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new zt,this._graphicsPath2D=e}moveTo(e,t){return this.startPoly(e,t),this}lineTo(e,t){this._ensurePoly();const i=this._currentPoly.points,s=i[i.length-2],n=i[i.length-1];return(s!==e||n!==t)&&i.push(e,t),this}arc(e,t,i,s,n,a){this._ensurePoly(!1);const o=this._currentPoly.points;return cc(o,e,t,i,s,n,a),this}arcTo(e,t,i,s,n){this._ensurePoly();const a=this._currentPoly.points;return o_(a,e,t,i,s,n),this}arcToSvg(e,t,i,s,n,a,o){const l=this._currentPoly.points;return c_(l,this._currentPoly.lastX,this._currentPoly.lastY,a,o,e,t,i,s,n),this}bezierCurveTo(e,t,i,s,n,a,o){this._ensurePoly();const l=this._currentPoly;return lc(this._currentPoly.points,l.lastX,l.lastY,e,t,i,s,n,a,o),this}quadraticCurveTo(e,t,i,s,n){this._ensurePoly();const a=this._currentPoly;return n_(this._currentPoly.points,a.lastX,a.lastY,e,t,i,s,n),this}closePath(){return this.endPoly(!0),this}addPath(e,t){this.endPoly(),t&&!t.isIdentity()&&(e=e.clone(!0),e.transform(t));for(let i=0;i<e.instructions.length;i++){const s=e.instructions[i];this[s.action](...s.data)}return this}finish(e=!1){this.endPoly(e)}rect(e,t,i,s,n){return this.drawShape(new ke(e,t,i,s),n),this}circle(e,t,i,s){return this.drawShape(new Ja(e,t,i),s),this}poly(e,t,i){const s=new Ds(e);return s.closePath=t,this.drawShape(s,i),this}regularPoly(e,t,i,s,n=0,a){s=Math.max(s|0,3);const o=-1*Math.PI/2+n,l=Math.PI*2/s,c=[];for(let u=0;u<s;u++){const h=u*l+o;c.push(e+i*Math.cos(h),t+i*Math.sin(h))}return this.poly(c,!0,a),this}roundPoly(e,t,i,s,n,a=0,o){if(s=Math.max(s|0,3),n<=0)return this.regularPoly(e,t,i,s,a);const l=i*Math.sin(Math.PI/s)-.001;n=Math.min(n,l);const c=-1*Math.PI/2+a,u=Math.PI*2/s,h=(s-2)*Math.PI/s/2;for(let d=0;d<s;d++){const f=d*u+c,p=e+i*Math.cos(f),_=t+i*Math.sin(f),g=f+Math.PI+h,m=f-Math.PI-h,x=p+n*Math.cos(g),S=_+n*Math.sin(g),w=p+n*Math.cos(m),A=_+n*Math.sin(m);d===0?this.moveTo(x,S):this.lineTo(x,S),this.quadraticCurveTo(p,_,w,A,o)}return this.closePath()}roundShape(e,t,i=!1,s){return e.length<3?this:(i?d_(this,e,t,s):u_(this,e,t),this.closePath())}filletRect(e,t,i,s,n){if(n===0)return this.rect(e,t,i,s);const a=Math.min(i,s)/2,o=Math.min(a,Math.max(-a,n)),l=e+i,c=t+s,u=o<0?-o:0,h=Math.abs(o);return this.moveTo(e,t+h).arcTo(e+u,t+u,e+h,t,h).lineTo(l-h,t).arcTo(l-u,t+u,l,t+h,h).lineTo(l,c-h).arcTo(l-u,c-u,e+i-h,c,h).lineTo(e+h,c).arcTo(e+u,c-u,e,c-h,h).closePath()}chamferRect(e,t,i,s,n,a){if(n<=0)return this.rect(e,t,i,s);const o=Math.min(n,Math.min(i,s)/2),l=e+i,c=t+s,u=[e+o,t,l-o,t,l,t+o,l,c-o,l-o,c,e+o,c,e,c-o,e,t+o];for(let h=u.length-1;h>=2;h-=2)u[h]===u[h-2]&&u[h-1]===u[h-3]&&u.splice(h-1,2);return this.poly(u,!0,a)}ellipse(e,t,i,s,n){return this.drawShape(new eo(e,t,i,s),n),this}roundRect(e,t,i,s,n,a){return this.drawShape(new to(e,t,i,s,n),a),this}drawShape(e,t){return this.endPoly(),this.shapePrimitives.push({shape:e,transform:t}),this}startPoly(e,t){let i=this._currentPoly;return i&&this.endPoly(),i=new Ds,i.points.push(e,t),this._currentPoly=i,this}endPoly(e=!1){const t=this._currentPoly;return t&&t.points.length>2&&(t.closePath=e,this.shapePrimitives.push({shape:t})),this._currentPoly=null,this}_ensurePoly(e=!0){if(!this._currentPoly&&(this._currentPoly=new Ds,e)){const t=this.shapePrimitives[this.shapePrimitives.length-1];if(t){let i=t.shape.x,s=t.shape.y;if(t.transform&&!t.transform.isIdentity()){const n=t.transform,a=i;i=n.a*i+n.c*s+n.tx,s=n.b*a+n.d*s+n.ty}this._currentPoly.points.push(i,s)}else this._currentPoly.points.push(0,0)}}buildPath(){const e=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let t=0;t<e.instructions.length;t++){const i=e.instructions[t];this[i.action](...i.data)}this.finish()}get bounds(){const e=this._bounds;e.clear();const t=this.shapePrimitives;for(let i=0;i<t.length;i++){const s=t[i],n=s.shape.getBounds(f_);s.transform?e.addRect(n,s.transform):e.addRect(n)}return e}}class fs{constructor(e){this.instructions=[],this.uid=Ge("graphicsPath"),this._dirty=!0,typeof e=="string"?mp(e,this):this.instructions=(e==null?void 0:e.slice())??[]}get shapePath(){return this._shapePath||(this._shapePath=new p_(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(e,t){return e=e.clone(),this.instructions.push({action:"addPath",data:[e,t]}),this._dirty=!0,this}arc(...e){return this.instructions.push({action:"arc",data:e}),this._dirty=!0,this}arcTo(...e){return this.instructions.push({action:"arcTo",data:e}),this._dirty=!0,this}arcToSvg(...e){return this.instructions.push({action:"arcToSvg",data:e}),this._dirty=!0,this}bezierCurveTo(...e){return this.instructions.push({action:"bezierCurveTo",data:e}),this._dirty=!0,this}bezierCurveToShort(e,t,i,s,n){const a=this.instructions[this.instructions.length-1],o=this.getLastPoint(Ue.shared);let l=0,c=0;if(!a||a.action!=="bezierCurveTo")l=o.x,c=o.y;else{l=a.data[2],c=a.data[3];const u=o.x,h=o.y;l=u+(u-l),c=h+(h-c)}return this.instructions.push({action:"bezierCurveTo",data:[l,c,e,t,i,s,n]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...e){return this.instructions.push({action:"ellipse",data:e}),this._dirty=!0,this}lineTo(...e){return this.instructions.push({action:"lineTo",data:e}),this._dirty=!0,this}moveTo(...e){return this.instructions.push({action:"moveTo",data:e}),this}quadraticCurveTo(...e){return this.instructions.push({action:"quadraticCurveTo",data:e}),this._dirty=!0,this}quadraticCurveToShort(e,t,i){const s=this.instructions[this.instructions.length-1],n=this.getLastPoint(Ue.shared);let a=0,o=0;if(!s||s.action!=="quadraticCurveTo")a=n.x,o=n.y;else{a=s.data[0],o=s.data[1];const l=n.x,c=n.y;a=l+(l-a),o=c+(c-o)}return this.instructions.push({action:"quadraticCurveTo",data:[a,o,e,t,i]}),this._dirty=!0,this}rect(e,t,i,s,n){return this.instructions.push({action:"rect",data:[e,t,i,s,n]}),this._dirty=!0,this}circle(e,t,i,s){return this.instructions.push({action:"circle",data:[e,t,i,s]}),this._dirty=!0,this}roundRect(...e){return this.instructions.push({action:"roundRect",data:e}),this._dirty=!0,this}poly(...e){return this.instructions.push({action:"poly",data:e}),this._dirty=!0,this}regularPoly(...e){return this.instructions.push({action:"regularPoly",data:e}),this._dirty=!0,this}roundPoly(...e){return this.instructions.push({action:"roundPoly",data:e}),this._dirty=!0,this}roundShape(...e){return this.instructions.push({action:"roundShape",data:e}),this._dirty=!0,this}filletRect(...e){return this.instructions.push({action:"filletRect",data:e}),this._dirty=!0,this}chamferRect(...e){return this.instructions.push({action:"chamferRect",data:e}),this._dirty=!0,this}star(e,t,i,s,n,a,o){n=n||s/2;const l=-1*Math.PI/2+a,c=i*2,u=Math.PI*2/c,h=[];for(let d=0;d<c;d++){const f=d%2?n:s,p=d*u+l;h.push(e+f*Math.cos(p),t+f*Math.sin(p))}return this.poly(h,!0,o),this}clone(e=!1){const t=new fs;if(!e)t.instructions=this.instructions.slice();else for(let i=0;i<this.instructions.length;i++){const s=this.instructions[i];t.instructions.push({action:s.action,data:s.data.slice()})}return t}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(e){if(e.isIdentity())return this;const t=e.a,i=e.b,s=e.c,n=e.d,a=e.tx,o=e.ty;let l=0,c=0,u=0,h=0,d=0,f=0,p=0,_=0;for(let g=0;g<this.instructions.length;g++){const m=this.instructions[g],x=m.data;switch(m.action){case"moveTo":case"lineTo":l=x[0],c=x[1],x[0]=t*l+s*c+a,x[1]=i*l+n*c+o;break;case"bezierCurveTo":u=x[0],h=x[1],d=x[2],f=x[3],l=x[4],c=x[5],x[0]=t*u+s*h+a,x[1]=i*u+n*h+o,x[2]=t*d+s*f+a,x[3]=i*d+n*f+o,x[4]=t*l+s*c+a,x[5]=i*l+n*c+o;break;case"quadraticCurveTo":u=x[0],h=x[1],l=x[2],c=x[3],x[0]=t*u+s*h+a,x[1]=i*u+n*h+o,x[2]=t*l+s*c+a,x[3]=i*l+n*c+o;break;case"arcToSvg":l=x[5],c=x[6],p=x[0],_=x[1],x[0]=t*p+s*_,x[1]=i*p+n*_,x[5]=t*l+s*c+a,x[6]=i*l+n*c+o;break;case"circle":x[4]=Is(x[3],e);break;case"rect":x[4]=Is(x[4],e);break;case"ellipse":x[8]=Is(x[8],e);break;case"roundRect":x[5]=Is(x[5],e);break;case"addPath":x[0].transform(e);break;case"poly":x[2]=Is(x[2],e);break;default:Ee("unknown transform action",m.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(e){let t=this.instructions.length-1,i=this.instructions[t];if(!i)return e.x=0,e.y=0,e;for(;i.action==="closePath";){if(t--,t<0)return e.x=0,e.y=0,e;i=this.instructions[t]}switch(i.action){case"moveTo":case"lineTo":e.x=i.data[0],e.y=i.data[1];break;case"quadraticCurveTo":e.x=i.data[2],e.y=i.data[3];break;case"bezierCurveTo":e.x=i.data[4],e.y=i.data[5];break;case"arc":case"arcToSvg":e.x=i.data[5],e.y=i.data[6];break;case"addPath":i.data[0].getLastPoint(e);break}return e}}function Is(r,e){return r?r.prepend(e):e.clone()}function __(r,e){if(typeof r=="string"){const i=document.createElement("div");i.innerHTML=r.trim(),r=i.querySelector("svg")}const t={context:e,path:new fs};return uc(r,t,null,null),e}function uc(r,e,t,i){const s=r.children,{fillStyle:n,strokeStyle:a}=g_(r);n&&t?t={...t,...n}:n&&(t=n),a&&i?i={...i,...a}:a&&(i=a),e.context.fillStyle=t,e.context.strokeStyle=i;let o,l,c,u,h,d,f,p,_,g,m,x,S,w,A,k,P;switch(r.nodeName.toLowerCase()){case"path":w=r.getAttribute("d"),A=new fs(w),e.context.path(A),t&&e.context.fill(),i&&e.context.stroke();break;case"circle":f=Re(r,"cx",0),p=Re(r,"cy",0),_=Re(r,"r",0),e.context.ellipse(f,p,_,_),t&&e.context.fill(),i&&e.context.stroke();break;case"rect":o=Re(r,"x",0),l=Re(r,"y",0),k=Re(r,"width",0),P=Re(r,"height",0),g=Re(r,"rx",0),m=Re(r,"ry",0),g||m?e.context.roundRect(o,l,k,P,g||m):e.context.rect(o,l,k,P),t&&e.context.fill(),i&&e.context.stroke();break;case"ellipse":f=Re(r,"cx",0),p=Re(r,"cy",0),g=Re(r,"rx",0),m=Re(r,"ry",0),e.context.beginPath(),e.context.ellipse(f,p,g,m),t&&e.context.fill(),i&&e.context.stroke();break;case"line":c=Re(r,"x1",0),u=Re(r,"y1",0),h=Re(r,"x2",0),d=Re(r,"y2",0),e.context.beginPath(),e.context.moveTo(c,u),e.context.lineTo(h,d),i&&e.context.stroke();break;case"polygon":S=r.getAttribute("points"),x=S.match(/\d+/g).map(E=>parseInt(E,10)),e.context.poly(x,!0),t&&e.context.fill(),i&&e.context.stroke();break;case"polyline":S=r.getAttribute("points"),x=S.match(/\d+/g).map(E=>parseInt(E,10)),e.context.poly(x,!1),i&&e.context.stroke();break;case"g":case"svg":break;default:{console.info(`[SVG parser] <${r.nodeName}> elements unsupported`);break}}for(let E=0;E<s.length;E++)uc(s[E],e,t,i)}function Re(r,e,t){const i=r.getAttribute(e);return i?Number(i):t}function g_(r){const e=r.getAttribute("style"),t={},i={};let s=!1,n=!1;if(e){const a=e.split(";");for(let o=0;o<a.length;o++){const l=a[o],[c,u]=l.split(":");switch(c){case"stroke":u!=="none"&&(t.color=Ae.shared.setValue(u).toNumber(),n=!0);break;case"stroke-width":t.width=Number(u);break;case"fill":u!=="none"&&(s=!0,i.color=Ae.shared.setValue(u).toNumber());break;case"fill-opacity":i.alpha=Number(u);break;case"stroke-opacity":t.alpha=Number(u);break;case"opacity":i.alpha=Number(u),t.alpha=Number(u);break}}}else{const a=r.getAttribute("stroke");a&&a!=="none"&&(n=!0,t.color=Ae.shared.setValue(a).toNumber(),t.width=Re(r,"stroke-width",1));const o=r.getAttribute("fill");o&&o!=="none"&&(s=!0,i.color=Ae.shared.setValue(o).toNumber())}return{strokeStyle:n?t:null,fillStyle:s?i:null}}function m_(r){return Ae.isColorLike(r)}function vh(r){return r instanceof nn}function bh(r){return r instanceof $s}function x_(r,e,t){const i=Ae.shared.setValue(e??0);return r.color=i.toNumber(),r.alpha=i.alpha===1?t.alpha:i.alpha,r.texture=q.WHITE,{...t,...r}}function Ah(r,e,t){return r.fill=e,r.color=16777215,r.texture=e.texture,r.matrix=e.transform,{...t,...r}}function Ph(r,e,t){return e.buildLinearGradient(),r.fill=e,r.color=16777215,r.texture=e.texture,r.matrix=e.transform,{...t,...r}}function y_(r,e){var s;const t={...e,...r};if(t.texture){if(t.texture!==q.WHITE){const a=((s=t.matrix)==null?void 0:s.invert())||new re;a.translate(t.texture.frame.x,t.texture.frame.y),a.scale(1/t.texture.source.width,1/t.texture.source.height),t.matrix=a}const n=t.texture.source.style;n.addressMode==="clamp-to-edge"&&(n.addressMode="repeat",n.update())}const i=Ae.shared.setValue(t.color);return t.alpha*=i.alpha,t.color=i.toNumber(),t.matrix=t.matrix?t.matrix.clone():null,t}function Fi(r,e){if(r==null)return null;const t={},i=r;return m_(r)?x_(t,r,e):vh(r)?Ah(t,r,e):bh(r)?Ph(t,r,e):i.fill&&vh(i.fill)?Ah(i,i.fill,e):i.fill&&bh(i.fill)?Ph(i,i.fill,e):y_(i,e)}function zr(r,e){const{width:t,alignment:i,miterLimit:s,cap:n,join:a,...o}=e,l=Fi(r,o);return l?{width:t,alignment:i,miterLimit:s,cap:n,join:a,...l}:null}const S_=new Ue,kh=new re,so=class Bt extends Yt{constructor(){super(...arguments),this.uid=Ge("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new fs,this._transform=new re,this._fillStyle={...Bt.defaultFillStyle},this._strokeStyle={...Bt.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new zt,this._boundsDirty=!0}clone(){const e=new Bt;return e.batchMode=this.batchMode,e.instructions=this.instructions.slice(),e._activePath=this._activePath.clone(),e._transform=this._transform.clone(),e._fillStyle={...this._fillStyle},e._strokeStyle={...this._strokeStyle},e._stateStack=this._stateStack.slice(),e._bounds=this._bounds.clone(),e._boundsDirty=!0,e}get fillStyle(){return this._fillStyle}set fillStyle(e){this._fillStyle=Fi(e,Bt.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(e){this._strokeStyle=zr(e,Bt.defaultStrokeStyle)}setFillStyle(e){return this._fillStyle=Fi(e,Bt.defaultFillStyle),this}setStrokeStyle(e){return this._strokeStyle=Fi(e,Bt.defaultStrokeStyle),this}texture(e,t,i,s,n,a){return this.instructions.push({action:"texture",data:{image:e,dx:i||0,dy:s||0,dw:n||e.frame.width,dh:a||e.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:t?Ae.shared.setValue(t).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new fs,this}fill(e,t){let i;const s=this.instructions[this.instructions.length-1];return this._tick===0&&s&&s.action==="stroke"?i=s.data.path:i=this._activePath.clone(),i?(e!=null&&(t!==void 0&&typeof e=="number"&&(oe(ae,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),e={color:e,alpha:t}),this._fillStyle=Fi(e,Bt.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:i}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:e,y:t}=this._activePath.getLastPoint(Ue.shared);this._activePath.clear(),this._activePath.moveTo(e,t)}stroke(e){let t;const i=this.instructions[this.instructions.length-1];return this._tick===0&&i&&i.action==="fill"?t=i.data.path:t=this._activePath.clone(),t?(e!=null&&(this._strokeStyle=zr(e,Bt.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:t}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let e=0;e<2;e++){const t=this.instructions[this.instructions.length-1-e],i=this._activePath.clone();if(t&&(t.action==="stroke"||t.action==="fill"))if(t.data.hole)t.data.hole.addPath(i);else{t.data.hole=i;break}}return this._initNextPathLocation(),this}arc(e,t,i,s,n,a){this._tick++;const o=this._transform;return this._activePath.arc(o.a*e+o.c*t+o.tx,o.b*e+o.d*t+o.ty,i,s,n,a),this}arcTo(e,t,i,s,n){this._tick++;const a=this._transform;return this._activePath.arcTo(a.a*e+a.c*t+a.tx,a.b*e+a.d*t+a.ty,a.a*i+a.c*s+a.tx,a.b*i+a.d*s+a.ty,n),this}arcToSvg(e,t,i,s,n,a,o){this._tick++;const l=this._transform;return this._activePath.arcToSvg(e,t,i,s,n,l.a*a+l.c*o+l.tx,l.b*a+l.d*o+l.ty),this}bezierCurveTo(e,t,i,s,n,a,o){this._tick++;const l=this._transform;return this._activePath.bezierCurveTo(l.a*e+l.c*t+l.tx,l.b*e+l.d*t+l.ty,l.a*i+l.c*s+l.tx,l.b*i+l.d*s+l.ty,l.a*n+l.c*a+l.tx,l.b*n+l.d*a+l.ty,o),this}closePath(){var e;return this._tick++,(e=this._activePath)==null||e.closePath(),this}ellipse(e,t,i,s){return this._tick++,this._activePath.ellipse(e,t,i,s,this._transform.clone()),this}circle(e,t,i){return this._tick++,this._activePath.circle(e,t,i,this._transform.clone()),this}path(e){return this._tick++,this._activePath.addPath(e,this._transform.clone()),this}lineTo(e,t){this._tick++;const i=this._transform;return this._activePath.lineTo(i.a*e+i.c*t+i.tx,i.b*e+i.d*t+i.ty),this}moveTo(e,t){this._tick++;const i=this._transform,s=this._activePath.instructions,n=i.a*e+i.c*t+i.tx,a=i.b*e+i.d*t+i.ty;return s.length===1&&s[0].action==="moveTo"?(s[0].data[0]=n,s[0].data[1]=a,this):(this._activePath.moveTo(n,a),this)}quadraticCurveTo(e,t,i,s,n){this._tick++;const a=this._transform;return this._activePath.quadraticCurveTo(a.a*e+a.c*t+a.tx,a.b*e+a.d*t+a.ty,a.a*i+a.c*s+a.tx,a.b*i+a.d*s+a.ty,n),this}rect(e,t,i,s){return this._tick++,this._activePath.rect(e,t,i,s,this._transform.clone()),this}roundRect(e,t,i,s,n){return this._tick++,this._activePath.roundRect(e,t,i,s,n,this._transform.clone()),this}poly(e,t){return this._tick++,this._activePath.poly(e,t,this._transform.clone()),this}regularPoly(e,t,i,s,n=0,a){return this._tick++,this._activePath.regularPoly(e,t,i,s,n,a),this}roundPoly(e,t,i,s,n,a){return this._tick++,this._activePath.roundPoly(e,t,i,s,n,a),this}roundShape(e,t,i,s){return this._tick++,this._activePath.roundShape(e,t,i,s),this}filletRect(e,t,i,s,n){return this._tick++,this._activePath.filletRect(e,t,i,s,n),this}chamferRect(e,t,i,s,n,a){return this._tick++,this._activePath.chamferRect(e,t,i,s,n,a),this}star(e,t,i,s,n=0,a=0){return this._tick++,this._activePath.star(e,t,i,s,n,a,this._transform.clone()),this}svg(e){return this._tick++,__(e,this),this}restore(){const e=this._stateStack.pop();return e&&(this._transform=e.transform,this._fillStyle=e.fillStyle,this._strokeStyle=e.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(e){return this._transform.rotate(e),this}scale(e,t=e){return this._transform.scale(e,t),this}setTransform(e,t,i,s,n,a){return e instanceof re?(this._transform.set(e.a,e.b,e.c,e.d,e.tx,e.ty),this):(this._transform.set(e,t,i,s,n,a),this)}transform(e,t,i,s,n,a){return e instanceof re?(this._transform.append(e),this):(kh.set(e,t,i,s,n,a),this._transform.append(kh),this)}translate(e,t=e){return this._transform.translate(e,t),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const e=this._bounds;e.clear();for(let t=0;t<this.instructions.length;t++){const i=this.instructions[t],s=i.action;if(s==="fill"){const n=i.data;e.addBounds(n.path.bounds)}else if(s==="texture"){const n=i.data;e.addFrame(n.dx,n.dy,n.dx+n.dw,n.dy+n.dh,n.transform)}if(s==="stroke"){const n=i.data,a=n.style.width/2,o=n.path.bounds;e.addFrame(o.minX-a,o.minY-a,o.maxX+a,o.maxY+a)}}return e}containsPoint(e){var s;if(!this.bounds.containsPoint(e.x,e.y))return!1;const t=this.instructions;let i=!1;for(let n=0;n<t.length;n++){const a=t[n],o=a.data,l=o.path;if(!a.action||!l)continue;const c=o.style,u=l.shapePath.shapePrimitives;for(let h=0;h<u.length;h++){const d=u[h].shape;if(!c||!d)continue;const f=u[h].transform,p=f?f.applyInverse(e,S_):e;a.action==="fill"?i=d.contains(p.x,p.y):i=d.strokeContains(p.x,p.y,c.width);const _=o.hole;if(_){const g=(s=_.shapePath)==null?void 0:s.shapePrimitives;if(g)for(let m=0;m<g.length;m++)g[m].shape.contains(p.x,p.y)&&(i=!1)}if(i)return!0}}return i}destroy(e=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof e=="boolean"?e:e==null?void 0:e.texture){const i=typeof e=="boolean"?e:e==null?void 0:e.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(i),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(i)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};so.defaultFillStyle={color:16777215,alpha:1,texture:q.WHITE,matrix:null,fill:null};so.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:q.WHITE,matrix:null,fill:null};let yt=so;const Eh=["align","breakWords","cssOverrides","fontVariant","fontWeight","leading","letterSpacing","lineHeight","padding","textBaseline","trim","whiteSpace","wordWrap","wordWrapWidth","fontFamily","fontStyle","fontSize"];function T_(r){const e=[];let t=0;for(let i=0;i<Eh.length;i++){const s=`_${Eh[i]}`;e[t++]=r[s]}return t=dc(r._fill,e,t),t=w_(r._stroke,e,t),t=v_(r.dropShadow,e,t),e.join("-")}function dc(r,e,t){var i;return r&&(e[t++]=r.color,e[t++]=r.alpha,e[t++]=(i=r.fill)==null?void 0:i.styleKey),t}function w_(r,e,t){return r&&(t=dc(r,e,t),e[t++]=r.width,e[t++]=r.alignment,e[t++]=r.cap,e[t++]=r.join,e[t++]=r.miterLimit),t}function v_(r,e,t){return r&&(e[t++]=r.alpha,e[t++]=r.angle,e[t++]=r.blur,e[t++]=r.distance,e[t++]=Ae.shared.setValue(r.color).toNumber()),t}const ro=class Ji extends Yt{constructor(e={}){super(),b_(e);const t={...Ji.defaultTextStyle,...e};for(const i in t){const s=i;this[s]=t[i]}this.update()}get align(){return this._align}set align(e){this._align=e,this.update()}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords=e,this.update()}get dropShadow(){return this._dropShadow}set dropShadow(e){e!==null&&typeof e=="object"?this._dropShadow=this._createProxy({...Ji.defaultDropShadow,...e}):this._dropShadow=e?this._createProxy({...Ji.defaultDropShadow}):null,this.update()}get fontFamily(){return this._fontFamily}set fontFamily(e){this._fontFamily=e,this.update()}get fontSize(){return this._fontSize}set fontSize(e){typeof e=="string"?this._fontSize=parseInt(e,10):this._fontSize=e,this.update()}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle=e,this.update()}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant=e,this.update()}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight=e,this.update()}get leading(){return this._leading}set leading(e){this._leading=e,this.update()}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing=e,this.update()}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight=e,this.update()}get padding(){return this._padding}set padding(e){this._padding=e,this.update()}get trim(){return this._trim}set trim(e){this._trim=e,this.update()}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline=e,this.update()}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace=e,this.update()}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap=e,this.update()}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth=e,this.update()}get fill(){return this._originalFill}set fill(e){e!==this._originalFill&&(this._originalFill=e,this._isFillStyle(e)&&(this._originalFill=this._createProxy({...yt.defaultFillStyle,...e},()=>{this._fill=Fi({...this._originalFill},yt.defaultFillStyle)})),this._fill=Fi(e===0?"black":e,yt.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(e){e!==this._originalStroke&&(this._originalStroke=e,this._isFillStyle(e)&&(this._originalStroke=this._createProxy({...yt.defaultStrokeStyle,...e},()=>{this._stroke=zr({...this._originalStroke},yt.defaultStrokeStyle)})),this._stroke=zr(e,yt.defaultStrokeStyle),this.update())}_generateKey(){return this._styleKey=T_(this),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}reset(){const e=Ji.defaultTextStyle;for(const t in e)this[t]=e[t]}get styleKey(){return this._styleKey||this._generateKey()}clone(){return new Ji({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth})}destroy(e=!1){var i,s,n,a;if(this.removeAllListeners(),typeof e=="boolean"?e:e==null?void 0:e.texture){const o=typeof e=="boolean"?e:e==null?void 0:e.textureSource;(i=this._fill)!=null&&i.texture&&this._fill.texture.destroy(o),(s=this._originalFill)!=null&&s.texture&&this._originalFill.texture.destroy(o),(n=this._stroke)!=null&&n.texture&&this._stroke.texture.destroy(o),(a=this._originalStroke)!=null&&a.texture&&this._originalStroke.texture.destroy(o)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(e,t){return new Proxy(e,{set:(i,s,n)=>(i[s]=n,t==null||t(s,n),this.update(),!0)})}_isFillStyle(e){return(e??null)!==null&&!(Ae.isColorLike(e)||e instanceof $s||e instanceof nn)}};ro.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};ro.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let ii=ro;function b_(r){const e=r;if(typeof e.dropShadow=="boolean"&&e.dropShadow){const t=ii.defaultDropShadow;r.dropShadow={alpha:e.dropShadowAlpha??t.alpha,angle:e.dropShadowAngle??t.angle,blur:e.dropShadowBlur??t.blur,color:e.dropShadowColor??t.color,distance:e.dropShadowDistance??t.distance}}if(e.strokeThickness!==void 0){oe(ae,"strokeThickness is now a part of stroke");const t=e.stroke;let i={};if(Ae.isColorLike(t))i.color=t;else if(t instanceof $s||t instanceof nn)i.fill=t;else if(Object.hasOwnProperty.call(t,"color")||Object.hasOwnProperty.call(t,"fill"))i=t;else throw new Error("Invalid stroke value.");r.stroke={...i,width:e.strokeThickness}}if(Array.isArray(e.fillGradientStops)){oe(ae,"gradient fill is now a fill pattern: `new FillGradient(...)`");let t;r.fontSize==null?r.fontSize=ii.defaultTextStyle.fontSize:typeof r.fontSize=="string"?t=parseInt(r.fontSize,10):t=r.fontSize;const i=new $s(0,0,0,t*1.7),s=e.fillGradientStops.map(n=>Ae.shared.setValue(n).toNumber());s.forEach((n,a)=>{const o=a/(s.length-1);i.addColorStop(o,n)}),r.fill={fill:i}}}class A_{constructor(e){this._canvasPool=Object.create(null),this.canvasOptions=e||{},this.enableFullScreen=!1}_createCanvasAndContext(e,t){const i=ue.get().createCanvas();i.width=e,i.height=t;const s=i.getContext("2d");return{canvas:i,context:s}}getOptimalCanvasAndContext(e,t,i=1){e=Math.ceil(e*i-1e-6),t=Math.ceil(t*i-1e-6),e=qo(e),t=qo(t);const s=(e<<17)+(t<<1);this._canvasPool[s]||(this._canvasPool[s]=[]);let n=this._canvasPool[s].pop();return n||(n=this._createCanvasAndContext(e,t)),n}returnCanvasAndContext(e){const t=e.canvas,{width:i,height:s}=t,n=(i<<17)+(s<<1);this._canvasPool[n].push(e)}clear(){this._canvasPool={}}}const Ch=new A_,P_=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function Ea(r){const e=typeof r.fontSize=="number"?`${r.fontSize}px`:r.fontSize;let t=r.fontFamily;Array.isArray(r.fontFamily)||(t=r.fontFamily.split(","));for(let i=t.length-1;i>=0;i--){let s=t[i].trim();!/([\"\'])[^\'\"]+\1/.test(s)&&!P_.includes(s)&&(s=`"${s}"`),t[i]=s}return`${r.fontStyle} ${r.fontVariant} ${r.fontWeight} ${e} ${t.join(",")}`}const Dn={willReadFrequently:!0},Mt=class z{static get experimentalLetterSpacingSupported(){let e=z._experimentalLetterSpacingSupported;if(e!==void 0){const t=ue.get().getCanvasRenderingContext2D().prototype;e=z._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return e}constructor(e,t,i,s,n,a,o,l,c){this.text=e,this.style=t,this.width=i,this.height=s,this.lines=n,this.lineWidths=a,this.lineHeight=o,this.maxLineWidth=l,this.fontProperties=c}static measureText(e=" ",t,i=z._canvas,s=t.wordWrap){var x;const n=`${e}:${t.styleKey}`;if(z._measurementCache[n])return z._measurementCache[n];const a=Ea(t),o=z.measureFont(a);o.fontSize===0&&(o.fontSize=t.fontSize,o.ascent=t.fontSize);const l=z.__context;l.font=a;const u=(s?z._wordWrap(e,t,i):e).split(/(?:\r\n|\r|\n)/),h=new Array(u.length);let d=0;for(let S=0;S<u.length;S++){const w=z._measureText(u[S],t.letterSpacing,l);h[S]=w,d=Math.max(d,w)}const f=((x=t._stroke)==null?void 0:x.width)||0;let p=d+f;t.dropShadow&&(p+=t.dropShadow.distance);const _=t.lineHeight||o.fontSize;let g=Math.max(_,o.fontSize+f)+(u.length-1)*(_+t.leading);return t.dropShadow&&(g+=t.dropShadow.distance),new z(e,t,p,g,u,h,_+t.leading,d,o)}static _measureText(e,t,i){let s=!1;z.experimentalLetterSpacingSupported&&(z.experimentalLetterSpacing?(i.letterSpacing=`${t}px`,i.textLetterSpacing=`${t}px`,s=!0):(i.letterSpacing="0px",i.textLetterSpacing="0px"));let n=i.measureText(e).width;return n>0&&(s?n-=t:n+=(z.graphemeSegmenter(e).length-1)*t),n}static _wordWrap(e,t,i=z._canvas){const s=i.getContext("2d",Dn);let n=0,a="",o="";const l=Object.create(null),{letterSpacing:c,whiteSpace:u}=t,h=z._collapseSpaces(u),d=z._collapseNewlines(u);let f=!h;const p=t.wordWrapWidth+c,_=z._tokenize(e);for(let g=0;g<_.length;g++){let m=_[g];if(z._isNewline(m)){if(!d){o+=z._addLine(a),f=!h,a="",n=0;continue}m=" "}if(h){const S=z.isBreakingSpace(m),w=z.isBreakingSpace(a[a.length-1]);if(S&&w)continue}const x=z._getFromCache(m,c,l,s);if(x>p)if(a!==""&&(o+=z._addLine(a),a="",n=0),z.canBreakWords(m,t.breakWords)){const S=z.wordWrapSplit(m);for(let w=0;w<S.length;w++){let A=S[w],k=A,P=1;for(;S[w+P];){const b=S[w+P];if(!z.canBreakChars(k,b,m,w,t.breakWords))A+=b;else break;k=b,P++}w+=P-1;const E=z._getFromCache(A,c,l,s);E+n>p&&(o+=z._addLine(a),f=!1,a="",n=0),a+=A,n+=E}}else{a.length>0&&(o+=z._addLine(a),a="",n=0);const S=g===_.length-1;o+=z._addLine(m,!S),f=!1,a="",n=0}else x+n>p&&(f=!1,o+=z._addLine(a),a="",n=0),(a.length>0||!z.isBreakingSpace(m)||f)&&(a+=m,n+=x)}return o+=z._addLine(a,!1),o}static _addLine(e,t=!0){return e=z._trimRight(e),e=t?`${e}
`:e,e}static _getFromCache(e,t,i,s){let n=i[e];return typeof n!="number"&&(n=z._measureText(e,t,s)+t,i[e]=n),n}static _collapseSpaces(e){return e==="normal"||e==="pre-line"}static _collapseNewlines(e){return e==="normal"}static _trimRight(e){if(typeof e!="string")return"";for(let t=e.length-1;t>=0;t--){const i=e[t];if(!z.isBreakingSpace(i))break;e=e.slice(0,-1)}return e}static _isNewline(e){return typeof e!="string"?!1:z._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,t){return typeof e!="string"?!1:z._breakingSpaces.includes(e.charCodeAt(0))}static _tokenize(e){const t=[];let i="";if(typeof e!="string")return t;for(let s=0;s<e.length;s++){const n=e[s],a=e[s+1];if(z.isBreakingSpace(n,a)||z._isNewline(n)){i!==""&&(t.push(i),i=""),t.push(n);continue}i+=n}return i!==""&&t.push(i),t}static canBreakWords(e,t){return t}static canBreakChars(e,t,i,s,n){return!0}static wordWrapSplit(e){return z.graphemeSegmenter(e)}static measureFont(e){if(z._fonts[e])return z._fonts[e];const t=z._context;t.font=e;const i=t.measureText(z.METRICS_STRING+z.BASELINE_SYMBOL),s={ascent:i.actualBoundingBoxAscent,descent:i.actualBoundingBoxDescent,fontSize:i.actualBoundingBoxAscent+i.actualBoundingBoxDescent};return z._fonts[e]=s,s}static clearMetrics(e=""){e?delete z._fonts[e]:z._fonts={}}static get _canvas(){if(!z.__canvas){let e;try{const t=new OffscreenCanvas(0,0),i=t.getContext("2d",Dn);if(i!=null&&i.measureText)return z.__canvas=t,t;e=ue.get().createCanvas()}catch{e=ue.get().createCanvas()}e.width=e.height=10,z.__canvas=e}return z.__canvas}static get _context(){return z.__context||(z.__context=z._canvas.getContext("2d",Dn)),z.__context}};Mt.METRICS_STRING="|q";Mt.BASELINE_SYMBOL="M";Mt.BASELINE_MULTIPLIER=1.4;Mt.HEIGHT_MULTIPLIER=2;Mt.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const r=new Intl.Segmenter;return e=>[...r.segment(e)].map(t=>t.segment)}return r=>[...r]})();Mt.experimentalLetterSpacing=!1;Mt._fonts={};Mt._newlines=[10,13];Mt._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];Mt._measurementCache={};let Ca=Mt;function Mh(r,e){if(r.texture===q.WHITE&&!r.fill)return Ae.shared.setValue(r.color).setAlpha(r.alpha??1).toHexa();if(r.fill){if(r.fill instanceof nn){const t=r.fill,i=e.createPattern(t.texture.source.resource,"repeat"),s=t.transform.copyTo(re.shared);return s.scale(t.texture.frame.width,t.texture.frame.height),i.setTransform(s),i}else if(r.fill instanceof $s){const t=r.fill;if(t.type==="linear"){const i=e.createLinearGradient(t.x0,t.y0,t.x1,t.y1);return t.gradientStops.forEach(s=>{i.addColorStop(s.offset,Ae.shared.setValue(s.color).toHex())}),i}}}else{const t=e.createPattern(r.texture.source.resource,"repeat"),i=r.matrix.copyTo(re.shared);return i.scale(r.texture.frame.width,r.texture.frame.height),t.setTransform(i),t}return Ee("FillStyle not recognised",r),"red"}function fc(r){if(r==="")return[];typeof r=="string"&&(r=[r]);const e=[];for(let t=0,i=r.length;t<i;t++){const s=r[t];if(Array.isArray(s)){if(s.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${s.length}.`);if(s[0].length===0||s[1].length===0)throw new Error("[BitmapFont]: Invalid character delimiter.");const n=s[0].charCodeAt(0),a=s[1].charCodeAt(0);if(a<n)throw new Error("[BitmapFont]: Invalid character range.");for(let o=n,l=a;o<=l;o++)e.push(String.fromCharCode(o))}else e.push(...Array.from(s))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}const pc=class _c extends Ql{constructor(e){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentPageIndex=-1,this._skipKerning=!1;const t={..._c.defaultOptions,...e};this._textureSize=t.textureSize,this._mipmap=t.mipmap;const i=t.style.clone();t.overrideFill&&(i._fill.color=16777215,i._fill.alpha=1,i._fill.texture=q.WHITE,i._fill.fill=null),this.applyFillAsTint=t.overrideFill;const s=i.fontSize;i.fontSize=this.baseMeasurementFontSize;const n=Ea(i);t.overrideSize?i._stroke&&(i._stroke.width*=this.baseRenderedFontSize/s):i.fontSize=this.baseRenderedFontSize=s,this._style=i,this._skipKerning=t.skipKerning??!1,this.resolution=t.resolution??1,this._padding=t.padding??4,this.fontMetrics=Ca.measureFont(n),this.lineHeight=i.lineHeight||this.fontMetrics.fontSize||i.fontSize}ensureCharacters(e){var _,g;const t=fc(e).filter(m=>!this._currentChars.includes(m)).filter((m,x,S)=>S.indexOf(m)===x);if(!t.length)return;this._currentChars=[...this._currentChars,...t];let i;this._currentPageIndex===-1?i=this._nextPage():i=this.pages[this._currentPageIndex];let{canvas:s,context:n}=i.canvasAndContext,a=i.texture.source;const o=this._style;let l=this._currentX,c=this._currentY;const u=this.baseRenderedFontSize/this.baseMeasurementFontSize,h=this._padding*u,d=o.fontStyle==="italic"?2:1;let f=0,p=!1;for(let m=0;m<t.length;m++){const x=t[m],S=Ca.measureText(x,o,s,!1);S.lineHeight=S.height;const w=d*S.width*u,A=S.height*u,k=w+h*2,P=A+h*2;if(p=!1,x!==`
`&&x!=="\r"&&x!=="	"&&x!==" "&&(p=!0,f=Math.ceil(Math.max(P,f))),l+k>this._textureSize&&(c+=f,f=P,l=0,c+f>this._textureSize)){a.update();const b=this._nextPage();s=b.canvasAndContext.canvas,n=b.canvasAndContext.context,a=b.texture.source,c=0}const E=w/u-(((_=o.dropShadow)==null?void 0:_.distance)??0)-(((g=o._stroke)==null?void 0:g.width)??0);if(this.chars[x]={id:x.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:E,kerning:{}},p){this._drawGlyph(n,S,l+h,c+h,u,o);const b=a.width*u,M=a.height*u,N=new ke(l/b*a.width,c/M*a.height,k/b*a.width,P/M*a.height);this.chars[x].texture=new q({source:a,frame:N}),l+=Math.ceil(k)}}a.update(),this._currentX=l,this._currentY=c,this._skipKerning&&this._applyKerning(t,n)}get pageTextures(){return oe(ae,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(e,t){const i=this._measureCache;for(let s=0;s<e.length;s++){const n=e[s];for(let a=0;a<this._currentChars.length;a++){const o=this._currentChars[a];let l=i[n];l||(l=i[n]=t.measureText(n).width);let c=i[o];c||(c=i[o]=t.measureText(o).width);let u=t.measureText(n+o).width,h=u-(l+c);h&&(this.chars[n].kerning[o]=h),u=t.measureText(n+o).width,h=u-(l+c),h&&(this.chars[o].kerning[n]=h)}}}_nextPage(){this._currentPageIndex++;const e=this.resolution,t=Ch.getOptimalCanvasAndContext(this._textureSize,this._textureSize,e);this._setupContext(t.context,this._style,e);const i=e*(this.baseRenderedFontSize/this.baseMeasurementFontSize),s=new q({source:new Ss({resource:t.canvas,resolution:i,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})}),n={canvasAndContext:t,texture:s};return this.pages[this._currentPageIndex]=n,n}_setupContext(e,t,i){t.fontSize=this.baseRenderedFontSize,e.scale(i,i),e.font=Ea(t),t.fontSize=this.baseMeasurementFontSize,e.textBaseline=t.textBaseline;const s=t._stroke,n=(s==null?void 0:s.width)??0;if(s&&(e.lineWidth=n,e.lineJoin=s.join,e.miterLimit=s.miterLimit,e.strokeStyle=Mh(s,e)),t._fill&&(e.fillStyle=Mh(t._fill,e)),t.dropShadow){const a=t.dropShadow,o=Ae.shared.setValue(a.color).toArray(),l=a.blur*i,c=a.distance*i;e.shadowColor=`rgba(${o[0]*255},${o[1]*255},${o[2]*255},${a.alpha})`,e.shadowBlur=l,e.shadowOffsetX=Math.cos(a.angle)*c,e.shadowOffsetY=Math.sin(a.angle)*c}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0}_drawGlyph(e,t,i,s,n,a){const o=t.text,l=t.fontProperties,c=a._stroke,u=((c==null?void 0:c.width)??0)*n,h=i+u/2,d=s-u/2,f=l.descent*n,p=t.lineHeight*n;a.stroke&&u&&e.strokeText(o,h,d+p-f),a._fill&&e.fillText(o,h,d+p-f)}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{canvasAndContext:t,texture:i}=this.pages[e];t.canvas.width=t.canvas.width,Ch.returnCanvasAndContext(t),i.destroy(!0)}this.pages=null}};pc.defaultOptions={textureSize:512,style:new ii,mipmap:!0};let Ih=pc;function k_(r,e,t){const i={width:0,height:0,offsetY:0,scale:e.fontSize/t.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};i.offsetY=t.baseLineOffset;let s=i.lines[0],n=null,a=!0;const o={spaceWord:!1,width:0,start:0,index:0,positions:[],chars:[]},l=f=>{const p=s.width;for(let _=0;_<o.index;_++){const g=f.positions[_];s.chars.push(f.chars[_]),s.charPositions.push(g+p)}s.width+=f.width,a=!1,o.width=0,o.index=0,o.chars.length=0},c=()=>{let f=s.chars.length-1,p=s.chars[f];for(;p===" ";)s.width-=t.chars[p].xAdvance,p=s.chars[--f];i.width=Math.max(i.width,s.width),s={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},a=!0,i.lines.push(s),i.height+=t.lineHeight},u=t.baseMeasurementFontSize/e.fontSize,h=e.letterSpacing*u,d=e.wordWrapWidth*u;for(let f=0;f<r.length+1;f++){let p;const _=f===r.length;_||(p=r[f]);const g=t.chars[p]||t.chars[" "];if(/(?:\s)/.test(p)||p==="\r"||p===`
`||_){if(!a&&e.wordWrap&&s.width+o.width-h>d?(c(),l(o),_||s.charPositions.push(0)):(o.start=s.width,l(o),_||s.charPositions.push(0)),p==="\r"||p===`
`)s.width!==0&&c();else if(!_){const w=g.xAdvance+(g.kerning[n]||0)+h;s.width+=w,s.spaceWidth=w,s.spacesIndex.push(s.charPositions.length),s.chars.push(p)}}else{const S=g.kerning[n]||0,w=g.xAdvance+S+h;o.positions[o.index++]=o.width+S,o.chars.push(p),o.width+=w}n=p}return c(),e.align==="center"?E_(i):e.align==="right"?C_(i):e.align==="justify"&&M_(i),i}function E_(r){for(let e=0;e<r.lines.length;e++){const t=r.lines[e],i=r.width/2-t.width/2;for(let s=0;s<t.charPositions.length;s++)t.charPositions[s]+=i}}function C_(r){for(let e=0;e<r.lines.length;e++){const t=r.lines[e],i=r.width-t.width;for(let s=0;s<t.charPositions.length;s++)t.charPositions[s]+=i}}function M_(r){const e=r.width;for(let t=0;t<r.lines.length;t++){const i=r.lines[t];let s=0,n=i.spacesIndex[s++],a=0;const o=i.spacesIndex.length,c=(e-i.width)/o;for(let u=0;u<i.charPositions.length;u++)u===n&&(n=i.spacesIndex[s++],a+=c),i.charPositions[u]+=a}}let kr=0;class I_{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1}}getFont(e,t){var a;let i=`${t.fontFamily}-bitmap`,s=!0;if(t._fill.fill&&!t._stroke)i+=t._fill.fill.styleKey,s=!1;else if(t._stroke||t.dropShadow){let o=t.styleKey;o=o.substring(0,o.lastIndexOf("-")),i=`${o}-bitmap`,s=!1}if(!pe.has(i)){const o=new Ih({style:t,overrideFill:s,overrideSize:!0,...this.defaultOptions});kr++,kr>50&&Ee("BitmapText",`You have dynamically created ${kr} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),o.once("destroy",()=>{kr--,pe.remove(i)}),pe.set(i,o)}const n=pe.get(i);return(a=n.ensureCharacters)==null||a.call(n,e),n}getLayout(e,t){const i=this.getFont(e,t);return k_([...e],t,i)}measureText(e,t){return this.getLayout(e,t)}install(...e){var c,u,h,d;let t=e[0];typeof t=="string"&&(t={name:t,style:e[1],chars:(c=e[2])==null?void 0:c.chars,resolution:(u=e[2])==null?void 0:u.resolution,padding:(h=e[2])==null?void 0:h.padding,skipKerning:(d=e[2])==null?void 0:d.skipKerning},oe(ae,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const i=t==null?void 0:t.name;if(!i)throw new Error("[BitmapFontManager] Property `name` is required.");t={...this.defaultOptions,...t};const s=t.style,n=s instanceof ii?s:new ii(s),a=n._fill.fill!==null&&n._fill.fill!==void 0,o=new Ih({style:n,overrideFill:a,skipKerning:t.skipKerning,padding:t.padding,resolution:t.resolution,overrideSize:!1}),l=fc(t.chars);return o.ensureCharacters(l.join("")),pe.set(`${i}-bitmap`,o),o.once("destroy",()=>pe.remove(`${i}-bitmap`)),o}uninstall(e){const t=`${e}-bitmap`,i=pe.get(t);i&&(pe.remove(t),i.destroy())}}const Rh=new I_;class gc extends Ql{constructor(e,t){super();const{textures:i,data:s}=e;Object.keys(s.pages).forEach(n=>{const a=s.pages[parseInt(n,10)],o=i[a.id];this.pages.push({texture:o})}),Object.keys(s.chars).forEach(n=>{const a=s.chars[n],{frame:o,source:l}=i[a.page],c=new ke(a.x+o.x,a.y+o.y,a.width,a.height),u=new q({source:l,frame:c});this.chars[n]={id:n.codePointAt(0),xOffset:a.xOffset,yOffset:a.yOffset,xAdvance:a.xAdvance,kerning:a.kerning??{},texture:u}}),this.baseRenderedFontSize=s.fontSize,this.baseMeasurementFontSize=s.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:s.fontSize},this.baseLineOffset=s.baseLineOffset,this.lineHeight=s.lineHeight,this.fontFamily=s.fontFamily,this.distanceField=s.distanceField??{type:"none",range:0},this.url=t}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{texture:t}=this.pages[e];t.destroy(!0)}this.pages=null}static install(e){Rh.install(e)}static uninstall(e){Rh.uninstall(e)}}const Hn={test(r){return typeof r=="string"&&r.startsWith("info face=")},parse(r){const e=r.match(/^[a-z]+\s+.+$/gm),t={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const h in e){const d=e[h].match(/^[a-z]+/gm)[0],f=e[h].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),p={};for(const _ in f){const g=f[_].split("="),m=g[0],x=g[1].replace(/"/gm,""),S=parseFloat(x),w=isNaN(S)?x:S;p[m]=w}t[d].push(p)}const i={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[s]=t.info,[n]=t.common,[a]=t.distanceField??[];a&&(i.distanceField={range:parseInt(a.distanceRange,10),type:a.fieldType}),i.fontSize=parseInt(s.size,10),i.fontFamily=s.face,i.lineHeight=parseInt(n.lineHeight,10);const o=t.page;for(let h=0;h<o.length;h++)i.pages.push({id:parseInt(o[h].id,10)||0,file:o[h].file});const l={};i.baseLineOffset=i.lineHeight-parseInt(n.base,10);const c=t.char;for(let h=0;h<c.length;h++){const d=c[h],f=parseInt(d.id,10);let p=d.letter??d.char??String.fromCharCode(f);p==="space"&&(p=" "),l[f]=p,i.chars[p]={id:f,page:parseInt(d.page,10)||0,x:parseInt(d.x,10),y:parseInt(d.y,10),width:parseInt(d.width,10),height:parseInt(d.height,10),xOffset:parseInt(d.xoffset,10),yOffset:parseInt(d.yoffset,10),xAdvance:parseInt(d.xadvance,10),kerning:{}}}const u=t.kerning||[];for(let h=0;h<u.length;h++){const d=parseInt(u[h].first,10),f=parseInt(u[h].second,10),p=parseInt(u[h].amount,10);i.chars[l[f]].kerning[l[d]]=p}return i}},Lh={test(r){const e=r;return typeof e!="string"&&"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(r){const e={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},t=r.getElementsByTagName("info")[0],i=r.getElementsByTagName("common")[0],s=r.getElementsByTagName("distanceField")[0];s&&(e.distanceField={type:s.getAttribute("fieldType"),range:parseInt(s.getAttribute("distanceRange"),10)});const n=r.getElementsByTagName("page"),a=r.getElementsByTagName("char"),o=r.getElementsByTagName("kerning");e.fontSize=parseInt(t.getAttribute("size"),10),e.fontFamily=t.getAttribute("face"),e.lineHeight=parseInt(i.getAttribute("lineHeight"),10);for(let c=0;c<n.length;c++)e.pages.push({id:parseInt(n[c].getAttribute("id"),10)||0,file:n[c].getAttribute("file")});const l={};e.baseLineOffset=e.lineHeight-parseInt(i.getAttribute("base"),10);for(let c=0;c<a.length;c++){const u=a[c],h=parseInt(u.getAttribute("id"),10);let d=u.getAttribute("letter")??u.getAttribute("char")??String.fromCharCode(h);d==="space"&&(d=" "),l[h]=d,e.chars[d]={id:h,page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xOffset:parseInt(u.getAttribute("xoffset"),10),yOffset:parseInt(u.getAttribute("yoffset"),10),xAdvance:parseInt(u.getAttribute("xadvance"),10),kerning:{}}}for(let c=0;c<o.length;c++){const u=parseInt(o[c].getAttribute("first"),10),h=parseInt(o[c].getAttribute("second"),10),d=parseInt(o[c].getAttribute("amount"),10);e.chars[l[h]].kerning[l[u]]=d}return e}},Fh={test(r){return typeof r=="string"&&r.includes("<font>")?Lh.test(ue.get().parseXML(r)):!1},parse(r){return Lh.parse(ue.get().parseXML(r))}},R_=[".xml",".fnt"],L_={extension:{type:W.CacheParser,name:"cacheBitmapFont"},test:r=>r instanceof gc,getCacheableAssets(r,e){const t={};return r.forEach(i=>{t[i]=e,t[`${i}-bitmap`]=e}),t[`${e.fontFamily}-bitmap`]=e,t}},F_={extension:{type:W.LoadParser,priority:yi.Normal},name:"loadBitmapFont",test(r){return R_.includes(et.extname(r).toLowerCase())},async testParse(r){return Hn.test(r)||Fh.test(r)},async parse(r,e,t){const i=Hn.test(r)?Hn.parse(r):Fh.parse(r),{src:s}=e,{pages:n}=i,a=[],o=i.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let h=0;h<n.length;++h){const d=n[h].file;let f=et.join(et.dirname(s),d);f=ga(f,s),a.push({src:f,data:o})}const l=await t.load(a),c=a.map(h=>l[h.src]);return new gc({data:i,textures:c},s)},async load(r,e){return await(await ue.get().fetch(r)).text()},async unload(r,e,t){await Promise.all(r.pages.map(i=>t.unload(i.texture.source._sourceOrigin))),r.destroy()}};class O_{constructor(e,t=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=t}add(e){e.forEach(t=>{this._assetList.push(t)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],t=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<t;i++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}const N_={extension:{type:W.CacheParser,name:"cacheTextureArray"},test:r=>Array.isArray(r)&&r.every(e=>e instanceof q),getCacheableAssets:(r,e)=>{const t={};return r.forEach(i=>{e.forEach((s,n)=>{t[i+(n===0?"":n+1)]=s})}),t}};async function mc(r){if("Image"in globalThis)return new Promise(e=>{const t=new Image;t.onload=()=>{e(!0)},t.onerror=()=>{e(!1)},t.src=r});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(r)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const B_={extension:{type:W.DetectionParser,priority:1},test:async()=>mc("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async r=>[...r,"avif"],remove:async r=>r.filter(e=>e!=="avif")},Oh=["png","jpg","jpeg"],G_={extension:{type:W.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async r=>[...r,...Oh],remove:async r=>r.filter(e=>!Oh.includes(e))},D_="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function no(r){return D_?!1:document.createElement("video").canPlayType(r)!==""}const H_={extension:{type:W.DetectionParser,priority:0},test:async()=>no("video/mp4"),add:async r=>[...r,"mp4","m4v"],remove:async r=>r.filter(e=>e!=="mp4"&&e!=="m4v")},U_={extension:{type:W.DetectionParser,priority:0},test:async()=>no("video/ogg"),add:async r=>[...r,"ogv"],remove:async r=>r.filter(e=>e!=="ogv")},z_={extension:{type:W.DetectionParser,priority:0},test:async()=>no("video/webm"),add:async r=>[...r,"webm"],remove:async r=>r.filter(e=>e!=="webm")},W_={extension:{type:W.DetectionParser,priority:0},test:async()=>mc("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async r=>[...r,"webp"],remove:async r=>r.filter(e=>e!=="webp")};class Y_{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,t,i)=>(this._parsersValidated=!1,e[t]=i,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,t){const i={promise:null,parser:null};return i.promise=(async()=>{var a,o;let s=null,n=null;if(t.loadParser&&(n=this._parserHash[t.loadParser],n||Ee(`[Assets] specified load parser "${t.loadParser}" not found while loading ${e}`)),!n){for(let l=0;l<this.parsers.length;l++){const c=this.parsers[l];if(c.load&&((a=c.test)!=null&&a.call(c,e,t,this))){n=c;break}}if(!n)return Ee(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}s=await n.load(e,t,this),i.parser=n;for(let l=0;l<this.parsers.length;l++){const c=this.parsers[l];c.parse&&c.parse&&await((o=c.testParse)==null?void 0:o.call(c,s,t,this))&&(s=await c.parse(s,t,this)||s,i.parser=c)}return s})(),i}async load(e,t){this._parsersValidated||this._validateParsers();let i=0;const s={},n=Ur(e),a=Et(e,c=>({alias:[c],src:c,data:{}})),o=a.length,l=a.map(async c=>{const u=et.toAbsolute(c.src);if(!s[c.src])try{this.promiseCache[u]||(this.promiseCache[u]=this._getLoadPromiseAndParser(u,c)),s[c.src]=await this.promiseCache[u].promise,t&&t(++i/o)}catch(h){throw delete this.promiseCache[u],delete s[c.src],new Error(`[Loader.load] Failed to load ${u}.
${h}`)}});return await Promise.all(l),n?s[a[0].src]:s}async unload(e){const i=Et(e,s=>({alias:[s],src:s})).map(async s=>{var o,l;const n=et.toAbsolute(s.src),a=this.promiseCache[n];if(a){const c=await a.promise;delete this.promiseCache[n],await((l=(o=a.parser)==null?void 0:o.unload)==null?void 0:l.call(o,c,s,this))}});await Promise.all(i)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,t)=>(t.name?e[t.name]&&Ee(`[Assets] loadParser name conflict "${t.name}"`):Ee("[Assets] loadParser should have a name"),{...e,[t.name]:t}),{})}}function ws(r,e){if(Array.isArray(e)){for(const t of e)if(r.startsWith(`data:${t}`))return!0;return!1}return r.startsWith(`data:${e}`)}function vs(r,e){const t=r.split("?")[0],i=et.extname(t).toLowerCase();return Array.isArray(e)?e.includes(i):i===e}const V_=".json",X_="application/json",$_={extension:{type:W.LoadParser,priority:yi.Low},name:"loadJson",test(r){return ws(r,X_)||vs(r,V_)},async load(r){return await(await ue.get().fetch(r)).json()}},j_=".txt",q_="text/plain",K_={name:"loadTxt",extension:{type:W.LoadParser,priority:yi.Low,name:"loadTxt"},test(r){return ws(r,q_)||vs(r,j_)},async load(r){return await(await ue.get().fetch(r)).text()}},Z_=["normal","bold","100","200","300","400","500","600","700","800","900"],Q_=[".ttf",".otf",".woff",".woff2"],J_=["font/ttf","font/otf","font/woff","font/woff2"],eg=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function tg(r){const e=et.extname(r),s=et.basename(r,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1));let n=s.length>0;for(const o of s)if(!o.match(eg)){n=!1;break}let a=s.join(" ");return n||(a=`"${a.replace(/[\\"]/g,"\\$&")}"`),a}const ig=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function sg(r){return ig.test(r)?r:encodeURI(r)}const rg={extension:{type:W.LoadParser,priority:yi.Low},name:"loadWebFont",test(r){return ws(r,J_)||vs(r,Q_)},async load(r,e){var i,s,n;const t=ue.get().getFontFaceSet();if(t){const a=[],o=((i=e.data)==null?void 0:i.family)??tg(r),l=((n=(s=e.data)==null?void 0:s.weights)==null?void 0:n.filter(u=>Z_.includes(u)))??["normal"],c=e.data??{};for(let u=0;u<l.length;u++){const h=l[u],d=new FontFace(o,`url(${sg(r)})`,{...c,weight:h});await d.load(),t.add(d),a.push(d)}return pe.set(`${o}-and-url`,{url:r,fontFaces:a}),a.length===1?a[0]:a}return Ee("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(r){(Array.isArray(r)?r:[r]).forEach(e=>{pe.remove(e.family),ue.get().getFontFaceSet().delete(e)})}};function ao(r,e=1){var i;const t=(i=Ts.RETINA_PREFIX)==null?void 0:i.exec(r);return t?parseFloat(t[1]):e}function oo(r,e,t){r.label=t,r._sourceOrigin=t;const i=new q({source:r,label:t}),s=()=>{delete e.promiseCache[t],pe.has(t)&&pe.remove(t)};return i.source.once("destroy",()=>{e.promiseCache[t]&&(Ee("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),s())}),i.once("destroy",()=>{r.destroyed||(Ee("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),s())}),i}const ng=".svg",ag="image/svg+xml",og={extension:{type:W.LoadParser,priority:yi.Low,name:"loadSVG"},name:"loadSVG",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(r){return ws(r,ag)||vs(r,ng)},async load(r,e,t){return e.data.parseAsGraphicsContext??this.config.parseAsGraphicsContext?lg(r):hg(r,e,t,this.config.crossOrigin)},unload(r){r.destroy(!0)}};async function hg(r,e,t,i){var g,m,x;const n=await(await ue.get().fetch(r)).blob(),a=URL.createObjectURL(n),o=new Image;o.src=a,o.crossOrigin=i,await o.decode(),URL.revokeObjectURL(a);const l=document.createElement("canvas"),c=l.getContext("2d"),u=((g=e.data)==null?void 0:g.resolution)||ao(r),h=((m=e.data)==null?void 0:m.width)??o.width,d=((x=e.data)==null?void 0:x.height)??o.height;l.width=h*u,l.height=d*u,c.drawImage(o,0,0,h*u,d*u);const{parseAsGraphicsContext:f,...p}=e.data,_=new Ss({resource:l,alphaMode:"premultiply-alpha-on-upload",resolution:u,...p});return oo(_,t,r)}async function lg(r){const t=await(await ue.get().fetch(r)).text(),i=new yt;return i.svg(t),i}const cg=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let as=null,Ma=class{constructor(){as||(as=URL.createObjectURL(new Blob([cg],{type:"application/javascript"}))),this.worker=new Worker(as)}};Ma.revokeObjectURL=function(){as&&(URL.revokeObjectURL(as),as=null)};const ug=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let os=null;class xc{constructor(){os||(os=URL.createObjectURL(new Blob([ug],{type:"application/javascript"}))),this.worker=new Worker(os)}}xc.revokeObjectURL=function(){os&&(URL.revokeObjectURL(os),os=null)};let Nh=0,Un;class dg{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const{worker:t}=new Ma;t.addEventListener("message",i=>{t.terminate(),Ma.revokeObjectURL(),e(i.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e,t){var i;return this._run("loadImageBitmap",[e,(i=t==null?void 0:t.data)==null?void 0:i.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){Un===void 0&&(Un=navigator.hardwareConcurrency||4);let e=this._workerPool.pop();return!e&&this._createdWorkers<Un&&(this._createdWorkers++,e=new xc().worker,e.addEventListener("message",t=>{this._complete(t.data),this._returnWorker(t.target),this._next()})),e}_returnWorker(e){this._workerPool.push(e)}_complete(e){e.error!==void 0?this._resolveHash[e.uuid].reject(e.error):this._resolveHash[e.uuid].resolve(e.data),this._resolveHash[e.uuid]=null}async _run(e,t){await this._initWorkers();const i=new Promise((s,n)=>{this._queue.push({id:e,arguments:t,resolve:s,reject:n})});return this._next(),i}_next(){if(!this._queue.length)return;const e=this._getWorker();if(!e)return;const t=this._queue.pop(),i=t.id;this._resolveHash[Nh]={resolve:t.resolve,reject:t.reject},e.postMessage({data:t.arguments,uuid:Nh++,id:i})}}const Bh=new dg,fg=[".jpeg",".jpg",".png",".webp",".avif"],pg=["image/jpeg","image/png","image/webp","image/avif"];async function _g(r,e){var s;const t=await ue.get().fetch(r);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${r}: ${t.status} ${t.statusText}`);const i=await t.blob();return((s=e==null?void 0:e.data)==null?void 0:s.alphaMode)==="premultiplied-alpha"?createImageBitmap(i,{premultiplyAlpha:"none"}):createImageBitmap(i)}const yc={name:"loadTextures",extension:{type:W.LoadParser,priority:yi.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(r){return ws(r,pg)||vs(r,fg)},async load(r,e,t){var n;let i=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await Bh.isImageBitmapSupported()?i=await Bh.loadImageBitmap(r,e):i=await _g(r,e):i=await new Promise(a=>{i=new Image,i.crossOrigin=this.config.crossOrigin,i.src=r,i.complete?a(i):i.onload=()=>{a(i)}});const s=new Ss({resource:i,alphaMode:"premultiply-alpha-on-upload",resolution:((n=e.data)==null?void 0:n.resolution)||ao(r),...e.data});return oo(s,t,r)},unload(r){r.destroy(!0)}},Sc=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"],gg=Sc.map(r=>`video/${r.substring(1)}`);function mg(r,e,t){t===void 0&&!e.startsWith("data:")?r.crossOrigin=yg(e):t!==!1&&(r.crossOrigin=typeof t=="string"?t:"anonymous")}function xg(r){return new Promise((e,t)=>{r.addEventListener("canplaythrough",i),r.addEventListener("error",s),r.load();function i(){n(),e()}function s(a){n(),t(a)}function n(){r.removeEventListener("canplaythrough",i),r.removeEventListener("error",s)}})}function yg(r,e=globalThis.location){if(r.startsWith("data:"))return"";e=e||globalThis.location;const t=new URL(r,document.baseURI);return t.hostname!==e.hostname||t.port!==e.port||t.protocol!==e.protocol?"anonymous":""}const Sg={name:"loadVideo",extension:{type:W.LoadParser,name:"loadVideo"},test(r){const e=ws(r,gg),t=vs(r,Sc);return e||t},async load(r,e,t){var l,c;const i={...Rr.defaultOptions,resolution:((l=e.data)==null?void 0:l.resolution)||ao(r),alphaMode:((c=e.data)==null?void 0:c.alphaMode)||await Nl(),...e.data},s=document.createElement("video"),n={preload:i.autoLoad!==!1?"auto":void 0,"webkit-playsinline":i.playsinline!==!1?"":void 0,playsinline:i.playsinline!==!1?"":void 0,muted:i.muted===!0?"":void 0,loop:i.loop===!0?"":void 0,autoplay:i.autoPlay!==!1?"":void 0};Object.keys(n).forEach(u=>{const h=n[u];h!==void 0&&s.setAttribute(u,h)}),i.muted===!0&&(s.muted=!0),mg(s,r,i.crossorigin);const a=document.createElement("source");let o;if(r.startsWith("data:"))o=r.slice(5,r.indexOf(";"));else if(!r.startsWith("blob:")){const u=r.split("?")[0].slice(r.lastIndexOf(".")+1).toLowerCase();o=Rr.MIME_TYPES[u]||`video/${u}`}return a.src=r,o&&(a.type=o),new Promise(u=>{const h=async()=>{const d=new Rr({...i,resource:s});s.removeEventListener("canplay",h),e.data.preload&&await xg(s),u(oo(d,t,r))};s.addEventListener("canplay",h),s.appendChild(a)})},unload(r){r.destroy(!0)}},Tc={extension:{type:W.ResolveParser,name:"resolveTexture"},test:yc.test,parse:r=>{var e;return{resolution:parseFloat(((e=Ts.RETINA_PREFIX.exec(r))==null?void 0:e[1])??"1"),format:r.split(".").pop(),src:r}}},Tg={extension:{type:W.ResolveParser,priority:-2,name:"resolveJson"},test:r=>Ts.RETINA_PREFIX.test(r)&&r.endsWith(".json"),parse:Tc.parse};class wg{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Ts,this.loader=new Y_,this.cache=pe,this._backgroundLoader=new O_(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){var n,a;if(this._initialized){Ee("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let o=e.manifest;typeof o=="string"&&(o=await this.load(o)),this.resolver.addManifest(o)}const t=((n=e.texturePreference)==null?void 0:n.resolution)??1,i=typeof t=="number"?[t]:t,s=await this._detectFormats({preferredFormats:(a=e.texturePreference)==null?void 0:a.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:s,resolution:i}}),e.preferences&&this.setPreferences(e.preferences)}add(e){this.resolver.add(e)}async load(e,t){this._initialized||await this.init();const i=Ur(e),s=Et(e).map(o=>{if(typeof o!="string"){const l=this.resolver.getAlias(o);return l.some(c=>!this.resolver.hasKey(c))&&this.add(o),Array.isArray(l)?l[0]:l}return this.resolver.hasKey(o)||this.add({alias:o,src:o}),o}),n=this.resolver.resolve(s),a=await this._mapLoadToResolve(n,t);return i?a[s[0]]:a}addBundle(e,t){this.resolver.addBundle(e,t)}async loadBundle(e,t){this._initialized||await this.init();let i=!1;typeof e=="string"&&(i=!0,e=[e]);const s=this.resolver.resolveBundle(e),n={},a=Object.keys(s);let o=0,l=0;const c=()=>{t==null||t(++o/l)},u=a.map(h=>{const d=s[h];return l+=Object.keys(d).length,this._mapLoadToResolve(d,c).then(f=>{n[h]=f})});return await Promise.all(u),i?n[e[0]]:n}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const t=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(t))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const t=this.resolver.resolveBundle(e);Object.values(t).forEach(i=>{this._backgroundLoader.add(Object.values(i))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return pe.get(e);const t={};for(let i=0;i<e.length;i++)t[i]=pe.get(e[i]);return t}async _mapLoadToResolve(e,t){const i=[...new Set(Object.values(e))];this._backgroundLoader.active=!1;const s=await this.loader.load(i,t);this._backgroundLoader.active=!0;const n={};return i.forEach(a=>{const o=s[a.src],l=[a.src];a.alias&&l.push(...a.alias),l.forEach(c=>{n[c]=o}),pe.set(l,o)}),n}async unload(e){this._initialized||await this.init();const t=Et(e).map(s=>typeof s!="string"?s.src:s),i=this.resolver.resolve(t);await this._unloadFromResolved(i)}async unloadBundle(e){this._initialized||await this.init(),e=Et(e);const t=this.resolver.resolveBundle(e),i=Object.keys(t).map(s=>this._unloadFromResolved(t[s]));await Promise.all(i)}async _unloadFromResolved(e){const t=Object.values(e);t.forEach(i=>{pe.remove(i.src)}),await this.loader.unload(t)}async _detectFormats(e){let t=[];e.preferredFormats&&(t=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const i of e.detections)e.skipDetections||await i.test()?t=await i.add(t):e.skipDetections||(t=await i.remove(t));return t=t.filter((i,s)=>t.indexOf(i)===s),t}get detections(){return this._detections}setPreferences(e){this.loader.parsers.forEach(t=>{t.config&&Object.keys(t.config).filter(i=>i in e).forEach(i=>{t.config[i]=e[i]})})}}const Oi=new wg;ze.handleByList(W.LoadParser,Oi.loader.parsers).handleByList(W.ResolveParser,Oi.resolver.parsers).handleByList(W.CacheParser,Oi.cache.parsers).handleByList(W.DetectionParser,Oi.detections);ze.add(N_,G_,B_,W_,H_,U_,z_,$_,K_,rg,og,yc,Sg,F_,L_,Tc,Tg);const Gh={loader:W.LoadParser,resolver:W.ResolveParser,cache:W.CacheParser,detection:W.DetectionParser};ze.handle(W.Asset,r=>{const e=r.ref;Object.entries(Gh).filter(([t])=>!!e[t]).forEach(([t,i])=>ze.add(Object.assign(e[t],{extension:e[t].extension??i})))},r=>{const e=r.ref;Object.keys(Gh).filter(t=>!!e[t]).forEach(t=>ze.remove(e[t]))});class ps extends Za{constructor(e){e instanceof yt&&(e={context:e});const{context:t,roundPixels:i,...s}=e||{};super({label:"Graphics",...s}),this.renderPipeId="graphics",t?this._context=t:this._context=this._ownedContext=new yt,this._context.on("update",this.onViewUpdate,this),this.allowChildren=!1,this.roundPixels=i??!1}set context(e){e!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=e,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}addBounds(e){e.addBounds(this._context.bounds)}containsPoint(e){return this._context.containsPoint(e)}onViewUpdate(){if(this._didViewChangeTick++,this._didGraphicsUpdate=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}destroy(e){this._ownedContext&&!e?this._ownedContext.destroy(e):(e===!0||(e==null?void 0:e.context)===!0)&&this._context.destroy(e),this._ownedContext=null,this._context=null,super.destroy(e)}_callContextMethod(e,t){return this.context[e](...t),this}setFillStyle(...e){return this._callContextMethod("setFillStyle",e)}setStrokeStyle(...e){return this._callContextMethod("setStrokeStyle",e)}fill(...e){return this._callContextMethod("fill",e)}stroke(...e){return this._callContextMethod("stroke",e)}texture(...e){return this._callContextMethod("texture",e)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...e){return this._callContextMethod("arc",e)}arcTo(...e){return this._callContextMethod("arcTo",e)}arcToSvg(...e){return this._callContextMethod("arcToSvg",e)}bezierCurveTo(...e){return this._callContextMethod("bezierCurveTo",e)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...e){return this._callContextMethod("ellipse",e)}circle(...e){return this._callContextMethod("circle",e)}path(...e){return this._callContextMethod("path",e)}lineTo(...e){return this._callContextMethod("lineTo",e)}moveTo(...e){return this._callContextMethod("moveTo",e)}quadraticCurveTo(...e){return this._callContextMethod("quadraticCurveTo",e)}rect(...e){return this._callContextMethod("rect",e)}roundRect(...e){return this._callContextMethod("roundRect",e)}poly(...e){return this._callContextMethod("poly",e)}regularPoly(...e){return this._callContextMethod("regularPoly",e)}roundPoly(...e){return this._callContextMethod("roundPoly",e)}roundShape(...e){return this._callContextMethod("roundShape",e)}filletRect(...e){return this._callContextMethod("filletRect",e)}chamferRect(...e){return this._callContextMethod("chamferRect",e)}star(...e){return this._callContextMethod("star",e)}svg(...e){return this._callContextMethod("svg",e)}restore(...e){return this._callContextMethod("restore",e)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...e){return this._callContextMethod("rotate",e)}scaleTransform(...e){return this._callContextMethod("scale",e)}setTransform(...e){return this._callContextMethod("setTransform",e)}transform(...e){return this._callContextMethod("transform",e)}translateTransform(...e){return this._callContextMethod("translate",e)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(e){this._context.fillStyle=e}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(e){this._context.strokeStyle=e}clone(e=!1){return e?new ps(this._context.clone()):(this._ownedContext=null,new ps(this._context))}lineStyle(e,t,i){oe(ae,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const s={};return e&&(s.width=e),t&&(s.color=t),i&&(s.alpha=i),this.context.strokeStyle=s,this}beginFill(e,t){oe(ae,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const i={};return e&&(i.color=e),t&&(i.alpha=t),this.context.fillStyle=i,this}endFill(){oe(ae,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const e=this.context.strokeStyle;return(e.width!==yt.defaultStrokeStyle.width||e.color!==yt.defaultStrokeStyle.color||e.alpha!==yt.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...e){return oe(ae,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",e)}drawEllipse(...e){return oe(ae,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",e)}drawPolygon(...e){return oe(ae,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",e)}drawRect(...e){return oe(ae,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",e)}drawRoundedRect(...e){return oe(ae,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",e)}drawStar(...e){return oe(ae,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",e)}}class vg extends Za{constructor(e,t){const{text:i,resolution:s,style:n,anchor:a,width:o,height:l,roundPixels:c,...u}=e;super({...u}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=t,this.text=i??"",this.style=n,this.resolution=s??null,this.allowChildren=!1,this._anchor=new Qe({_onUpdate:()=>{this.onViewUpdate()}}),a&&(this.anchor=a),this.roundPixels=c??!1,o!==void 0&&(this.width=o),l!==void 0&&(this.height=l)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}set text(e){e=e.toString(),this._text!==e&&(this._text=e,this.onViewUpdate())}get text(){return this._text}set resolution(e){this._autoResolution=e===null,this._resolution=e,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(e){var t;e=e||{},(t=this._style)==null||t.off("update",this.onViewUpdate,this),e instanceof this._styleClass?this._style=e:this._style=new this._styleClass(e),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get bounds(){return this._boundsDirty&&(this._updateBounds(),this._boundsDirty=!1),this._bounds}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(e){this._setWidth(e,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(e){this._setHeight(e,this.bounds.height)}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this.bounds.width,e.height=Math.abs(this.scale.y)*this.bounds.height,e}setSize(e,t){let i,s;typeof e!="object"?(i=e,s=t??e):(i=e.width,s=e.height??e.width),i!==void 0&&this._setWidth(i,this.bounds.width),s!==void 0&&this._setHeight(s,this.bounds.height)}addBounds(e){const t=this.bounds;e.addFrame(t.minX,t.minY,t.maxX,t.maxY)}containsPoint(e){const t=this.bounds.width,i=this.bounds.height,s=-t*this.anchor.x;let n=0;return e.x>=s&&e.x<=s+t&&(n=-i*this.anchor.y,e.y>=n&&e.y<=n+i)}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0,this._didTextUpdate=!0;const e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}_getKey(){return`${this.text}:${this._style.styleKey}:${this._resolution}`}destroy(e=!1){super.destroy(e),this.owner=null,this._bounds=null,this._anchor=null,(typeof e=="boolean"?e:e!=null&&e.style)&&this._style.destroy(e),this._style=null,this._text=null}}function bg(r,e){let t=r[0]??{};return(typeof t=="string"||r[1])&&(oe(ae,`use new ${e}({ text: "hi!", style }) instead`),t={text:t,style:r[1]}),t}class Wr extends vg{constructor(...e){const t=bg(e,"Text");super(t,ii),this.renderPipeId="text"}_updateBounds(){const e=this._bounds,t=this._anchor,i=Ca.measureText(this._text,this._style),{width:s,height:n}=i;e.minX=-t._x*s,e.maxX=e.minX+s,e.minY=-t._y*n,e.maxY=e.minY+n}}ze.add(Dd,Hd);const Os=class extends j{constructor(r,e){super(q.EMPTY),this.animationSpeed=1,this.loop=!0,this.duration=0,this.autoPlay=!0,this.dirty=!1,this._currentFrame=0,this._autoUpdate=!1,this._isConnectedToTicker=!1,this._playing=!1,this._currentTime=0,this.onRender=()=>this.updateFrame();const{scaleMode:t,width:i,height:s,...n}=Object.assign({},Os.defaultOptions,e),a=ue.get().createCanvas(i,s),o=a.getContext("2d");this.texture=q.from(a),this.texture.source.scaleMode=t,this.duration=r[r.length-1].end,this._frames=r,this._context=o,this._playing=!1,this._currentTime=0,this._isConnectedToTicker=!1,Object.assign(this,n),this.currentFrame=0,n.autoPlay&&this.play()}static fromBuffer(r,e){if(!r||r.byteLength===0)throw new Error("Invalid buffer");const t=g=>{let m=null;for(const x of g.frames)m=x.gce??m,"image"in x&&!("gce"in x)&&(x.gce=m)},i=cl(r);t(i);const s=ll(i,!0),n=[],a=ue.get().createCanvas(i.lsd.width,i.lsd.height),o=a.getContext("2d",{willReadFrequently:!0}),l=ue.get().createCanvas(),c=l.getContext("2d");let u=0,h=null;const{fps:d}=Object.assign({},Os.defaultOptions,e),f=1e3/d;for(let g=0;g<s.length;g++){const{disposalType:m=2,delay:x=f,patch:S,dims:{width:w,height:A,left:k,top:P}}=s[g];l.width=w,l.height=A,c.clearRect(0,0,w,A);const E=c.createImageData(w,A);E.data.set(S),c.putImageData(E,0,0),m===3&&(h=o.getImageData(0,0,a.width,a.height)),o.drawImage(l,k,P);const b=o.getImageData(0,0,a.width,a.height);m===2?o.clearRect(0,0,a.width,a.height):m===3&&o.putImageData(h,0,0),n.push({start:u,end:u+x,imageData:b}),u+=x}a.width=a.height=0,l.width=l.height=0;const{width:p,height:_}=i.lsd;return new Os(n,{width:p,height:_,...e})}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(kt.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(kt.shared.add(this.update,this,Hr.HIGH),this._isConnectedToTicker=!0),!this.loop&&this.currentFrame===this._frames.length-1&&(this._currentTime=0))}get progress(){return this._currentTime/this.duration}get playing(){return this._playing}update(r){var n,a;if(!this._playing)return;const e=this.animationSpeed*r.deltaTime/kt.targetFPMS,t=this._currentTime+e,i=t%this.duration,s=this._frames.findIndex(o=>o.start<=i&&o.end>i);t>=this.duration?this.loop?(this._currentTime=i,this.updateFrameIndex(s),(n=this.onLoop)==null||n.call(this)):(this._currentTime=this.duration,this.updateFrameIndex(this._frames.length-1),(a=this.onComplete)==null||a.call(this),this.stop()):(this._currentTime=i,this.updateFrameIndex(s))}updateFrame(){if(!this.dirty)return;const{imageData:r}=this._frames[this._currentFrame];this._context.putImageData(r,0,0),this._context.fillStyle="transparent",this._context.fillRect(0,0,0,1),this.texture.source.update(),this.dirty=!1}get autoUpdate(){return this._autoUpdate}set autoUpdate(r){r!==this._autoUpdate&&(this._autoUpdate=r,!this._autoUpdate&&this._isConnectedToTicker?(kt.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(kt.shared.add(this.update,this),this._isConnectedToTicker=!0))}get currentFrame(){return this._currentFrame}set currentFrame(r){this.updateFrameIndex(r),this._currentTime=this._frames[r].start}updateFrameIndex(r){var e;if(r<0||r>=this._frames.length)throw new Error(`Frame index out of range, expecting 0 to ${this.totalFrames}, got ${r}`);this._currentFrame!==r&&(this._currentFrame=r,this.dirty=!0,(e=this.onFrameChange)==null||e.call(this,r))}get totalFrames(){return this._frames.length}destroy(){this.stop(),super.destroy(!0);const r=null;this._context=r,this._frames=r,this.onComplete=r,this.onFrameChange=r,this.onLoop=r}clone(){const r=new Os([...this._frames],{autoUpdate:this._autoUpdate,loop:this.loop,autoPlay:this.autoPlay,scaleMode:this.texture.source.scaleMode,animationSpeed:this.animationSpeed,width:this._context.canvas.width,height:this._context.canvas.height,onComplete:this.onComplete,onFrameChange:this.onFrameChange,onLoop:this.onLoop});return r.dirty=!0,r}};let wc=Os;wc.defaultOptions={scaleMode:"linear",fps:30,loop:!0,animationSpeed:1,autoPlay:!0,autoUpdate:!0,onComplete:null,onFrameChange:null,onLoop:null};const Ag={extension:W.Asset,detection:{test:async()=>!0,add:async r=>[...r,"gif"],remove:async r=>r.filter(e=>e!=="gif")},loader:{name:"gifLoader",test:r=>et.extname(r)===".gif",load:async(r,e)=>{const i=await(await ue.get().fetch(r)).arrayBuffer();return wc.fromBuffer(i,e==null?void 0:e.data)},unload:async r=>{r.destroy()}}};ze.add(Ag);var vc={};/*!
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(r){(function(){var e=function(){this.init()};e.prototype={init:function(){var h=this||t;return h._counter=1e3,h._html5AudioPool=[],h.html5PoolSize=10,h._codecs={},h._howls=[],h._muted=!1,h._volume=1,h._canPlayEvent="canplaythrough",h._navigator=typeof window<"u"&&window.navigator?window.navigator:null,h.masterGain=null,h.noAudio=!1,h.usingWebAudio=!0,h.autoSuspend=!0,h.ctx=null,h.autoUnlock=!0,h._setup(),h},volume:function(h){var d=this||t;if(h=parseFloat(h),d.ctx||u(),typeof h<"u"&&h>=0&&h<=1){if(d._volume=h,d._muted)return d;d.usingWebAudio&&d.masterGain.gain.setValueAtTime(h,t.ctx.currentTime);for(var f=0;f<d._howls.length;f++)if(!d._howls[f]._webAudio)for(var p=d._howls[f]._getSoundIds(),_=0;_<p.length;_++){var g=d._howls[f]._soundById(p[_]);g&&g._node&&(g._node.volume=g._volume*h)}return d}return d._volume},mute:function(h){var d=this||t;d.ctx||u(),d._muted=h,d.usingWebAudio&&d.masterGain.gain.setValueAtTime(h?0:d._volume,t.ctx.currentTime);for(var f=0;f<d._howls.length;f++)if(!d._howls[f]._webAudio)for(var p=d._howls[f]._getSoundIds(),_=0;_<p.length;_++){var g=d._howls[f]._soundById(p[_]);g&&g._node&&(g._node.muted=h?!0:g._muted)}return d},stop:function(){for(var h=this||t,d=0;d<h._howls.length;d++)h._howls[d].stop();return h},unload:function(){for(var h=this||t,d=h._howls.length-1;d>=0;d--)h._howls[d].unload();return h.usingWebAudio&&h.ctx&&typeof h.ctx.close<"u"&&(h.ctx.close(),h.ctx=null,u()),h},codecs:function(h){return(this||t)._codecs[h.replace(/^x-/,"")]},_setup:function(){var h=this||t;if(h.state=h.ctx&&h.ctx.state||"suspended",h._autoSuspend(),!h.usingWebAudio)if(typeof Audio<"u")try{var d=new Audio;typeof d.oncanplaythrough>"u"&&(h._canPlayEvent="canplay")}catch{h.noAudio=!0}else h.noAudio=!0;try{var d=new Audio;d.muted&&(h.noAudio=!0)}catch{}return h.noAudio||h._setupCodecs(),h},_setupCodecs:function(){var h=this||t,d=null;try{d=typeof Audio<"u"?new Audio:null}catch{return h}if(!d||typeof d.canPlayType!="function")return h;var f=d.canPlayType("audio/mpeg;").replace(/^no$/,""),p=h._navigator?h._navigator.userAgent:"",_=p.match(/OPR\/(\d+)/g),g=_&&parseInt(_[0].split("/")[1],10)<33,m=p.indexOf("Safari")!==-1&&p.indexOf("Chrome")===-1,x=p.match(/Version\/(.*?) /),S=m&&x&&parseInt(x[1],10)<15;return h._codecs={mp3:!!(!g&&(f||d.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!f,opus:!!d.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(d.canPlayType('audio/wav; codecs="1"')||d.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!d.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!d.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(d.canPlayType("audio/x-m4a;")||d.canPlayType("audio/m4a;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(d.canPlayType("audio/x-m4b;")||d.canPlayType("audio/m4b;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(d.canPlayType("audio/x-mp4;")||d.canPlayType("audio/mp4;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!S&&d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!S&&d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!d.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(d.canPlayType("audio/x-flac;")||d.canPlayType("audio/flac;")).replace(/^no$/,"")},h},_unlockAudio:function(){var h=this||t;if(!(h._audioUnlocked||!h.ctx)){h._audioUnlocked=!1,h.autoUnlock=!1,!h._mobileUnloaded&&h.ctx.sampleRate!==44100&&(h._mobileUnloaded=!0,h.unload()),h._scratchBuffer=h.ctx.createBuffer(1,1,22050);var d=function(f){for(;h._html5AudioPool.length<h.html5PoolSize;)try{var p=new Audio;p._unlocked=!0,h._releaseHtml5Audio(p)}catch{h.noAudio=!0;break}for(var _=0;_<h._howls.length;_++)if(!h._howls[_]._webAudio)for(var g=h._howls[_]._getSoundIds(),m=0;m<g.length;m++){var x=h._howls[_]._soundById(g[m]);x&&x._node&&!x._node._unlocked&&(x._node._unlocked=!0,x._node.load())}h._autoResume();var S=h.ctx.createBufferSource();S.buffer=h._scratchBuffer,S.connect(h.ctx.destination),typeof S.start>"u"?S.noteOn(0):S.start(0),typeof h.ctx.resume=="function"&&h.ctx.resume(),S.onended=function(){S.disconnect(0),h._audioUnlocked=!0,document.removeEventListener("touchstart",d,!0),document.removeEventListener("touchend",d,!0),document.removeEventListener("click",d,!0),document.removeEventListener("keydown",d,!0);for(var w=0;w<h._howls.length;w++)h._howls[w]._emit("unlock")}};return document.addEventListener("touchstart",d,!0),document.addEventListener("touchend",d,!0),document.addEventListener("click",d,!0),document.addEventListener("keydown",d,!0),h}},_obtainHtml5Audio:function(){var h=this||t;if(h._html5AudioPool.length)return h._html5AudioPool.pop();var d=new Audio().play();return d&&typeof Promise<"u"&&(d instanceof Promise||typeof d.then=="function")&&d.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(h){var d=this||t;return h._unlocked&&d._html5AudioPool.push(h),d},_autoSuspend:function(){var h=this;if(!(!h.autoSuspend||!h.ctx||typeof h.ctx.suspend>"u"||!t.usingWebAudio)){for(var d=0;d<h._howls.length;d++)if(h._howls[d]._webAudio){for(var f=0;f<h._howls[d]._sounds.length;f++)if(!h._howls[d]._sounds[f]._paused)return h}return h._suspendTimer&&clearTimeout(h._suspendTimer),h._suspendTimer=setTimeout(function(){if(h.autoSuspend){h._suspendTimer=null,h.state="suspending";var p=function(){h.state="suspended",h._resumeAfterSuspend&&(delete h._resumeAfterSuspend,h._autoResume())};h.ctx.suspend().then(p,p)}},3e4),h}},_autoResume:function(){var h=this;if(!(!h.ctx||typeof h.ctx.resume>"u"||!t.usingWebAudio))return h.state==="running"&&h.ctx.state!=="interrupted"&&h._suspendTimer?(clearTimeout(h._suspendTimer),h._suspendTimer=null):h.state==="suspended"||h.state==="running"&&h.ctx.state==="interrupted"?(h.ctx.resume().then(function(){h.state="running";for(var d=0;d<h._howls.length;d++)h._howls[d]._emit("resume")}),h._suspendTimer&&(clearTimeout(h._suspendTimer),h._suspendTimer=null)):h.state==="suspending"&&(h._resumeAfterSuspend=!0),h}};var t=new e,i=function(h){var d=this;if(!h.src||h.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}d.init(h)};i.prototype={init:function(h){var d=this;return t.ctx||u(),d._autoplay=h.autoplay||!1,d._format=typeof h.format!="string"?h.format:[h.format],d._html5=h.html5||!1,d._muted=h.mute||!1,d._loop=h.loop||!1,d._pool=h.pool||5,d._preload=typeof h.preload=="boolean"||h.preload==="metadata"?h.preload:!0,d._rate=h.rate||1,d._sprite=h.sprite||{},d._src=typeof h.src!="string"?h.src:[h.src],d._volume=h.volume!==void 0?h.volume:1,d._xhr={method:h.xhr&&h.xhr.method?h.xhr.method:"GET",headers:h.xhr&&h.xhr.headers?h.xhr.headers:null,withCredentials:h.xhr&&h.xhr.withCredentials?h.xhr.withCredentials:!1},d._duration=0,d._state="unloaded",d._sounds=[],d._endTimers={},d._queue=[],d._playLock=!1,d._onend=h.onend?[{fn:h.onend}]:[],d._onfade=h.onfade?[{fn:h.onfade}]:[],d._onload=h.onload?[{fn:h.onload}]:[],d._onloaderror=h.onloaderror?[{fn:h.onloaderror}]:[],d._onplayerror=h.onplayerror?[{fn:h.onplayerror}]:[],d._onpause=h.onpause?[{fn:h.onpause}]:[],d._onplay=h.onplay?[{fn:h.onplay}]:[],d._onstop=h.onstop?[{fn:h.onstop}]:[],d._onmute=h.onmute?[{fn:h.onmute}]:[],d._onvolume=h.onvolume?[{fn:h.onvolume}]:[],d._onrate=h.onrate?[{fn:h.onrate}]:[],d._onseek=h.onseek?[{fn:h.onseek}]:[],d._onunlock=h.onunlock?[{fn:h.onunlock}]:[],d._onresume=[],d._webAudio=t.usingWebAudio&&!d._html5,typeof t.ctx<"u"&&t.ctx&&t.autoUnlock&&t._unlockAudio(),t._howls.push(d),d._autoplay&&d._queue.push({event:"play",action:function(){d.play()}}),d._preload&&d._preload!=="none"&&d.load(),d},load:function(){var h=this,d=null;if(t.noAudio){h._emit("loaderror",null,"No audio support.");return}typeof h._src=="string"&&(h._src=[h._src]);for(var f=0;f<h._src.length;f++){var p,_;if(h._format&&h._format[f])p=h._format[f];else{if(_=h._src[f],typeof _!="string"){h._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}p=/^data:audio\/([^;,]+);/i.exec(_),p||(p=/\.([^.]+)$/.exec(_.split("?",1)[0])),p&&(p=p[1].toLowerCase())}if(p||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),p&&t.codecs(p)){d=h._src[f];break}}if(!d){h._emit("loaderror",null,"No codec support for selected audio sources.");return}return h._src=d,h._state="loading",window.location.protocol==="https:"&&d.slice(0,5)==="http:"&&(h._html5=!0,h._webAudio=!1),new s(h),h._webAudio&&a(h),h},play:function(h,d){var f=this,p=null;if(typeof h=="number")p=h,h=null;else{if(typeof h=="string"&&f._state==="loaded"&&!f._sprite[h])return null;if(typeof h>"u"&&(h="__default",!f._playLock)){for(var _=0,g=0;g<f._sounds.length;g++)f._sounds[g]._paused&&!f._sounds[g]._ended&&(_++,p=f._sounds[g]._id);_===1?h=null:p=null}}var m=p?f._soundById(p):f._inactiveSound();if(!m)return null;if(p&&!h&&(h=m._sprite||"__default"),f._state!=="loaded"){m._sprite=h,m._ended=!1;var x=m._id;return f._queue.push({event:"play",action:function(){f.play(x)}}),x}if(p&&!m._paused)return d||f._loadQueue("play"),m._id;f._webAudio&&t._autoResume();var S=Math.max(0,m._seek>0?m._seek:f._sprite[h][0]/1e3),w=Math.max(0,(f._sprite[h][0]+f._sprite[h][1])/1e3-S),A=w*1e3/Math.abs(m._rate),k=f._sprite[h][0]/1e3,P=(f._sprite[h][0]+f._sprite[h][1])/1e3;m._sprite=h,m._ended=!1;var E=function(){m._paused=!1,m._seek=S,m._start=k,m._stop=P,m._loop=!!(m._loop||f._sprite[h][2])};if(S>=P){f._ended(m);return}var b=m._node;if(f._webAudio){var M=function(){f._playLock=!1,E(),f._refreshBuffer(m);var F=m._muted||f._muted?0:m._volume;b.gain.setValueAtTime(F,t.ctx.currentTime),m._playStart=t.ctx.currentTime,typeof b.bufferSource.start>"u"?m._loop?b.bufferSource.noteGrainOn(0,S,86400):b.bufferSource.noteGrainOn(0,S,w):m._loop?b.bufferSource.start(0,S,86400):b.bufferSource.start(0,S,w),A!==1/0&&(f._endTimers[m._id]=setTimeout(f._ended.bind(f,m),A)),d||setTimeout(function(){f._emit("play",m._id),f._loadQueue()},0)};t.state==="running"&&t.ctx.state!=="interrupted"?M():(f._playLock=!0,f.once("resume",M),f._clearTimer(m._id))}else{var N=function(){b.currentTime=S,b.muted=m._muted||f._muted||t._muted||b.muted,b.volume=m._volume*t.volume(),b.playbackRate=m._rate;try{var F=b.play();if(F&&typeof Promise<"u"&&(F instanceof Promise||typeof F.then=="function")?(f._playLock=!0,E(),F.then(function(){f._playLock=!1,b._unlocked=!0,d?f._loadQueue():f._emit("play",m._id)}).catch(function(){f._playLock=!1,f._emit("playerror",m._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),m._ended=!0,m._paused=!0})):d||(f._playLock=!1,E(),f._emit("play",m._id)),b.playbackRate=m._rate,b.paused){f._emit("playerror",m._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}h!=="__default"||m._loop?f._endTimers[m._id]=setTimeout(f._ended.bind(f,m),A):(f._endTimers[m._id]=function(){f._ended(m),b.removeEventListener("ended",f._endTimers[m._id],!1)},b.addEventListener("ended",f._endTimers[m._id],!1))}catch(G){f._emit("playerror",m._id,G)}};b.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(b.src=f._src,b.load());var H=window&&window.ejecta||!b.readyState&&t._navigator.isCocoonJS;if(b.readyState>=3||H)N();else{f._playLock=!0,f._state="loading";var L=function(){f._state="loaded",N(),b.removeEventListener(t._canPlayEvent,L,!1)};b.addEventListener(t._canPlayEvent,L,!1),f._clearTimer(m._id)}}return m._id},pause:function(h){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"pause",action:function(){d.pause(h)}}),d;for(var f=d._getSoundIds(h),p=0;p<f.length;p++){d._clearTimer(f[p]);var _=d._soundById(f[p]);if(_&&!_._paused&&(_._seek=d.seek(f[p]),_._rateSeek=0,_._paused=!0,d._stopFade(f[p]),_._node))if(d._webAudio){if(!_._node.bufferSource)continue;typeof _._node.bufferSource.stop>"u"?_._node.bufferSource.noteOff(0):_._node.bufferSource.stop(0),d._cleanBuffer(_._node)}else(!isNaN(_._node.duration)||_._node.duration===1/0)&&_._node.pause();arguments[1]||d._emit("pause",_?_._id:null)}return d},stop:function(h,d){var f=this;if(f._state!=="loaded"||f._playLock)return f._queue.push({event:"stop",action:function(){f.stop(h)}}),f;for(var p=f._getSoundIds(h),_=0;_<p.length;_++){f._clearTimer(p[_]);var g=f._soundById(p[_]);g&&(g._seek=g._start||0,g._rateSeek=0,g._paused=!0,g._ended=!0,f._stopFade(p[_]),g._node&&(f._webAudio?g._node.bufferSource&&(typeof g._node.bufferSource.stop>"u"?g._node.bufferSource.noteOff(0):g._node.bufferSource.stop(0),f._cleanBuffer(g._node)):(!isNaN(g._node.duration)||g._node.duration===1/0)&&(g._node.currentTime=g._start||0,g._node.pause(),g._node.duration===1/0&&f._clearSound(g._node))),d||f._emit("stop",g._id))}return f},mute:function(h,d){var f=this;if(f._state!=="loaded"||f._playLock)return f._queue.push({event:"mute",action:function(){f.mute(h,d)}}),f;if(typeof d>"u")if(typeof h=="boolean")f._muted=h;else return f._muted;for(var p=f._getSoundIds(d),_=0;_<p.length;_++){var g=f._soundById(p[_]);g&&(g._muted=h,g._interval&&f._stopFade(g._id),f._webAudio&&g._node?g._node.gain.setValueAtTime(h?0:g._volume,t.ctx.currentTime):g._node&&(g._node.muted=t._muted?!0:h),f._emit("mute",g._id))}return f},volume:function(){var h=this,d=arguments,f,p;if(d.length===0)return h._volume;if(d.length===1||d.length===2&&typeof d[1]>"u"){var _=h._getSoundIds(),g=_.indexOf(d[0]);g>=0?p=parseInt(d[0],10):f=parseFloat(d[0])}else d.length>=2&&(f=parseFloat(d[0]),p=parseInt(d[1],10));var m;if(typeof f<"u"&&f>=0&&f<=1){if(h._state!=="loaded"||h._playLock)return h._queue.push({event:"volume",action:function(){h.volume.apply(h,d)}}),h;typeof p>"u"&&(h._volume=f),p=h._getSoundIds(p);for(var x=0;x<p.length;x++)m=h._soundById(p[x]),m&&(m._volume=f,d[2]||h._stopFade(p[x]),h._webAudio&&m._node&&!m._muted?m._node.gain.setValueAtTime(f,t.ctx.currentTime):m._node&&!m._muted&&(m._node.volume=f*t.volume()),h._emit("volume",m._id))}else return m=p?h._soundById(p):h._sounds[0],m?m._volume:0;return h},fade:function(h,d,f,p){var _=this;if(_._state!=="loaded"||_._playLock)return _._queue.push({event:"fade",action:function(){_.fade(h,d,f,p)}}),_;h=Math.min(Math.max(0,parseFloat(h)),1),d=Math.min(Math.max(0,parseFloat(d)),1),f=parseFloat(f),_.volume(h,p);for(var g=_._getSoundIds(p),m=0;m<g.length;m++){var x=_._soundById(g[m]);if(x){if(p||_._stopFade(g[m]),_._webAudio&&!x._muted){var S=t.ctx.currentTime,w=S+f/1e3;x._volume=h,x._node.gain.setValueAtTime(h,S),x._node.gain.linearRampToValueAtTime(d,w)}_._startFadeInterval(x,h,d,f,g[m],typeof p>"u")}}return _},_startFadeInterval:function(h,d,f,p,_,g){var m=this,x=d,S=f-d,w=Math.abs(S/.01),A=Math.max(4,w>0?p/w:p),k=Date.now();h._fadeTo=f,h._interval=setInterval(function(){var P=(Date.now()-k)/p;k=Date.now(),x+=S*P,x=Math.round(x*100)/100,S<0?x=Math.max(f,x):x=Math.min(f,x),m._webAudio?h._volume=x:m.volume(x,h._id,!0),g&&(m._volume=x),(f<d&&x<=f||f>d&&x>=f)&&(clearInterval(h._interval),h._interval=null,h._fadeTo=null,m.volume(f,h._id),m._emit("fade",h._id))},A)},_stopFade:function(h){var d=this,f=d._soundById(h);return f&&f._interval&&(d._webAudio&&f._node.gain.cancelScheduledValues(t.ctx.currentTime),clearInterval(f._interval),f._interval=null,d.volume(f._fadeTo,h),f._fadeTo=null,d._emit("fade",h)),d},loop:function(){var h=this,d=arguments,f,p,_;if(d.length===0)return h._loop;if(d.length===1)if(typeof d[0]=="boolean")f=d[0],h._loop=f;else return _=h._soundById(parseInt(d[0],10)),_?_._loop:!1;else d.length===2&&(f=d[0],p=parseInt(d[1],10));for(var g=h._getSoundIds(p),m=0;m<g.length;m++)_=h._soundById(g[m]),_&&(_._loop=f,h._webAudio&&_._node&&_._node.bufferSource&&(_._node.bufferSource.loop=f,f&&(_._node.bufferSource.loopStart=_._start||0,_._node.bufferSource.loopEnd=_._stop,h.playing(g[m])&&(h.pause(g[m],!0),h.play(g[m],!0)))));return h},rate:function(){var h=this,d=arguments,f,p;if(d.length===0)p=h._sounds[0]._id;else if(d.length===1){var _=h._getSoundIds(),g=_.indexOf(d[0]);g>=0?p=parseInt(d[0],10):f=parseFloat(d[0])}else d.length===2&&(f=parseFloat(d[0]),p=parseInt(d[1],10));var m;if(typeof f=="number"){if(h._state!=="loaded"||h._playLock)return h._queue.push({event:"rate",action:function(){h.rate.apply(h,d)}}),h;typeof p>"u"&&(h._rate=f),p=h._getSoundIds(p);for(var x=0;x<p.length;x++)if(m=h._soundById(p[x]),m){h.playing(p[x])&&(m._rateSeek=h.seek(p[x]),m._playStart=h._webAudio?t.ctx.currentTime:m._playStart),m._rate=f,h._webAudio&&m._node&&m._node.bufferSource?m._node.bufferSource.playbackRate.setValueAtTime(f,t.ctx.currentTime):m._node&&(m._node.playbackRate=f);var S=h.seek(p[x]),w=(h._sprite[m._sprite][0]+h._sprite[m._sprite][1])/1e3-S,A=w*1e3/Math.abs(m._rate);(h._endTimers[p[x]]||!m._paused)&&(h._clearTimer(p[x]),h._endTimers[p[x]]=setTimeout(h._ended.bind(h,m),A)),h._emit("rate",m._id)}}else return m=h._soundById(p),m?m._rate:h._rate;return h},seek:function(){var h=this,d=arguments,f,p;if(d.length===0)h._sounds.length&&(p=h._sounds[0]._id);else if(d.length===1){var _=h._getSoundIds(),g=_.indexOf(d[0]);g>=0?p=parseInt(d[0],10):h._sounds.length&&(p=h._sounds[0]._id,f=parseFloat(d[0]))}else d.length===2&&(f=parseFloat(d[0]),p=parseInt(d[1],10));if(typeof p>"u")return 0;if(typeof f=="number"&&(h._state!=="loaded"||h._playLock))return h._queue.push({event:"seek",action:function(){h.seek.apply(h,d)}}),h;var m=h._soundById(p);if(m)if(typeof f=="number"&&f>=0){var x=h.playing(p);x&&h.pause(p,!0),m._seek=f,m._ended=!1,h._clearTimer(p),!h._webAudio&&m._node&&!isNaN(m._node.duration)&&(m._node.currentTime=f);var S=function(){x&&h.play(p,!0),h._emit("seek",p)};if(x&&!h._webAudio){var w=function(){h._playLock?setTimeout(w,0):S()};setTimeout(w,0)}else S()}else if(h._webAudio){var A=h.playing(p)?t.ctx.currentTime-m._playStart:0,k=m._rateSeek?m._rateSeek-m._seek:0;return m._seek+(k+A*Math.abs(m._rate))}else return m._node.currentTime;return h},playing:function(h){var d=this;if(typeof h=="number"){var f=d._soundById(h);return f?!f._paused:!1}for(var p=0;p<d._sounds.length;p++)if(!d._sounds[p]._paused)return!0;return!1},duration:function(h){var d=this,f=d._duration,p=d._soundById(h);return p&&(f=d._sprite[p._sprite][1]/1e3),f},state:function(){return this._state},unload:function(){for(var h=this,d=h._sounds,f=0;f<d.length;f++)d[f]._paused||h.stop(d[f]._id),h._webAudio||(h._clearSound(d[f]._node),d[f]._node.removeEventListener("error",d[f]._errorFn,!1),d[f]._node.removeEventListener(t._canPlayEvent,d[f]._loadFn,!1),d[f]._node.removeEventListener("ended",d[f]._endFn,!1),t._releaseHtml5Audio(d[f]._node)),delete d[f]._node,h._clearTimer(d[f]._id);var p=t._howls.indexOf(h);p>=0&&t._howls.splice(p,1);var _=!0;for(f=0;f<t._howls.length;f++)if(t._howls[f]._src===h._src||h._src.indexOf(t._howls[f]._src)>=0){_=!1;break}return n&&_&&delete n[h._src],t.noAudio=!1,h._state="unloaded",h._sounds=[],h=null,null},on:function(h,d,f,p){var _=this,g=_["_on"+h];return typeof d=="function"&&g.push(p?{id:f,fn:d,once:p}:{id:f,fn:d}),_},off:function(h,d,f){var p=this,_=p["_on"+h],g=0;if(typeof d=="number"&&(f=d,d=null),d||f)for(g=0;g<_.length;g++){var m=f===_[g].id;if(d===_[g].fn&&m||!d&&m){_.splice(g,1);break}}else if(h)p["_on"+h]=[];else{var x=Object.keys(p);for(g=0;g<x.length;g++)x[g].indexOf("_on")===0&&Array.isArray(p[x[g]])&&(p[x[g]]=[])}return p},once:function(h,d,f){var p=this;return p.on(h,d,f,1),p},_emit:function(h,d,f){for(var p=this,_=p["_on"+h],g=_.length-1;g>=0;g--)(!_[g].id||_[g].id===d||h==="load")&&(setTimeout((function(m){m.call(this,d,f)}).bind(p,_[g].fn),0),_[g].once&&p.off(h,_[g].fn,_[g].id));return p._loadQueue(h),p},_loadQueue:function(h){var d=this;if(d._queue.length>0){var f=d._queue[0];f.event===h&&(d._queue.shift(),d._loadQueue()),h||f.action()}return d},_ended:function(h){var d=this,f=h._sprite;if(!d._webAudio&&h._node&&!h._node.paused&&!h._node.ended&&h._node.currentTime<h._stop)return setTimeout(d._ended.bind(d,h),100),d;var p=!!(h._loop||d._sprite[f][2]);if(d._emit("end",h._id),!d._webAudio&&p&&d.stop(h._id,!0).play(h._id),d._webAudio&&p){d._emit("play",h._id),h._seek=h._start||0,h._rateSeek=0,h._playStart=t.ctx.currentTime;var _=(h._stop-h._start)*1e3/Math.abs(h._rate);d._endTimers[h._id]=setTimeout(d._ended.bind(d,h),_)}return d._webAudio&&!p&&(h._paused=!0,h._ended=!0,h._seek=h._start||0,h._rateSeek=0,d._clearTimer(h._id),d._cleanBuffer(h._node),t._autoSuspend()),!d._webAudio&&!p&&d.stop(h._id,!0),d},_clearTimer:function(h){var d=this;if(d._endTimers[h]){if(typeof d._endTimers[h]!="function")clearTimeout(d._endTimers[h]);else{var f=d._soundById(h);f&&f._node&&f._node.removeEventListener("ended",d._endTimers[h],!1)}delete d._endTimers[h]}return d},_soundById:function(h){for(var d=this,f=0;f<d._sounds.length;f++)if(h===d._sounds[f]._id)return d._sounds[f];return null},_inactiveSound:function(){var h=this;h._drain();for(var d=0;d<h._sounds.length;d++)if(h._sounds[d]._ended)return h._sounds[d].reset();return new s(h)},_drain:function(){var h=this,d=h._pool,f=0,p=0;if(!(h._sounds.length<d)){for(p=0;p<h._sounds.length;p++)h._sounds[p]._ended&&f++;for(p=h._sounds.length-1;p>=0;p--){if(f<=d)return;h._sounds[p]._ended&&(h._webAudio&&h._sounds[p]._node&&h._sounds[p]._node.disconnect(0),h._sounds.splice(p,1),f--)}}},_getSoundIds:function(h){var d=this;if(typeof h>"u"){for(var f=[],p=0;p<d._sounds.length;p++)f.push(d._sounds[p]._id);return f}else return[h]},_refreshBuffer:function(h){var d=this;return h._node.bufferSource=t.ctx.createBufferSource(),h._node.bufferSource.buffer=n[d._src],h._panner?h._node.bufferSource.connect(h._panner):h._node.bufferSource.connect(h._node),h._node.bufferSource.loop=h._loop,h._loop&&(h._node.bufferSource.loopStart=h._start||0,h._node.bufferSource.loopEnd=h._stop||0),h._node.bufferSource.playbackRate.setValueAtTime(h._rate,t.ctx.currentTime),d},_cleanBuffer:function(h){var d=this,f=t._navigator&&t._navigator.vendor.indexOf("Apple")>=0;if(!h.bufferSource)return d;if(t._scratchBuffer&&h.bufferSource&&(h.bufferSource.onended=null,h.bufferSource.disconnect(0),f))try{h.bufferSource.buffer=t._scratchBuffer}catch{}return h.bufferSource=null,d},_clearSound:function(h){var d=/MSIE |Trident\//.test(t._navigator&&t._navigator.userAgent);d||(h.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var s=function(h){this._parent=h,this.init()};s.prototype={init:function(){var h=this,d=h._parent;return h._muted=d._muted,h._loop=d._loop,h._volume=d._volume,h._rate=d._rate,h._seek=0,h._paused=!0,h._ended=!0,h._sprite="__default",h._id=++t._counter,d._sounds.push(h),h.create(),h},create:function(){var h=this,d=h._parent,f=t._muted||h._muted||h._parent._muted?0:h._volume;return d._webAudio?(h._node=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),h._node.gain.setValueAtTime(f,t.ctx.currentTime),h._node.paused=!0,h._node.connect(t.masterGain)):t.noAudio||(h._node=t._obtainHtml5Audio(),h._errorFn=h._errorListener.bind(h),h._node.addEventListener("error",h._errorFn,!1),h._loadFn=h._loadListener.bind(h),h._node.addEventListener(t._canPlayEvent,h._loadFn,!1),h._endFn=h._endListener.bind(h),h._node.addEventListener("ended",h._endFn,!1),h._node.src=d._src,h._node.preload=d._preload===!0?"auto":d._preload,h._node.volume=f*t.volume(),h._node.load()),h},reset:function(){var h=this,d=h._parent;return h._muted=d._muted,h._loop=d._loop,h._volume=d._volume,h._rate=d._rate,h._seek=0,h._rateSeek=0,h._paused=!0,h._ended=!0,h._sprite="__default",h._id=++t._counter,h},_errorListener:function(){var h=this;h._parent._emit("loaderror",h._id,h._node.error?h._node.error.code:0),h._node.removeEventListener("error",h._errorFn,!1)},_loadListener:function(){var h=this,d=h._parent;d._duration=Math.ceil(h._node.duration*10)/10,Object.keys(d._sprite).length===0&&(d._sprite={__default:[0,d._duration*1e3]}),d._state!=="loaded"&&(d._state="loaded",d._emit("load"),d._loadQueue()),h._node.removeEventListener(t._canPlayEvent,h._loadFn,!1)},_endListener:function(){var h=this,d=h._parent;d._duration===1/0&&(d._duration=Math.ceil(h._node.duration*10)/10,d._sprite.__default[1]===1/0&&(d._sprite.__default[1]=d._duration*1e3),d._ended(h)),h._node.removeEventListener("ended",h._endFn,!1)}};var n={},a=function(h){var d=h._src;if(n[d]){h._duration=n[d].duration,c(h);return}if(/^data:[^;]+;base64,/.test(d)){for(var f=atob(d.split(",")[1]),p=new Uint8Array(f.length),_=0;_<f.length;++_)p[_]=f.charCodeAt(_);l(p.buffer,h)}else{var g=new XMLHttpRequest;g.open(h._xhr.method,d,!0),g.withCredentials=h._xhr.withCredentials,g.responseType="arraybuffer",h._xhr.headers&&Object.keys(h._xhr.headers).forEach(function(m){g.setRequestHeader(m,h._xhr.headers[m])}),g.onload=function(){var m=(g.status+"")[0];if(m!=="0"&&m!=="2"&&m!=="3"){h._emit("loaderror",null,"Failed loading audio file with status: "+g.status+".");return}l(g.response,h)},g.onerror=function(){h._webAudio&&(h._html5=!0,h._webAudio=!1,h._sounds=[],delete n[d],h.load())},o(g)}},o=function(h){try{h.send()}catch{h.onerror()}},l=function(h,d){var f=function(){d._emit("loaderror",null,"Decoding audio data failed.")},p=function(_){_&&d._sounds.length>0?(n[d._src]=_,c(d,_)):f()};typeof Promise<"u"&&t.ctx.decodeAudioData.length===1?t.ctx.decodeAudioData(h).then(p).catch(f):t.ctx.decodeAudioData(h,p,f)},c=function(h,d){d&&!h._duration&&(h._duration=d.duration),Object.keys(h._sprite).length===0&&(h._sprite={__default:[0,h._duration*1e3]}),h._state!=="loaded"&&(h._state="loaded",h._emit("load"),h._loadQueue())},u=function(){if(t.usingWebAudio){try{typeof AudioContext<"u"?t.ctx=new AudioContext:typeof webkitAudioContext<"u"?t.ctx=new webkitAudioContext:t.usingWebAudio=!1}catch{t.usingWebAudio=!1}t.ctx||(t.usingWebAudio=!1);var h=/iP(hone|od|ad)/.test(t._navigator&&t._navigator.platform),d=t._navigator&&t._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),f=d?parseInt(d[1],10):null;if(h&&f&&f<9){var p=/safari/.test(t._navigator&&t._navigator.userAgent.toLowerCase());t._navigator&&!p&&(t.usingWebAudio=!1)}t.usingWebAudio&&(t.masterGain=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),t.masterGain.gain.setValueAtTime(t._muted?0:t._volume,t.ctx.currentTime),t.masterGain.connect(t.ctx.destination)),t._setup()}};r.Howler=t,r.Howl=i,typeof ks<"u"?(ks.HowlerGlobal=e,ks.Howler=t,ks.Howl=i,ks.Sound=s):typeof window<"u"&&(window.HowlerGlobal=e,window.Howler=t,window.Howl=i,window.Sound=s)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var i=this;if(!i.ctx||!i.ctx.listener)return i;for(var s=i._howls.length-1;s>=0;s--)i._howls[s].stereo(t);return i},HowlerGlobal.prototype.pos=function(t,i,s){var n=this;if(!n.ctx||!n.ctx.listener)return n;if(i=typeof i!="number"?n._pos[1]:i,s=typeof s!="number"?n._pos[2]:s,typeof t=="number")n._pos=[t,i,s],typeof n.ctx.listener.positionX<"u"?(n.ctx.listener.positionX.setTargetAtTime(n._pos[0],Howler.ctx.currentTime,.1),n.ctx.listener.positionY.setTargetAtTime(n._pos[1],Howler.ctx.currentTime,.1),n.ctx.listener.positionZ.setTargetAtTime(n._pos[2],Howler.ctx.currentTime,.1)):n.ctx.listener.setPosition(n._pos[0],n._pos[1],n._pos[2]);else return n._pos;return n},HowlerGlobal.prototype.orientation=function(t,i,s,n,a,o){var l=this;if(!l.ctx||!l.ctx.listener)return l;var c=l._orientation;if(i=typeof i!="number"?c[1]:i,s=typeof s!="number"?c[2]:s,n=typeof n!="number"?c[3]:n,a=typeof a!="number"?c[4]:a,o=typeof o!="number"?c[5]:o,typeof t=="number")l._orientation=[t,i,s,n,a,o],typeof l.ctx.listener.forwardX<"u"?(l.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),l.ctx.listener.forwardY.setTargetAtTime(i,Howler.ctx.currentTime,.1),l.ctx.listener.forwardZ.setTargetAtTime(s,Howler.ctx.currentTime,.1),l.ctx.listener.upX.setTargetAtTime(n,Howler.ctx.currentTime,.1),l.ctx.listener.upY.setTargetAtTime(a,Howler.ctx.currentTime,.1),l.ctx.listener.upZ.setTargetAtTime(o,Howler.ctx.currentTime,.1)):l.ctx.listener.setOrientation(t,i,s,n,a,o);else return c;return l},Howl.prototype.init=function(t){return function(i){var s=this;return s._orientation=i.orientation||[1,0,0],s._stereo=i.stereo||null,s._pos=i.pos||null,s._pannerAttr={coneInnerAngle:typeof i.coneInnerAngle<"u"?i.coneInnerAngle:360,coneOuterAngle:typeof i.coneOuterAngle<"u"?i.coneOuterAngle:360,coneOuterGain:typeof i.coneOuterGain<"u"?i.coneOuterGain:0,distanceModel:typeof i.distanceModel<"u"?i.distanceModel:"inverse",maxDistance:typeof i.maxDistance<"u"?i.maxDistance:1e4,panningModel:typeof i.panningModel<"u"?i.panningModel:"HRTF",refDistance:typeof i.refDistance<"u"?i.refDistance:1,rolloffFactor:typeof i.rolloffFactor<"u"?i.rolloffFactor:1},s._onstereo=i.onstereo?[{fn:i.onstereo}]:[],s._onpos=i.onpos?[{fn:i.onpos}]:[],s._onorientation=i.onorientation?[{fn:i.onorientation}]:[],t.call(this,i)}}(Howl.prototype.init),Howl.prototype.stereo=function(t,i){var s=this;if(!s._webAudio)return s;if(s._state!=="loaded")return s._queue.push({event:"stereo",action:function(){s.stereo(t,i)}}),s;var n=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof i>"u")if(typeof t=="number")s._stereo=t,s._pos=[t,0,0];else return s._stereo;for(var a=s._getSoundIds(i),o=0;o<a.length;o++){var l=s._soundById(a[o]);if(l)if(typeof t=="number")l._stereo=t,l._pos=[t,0,0],l._node&&(l._pannerAttr.panningModel="equalpower",(!l._panner||!l._panner.pan)&&e(l,n),n==="spatial"?typeof l._panner.positionX<"u"?(l._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):l._panner.setPosition(t,0,0):l._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),s._emit("stereo",l._id);else return l._stereo}return s},Howl.prototype.pos=function(t,i,s,n){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"pos",action:function(){a.pos(t,i,s,n)}}),a;if(i=typeof i!="number"?0:i,s=typeof s!="number"?-.5:s,typeof n>"u")if(typeof t=="number")a._pos=[t,i,s];else return a._pos;for(var o=a._getSoundIds(n),l=0;l<o.length;l++){var c=a._soundById(o[l]);if(c)if(typeof t=="number")c._pos=[t,i,s],c._node&&((!c._panner||c._panner.pan)&&e(c,"spatial"),typeof c._panner.positionX<"u"?(c._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(i,Howler.ctx.currentTime),c._panner.positionZ.setValueAtTime(s,Howler.ctx.currentTime)):c._panner.setPosition(t,i,s)),a._emit("pos",c._id);else return c._pos}return a},Howl.prototype.orientation=function(t,i,s,n){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"orientation",action:function(){a.orientation(t,i,s,n)}}),a;if(i=typeof i!="number"?a._orientation[1]:i,s=typeof s!="number"?a._orientation[2]:s,typeof n>"u")if(typeof t=="number")a._orientation=[t,i,s];else return a._orientation;for(var o=a._getSoundIds(n),l=0;l<o.length;l++){var c=a._soundById(o[l]);if(c)if(typeof t=="number")c._orientation=[t,i,s],c._node&&(c._panner||(c._pos||(c._pos=a._pos||[0,0,-.5]),e(c,"spatial")),typeof c._panner.orientationX<"u"?(c._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),c._panner.orientationY.setValueAtTime(i,Howler.ctx.currentTime),c._panner.orientationZ.setValueAtTime(s,Howler.ctx.currentTime)):c._panner.setOrientation(t,i,s)),a._emit("orientation",c._id);else return c._orientation}return a},Howl.prototype.pannerAttr=function(){var t=this,i=arguments,s,n,a;if(!t._webAudio)return t;if(i.length===0)return t._pannerAttr;if(i.length===1)if(typeof i[0]=="object")s=i[0],typeof n>"u"&&(s.pannerAttr||(s.pannerAttr={coneInnerAngle:s.coneInnerAngle,coneOuterAngle:s.coneOuterAngle,coneOuterGain:s.coneOuterGain,distanceModel:s.distanceModel,maxDistance:s.maxDistance,refDistance:s.refDistance,rolloffFactor:s.rolloffFactor,panningModel:s.panningModel}),t._pannerAttr={coneInnerAngle:typeof s.pannerAttr.coneInnerAngle<"u"?s.pannerAttr.coneInnerAngle:t._coneInnerAngle,coneOuterAngle:typeof s.pannerAttr.coneOuterAngle<"u"?s.pannerAttr.coneOuterAngle:t._coneOuterAngle,coneOuterGain:typeof s.pannerAttr.coneOuterGain<"u"?s.pannerAttr.coneOuterGain:t._coneOuterGain,distanceModel:typeof s.pannerAttr.distanceModel<"u"?s.pannerAttr.distanceModel:t._distanceModel,maxDistance:typeof s.pannerAttr.maxDistance<"u"?s.pannerAttr.maxDistance:t._maxDistance,refDistance:typeof s.pannerAttr.refDistance<"u"?s.pannerAttr.refDistance:t._refDistance,rolloffFactor:typeof s.pannerAttr.rolloffFactor<"u"?s.pannerAttr.rolloffFactor:t._rolloffFactor,panningModel:typeof s.pannerAttr.panningModel<"u"?s.pannerAttr.panningModel:t._panningModel});else return a=t._soundById(parseInt(i[0],10)),a?a._pannerAttr:t._pannerAttr;else i.length===2&&(s=i[0],n=parseInt(i[1],10));for(var o=t._getSoundIds(n),l=0;l<o.length;l++)if(a=t._soundById(o[l]),a){var c=a._pannerAttr;c={coneInnerAngle:typeof s.coneInnerAngle<"u"?s.coneInnerAngle:c.coneInnerAngle,coneOuterAngle:typeof s.coneOuterAngle<"u"?s.coneOuterAngle:c.coneOuterAngle,coneOuterGain:typeof s.coneOuterGain<"u"?s.coneOuterGain:c.coneOuterGain,distanceModel:typeof s.distanceModel<"u"?s.distanceModel:c.distanceModel,maxDistance:typeof s.maxDistance<"u"?s.maxDistance:c.maxDistance,refDistance:typeof s.refDistance<"u"?s.refDistance:c.refDistance,rolloffFactor:typeof s.rolloffFactor<"u"?s.rolloffFactor:c.rolloffFactor,panningModel:typeof s.panningModel<"u"?s.panningModel:c.panningModel};var u=a._panner;u||(a._pos||(a._pos=t._pos||[0,0,-.5]),e(a,"spatial"),u=a._panner),u.coneInnerAngle=c.coneInnerAngle,u.coneOuterAngle=c.coneOuterAngle,u.coneOuterGain=c.coneOuterGain,u.distanceModel=c.distanceModel,u.maxDistance=c.maxDistance,u.refDistance=c.refDistance,u.rolloffFactor=c.rolloffFactor,u.panningModel=c.panningModel}return t},Sound.prototype.init=function(t){return function(){var i=this,s=i._parent;i._orientation=s._orientation,i._stereo=s._stereo,i._pos=s._pos,i._pannerAttr=s._pannerAttr,t.call(this),i._stereo?s.stereo(i._stereo):i._pos&&s.pos(i._pos[0],i._pos[1],i._pos[2],i._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var i=this,s=i._parent;return i._orientation=s._orientation,i._stereo=s._stereo,i._pos=s._pos,i._pannerAttr=s._pannerAttr,i._stereo?s.stereo(i._stereo):i._pos?s.pos(i._pos[0],i._pos[1],i._pos[2],i._id):i._panner&&(i._panner.disconnect(0),i._panner=void 0,s._refreshBuffer(i)),t.call(this)}}(Sound.prototype.reset);var e=function(t,i){i=i||"spatial",i==="spatial"?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,typeof t._panner.positionX<"u"?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),typeof t._panner.orientationX<"u"?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}})()})(vc);class Pg{constructor(e){this.resource=e,this.textureMap=new Map,this.textureMapRotated=new Map}getTexture(e){if(e.startsWith("//")){e.startsWith("//")&&(e=e.slice(2));const[t,i]=e.split("/"),s=this.resource[t];if(s instanceof ma)return s.textures[i];throw new Error(`Unregistered texture, ${e}`)}if(!this.resource.hasOwnProperty(e)||!(this.resource[e]instanceof q))throw console.error(`Unregistered texture, ${e}`),new Error(`Unregistered texture, ${e}`);return this.resource[e]}getTextureRotated(e,t){const i=[e,t];if(this.textureMapRotated.has(i))return this.textureMapRotated.get(i);const s=this.getTexture(e);if(!s)throw new Error(`Unregistered texture, ${i}`);const{frame:n,orig:a}=s,o=new q({source:s.source,frame:n,orig:a,rotate:t});return this.textureMapRotated.set(i,o),o}getTextures(e){return e.map(t=>this.getTexture(t))}}var Er=null;function ai(r){if(Er===null&&r!==void 0&&(Er=new Pg(r)),Er===null)throw new Error("PixiTextureFactory is null");return Er}var Q=(r=>(r.CREDIT_SOUND="01",r.START_MUSIC="02",r.EATING_COOKIE="03",r.EXTEND_SOUND="04",r.GHOST_NORMAL="05",r.GHOST_SPURT1="06",r.GHOST_SPURT2="07",r.GHOST_SPURT3="08",r.GHOST_SPURT4="09",r.EATING_FRUIT="10",r.GHOST_BLUE="11",r.EATING_GHOST="12",r.GHOST_GOING_HOME="13",r.MISS="14",r.COFFEE_BREAK_MUSIC="15",r.CHANGE_SPEED1="change_speed1",r.CHANGE_SPEED2="change_speed2",r.FRUIT_ALL_PRISE="Make12items",r))(Q||{});const Cr=[{alias:"01",src:"asset/PAC-MAN_SFX/NBGI-0001_01.mp3"},{alias:"02",src:"asset/PAC-MAN_SFX/NBGI-0001_02.mp3"},{alias:"03",src:"asset/PAC-MAN_SFX/NBGI-0001_03_part.mp3"},{alias:"04",src:"asset/PAC-MAN_SFX/NBGI-0001_04.mp3"},{alias:"05",src:"asset/PAC-MAN_SFX/NBGI-0001_05.mp3"},{alias:"06",src:"asset/PAC-MAN_SFX/NBGI-0001_06.mp3"},{alias:"07",src:"asset/PAC-MAN_SFX/NBGI-0001_07.mp3"},{alias:"08",src:"asset/PAC-MAN_SFX/NBGI-0001_08.mp3"},{alias:"09",src:"asset/PAC-MAN_SFX/NBGI-0001_09.mp3"},{alias:"10",src:"asset/PAC-MAN_SFX/NBGI-0001_10.mp3"},{alias:"11",src:"asset/PAC-MAN_SFX/NBGI-0001_11.mp3"},{alias:"12",src:"asset/PAC-MAN_SFX/NBGI-0001_12.mp3"},{alias:"13",src:"asset/PAC-MAN_SFX/NBGI-0001_13.mp3"},{alias:"14",src:"asset/PAC-MAN_SFX/NBGI-0001_14.mp3"},{alias:"15",src:"asset/PAC-MAN_SFX/NBGI-0001_15.mp3"},{alias:"change_speed1",src:"asset/PAC-MAN_SFX/Pac_VGM_Speed1.mp3"},{alias:"change_speed2",src:"asset/PAC-MAN_SFX/Pac_VGM_Speed2.mp3"},{alias:"Make12items",src:"asset/PAC-MAN_SFX/Pac_VGM_Make12.mp3"}],kg=["asset/assets3/game_Congratulations_ani.gif","asset/assets3/game_Congratulations_bg.png","asset/assets3/bg_speed.png","asset/assets3/bg_score.png","asset/assets3/game_screen.png","asset/assets3/gameover_bracket01.png","asset/assets3/gameover_bracket02.png","asset/assets3/gameover_ghost.png","asset/assets3/gameover_pacman.png","asset/assets3/gameover_screen.png","asset/assets3/info_btn_close.png","asset/assets3/info_dotline.png","asset/assets3/info_screen.png","asset/assets3/intro_screen.png","asset/assets3/score_ghost.png","asset/assets3/score_listbg.png","asset/assets3/score_screen.png","asset/assets3/skin_back_00black.png","asset/assets3/skin_back_01gray.png","asset/assets3/skin_back_02lightgray.png","asset/assets3/skin_back_03skyblue.png","asset/assets3/skin_back_04green.png","asset/assets3/skin_back_05yellow.png","asset/assets3/skin_back_06red.png","asset/assets3/skin_bg.png"];function Eg(){let r={};for(const e of kg)r[e]=e;return r}function Cg(r){Oi.load(["asset/atlas/loading.json","asset/loading/loading_pac.gif","asset/loading/loading_pac02.gif"]).then(()=>{r()})}function Mg(r){const e=Eg();e.game="asset/atlas/game.json",e.btn="asset/atlas/btn.json",e.speed="asset/atlas/speed.json",e.maze="asset/atlas/maze.json",e.maze_final="asset/atlas/maze_final.json",e.maze_doom="asset/atlas/maze_doom.json",e.maze_maniac="asset/atlas/maze_maniac.json",e.maze_1028="asset/atlas/maze_1028.json",Oi.addBundle("image",e),Oi.loadBundle("image",t=>{loadingState.onUpdateImageLoadingProgress(t)}).then(t=>{ai(t),Ig(()=>{r()})})}var zn=0,Ia={};function Ig(r){Cr.forEach(t=>{const i=new vc.Howl({src:[t.src],html5:!0,preload:!0,onload:()=>{},onloaderror:(s,n)=>{console.error(`HW, Error loading, alias: ${t.alias}`,n)}});Ia[t.alias]=i});const e=()=>{zn+=1,loadingState.onUpdateAudioLoadingProgress(zn/Cr.length),zn===Cr.length&&r()};Cr.forEach(t=>{Ia[t.alias].once("load",e)})}function Rg(){return Ia}var bc={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(r){(function(e,t,i,s){var n=["","webkit","Moz","MS","ms","o"],a=t.createElement("div"),o="function",l=Math.round,c=Math.abs,u=Date.now;function h(y,T,v){return setTimeout(S(y,v),T)}function d(y,T,v){return Array.isArray(y)?(f(y,v[T],v),!0):!1}function f(y,T,v){var C;if(y)if(y.forEach)y.forEach(T,v);else if(y.length!==s)for(C=0;C<y.length;)T.call(v,y[C],C,y),C++;else for(C in y)y.hasOwnProperty(C)&&T.call(v,y[C],C,y)}function p(y,T,v){var C="DEPRECATED METHOD: "+T+`
`+v+` AT 
`;return function(){var R=new Error("get-stack-trace"),B=R&&R.stack?R.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",J=e.console&&(e.console.warn||e.console.log);return J&&J.call(e.console,C,B),y.apply(this,arguments)}}var _;typeof Object.assign!="function"?_=function(T){if(T===s||T===null)throw new TypeError("Cannot convert undefined or null to object");for(var v=Object(T),C=1;C<arguments.length;C++){var R=arguments[C];if(R!==s&&R!==null)for(var B in R)R.hasOwnProperty(B)&&(v[B]=R[B])}return v}:_=Object.assign;var g=p(function(T,v,C){for(var R=Object.keys(v),B=0;B<R.length;)(!C||C&&T[R[B]]===s)&&(T[R[B]]=v[R[B]]),B++;return T},"extend","Use `assign`."),m=p(function(T,v){return g(T,v,!0)},"merge","Use `assign`.");function x(y,T,v){var C=T.prototype,R;R=y.prototype=Object.create(C),R.constructor=y,R._super=C,v&&_(R,v)}function S(y,T){return function(){return y.apply(T,arguments)}}function w(y,T){return typeof y==o?y.apply(T&&T[0]||s,T):y}function A(y,T){return y===s?T:y}function k(y,T,v){f(M(T),function(C){y.addEventListener(C,v,!1)})}function P(y,T,v){f(M(T),function(C){y.removeEventListener(C,v,!1)})}function E(y,T){for(;y;){if(y==T)return!0;y=y.parentNode}return!1}function b(y,T){return y.indexOf(T)>-1}function M(y){return y.trim().split(/\s+/g)}function N(y,T,v){if(y.indexOf&&!v)return y.indexOf(T);for(var C=0;C<y.length;){if(v&&y[C][v]==T||!v&&y[C]===T)return C;C++}return-1}function H(y){return Array.prototype.slice.call(y,0)}function L(y,T,v){for(var C=[],R=[],B=0;B<y.length;){var J=y[B][T];N(R,J)<0&&C.push(y[B]),R[B]=J,B++}return C=C.sort(function(Be,$e){return Be[T]>$e[T]}),C}function F(y,T){for(var v,C,R=T[0].toUpperCase()+T.slice(1),B=0;B<n.length;){if(v=n[B],C=v?v+R:T,C in y)return C;B++}return s}var G=1;function $(){return G++}function K(y){var T=y.ownerDocument||y;return T.defaultView||T.parentWindow||e}var Se=/mobile|tablet|ip(ad|hone|od)|android/i,U="ontouchstart"in e,Y=F(e,"PointerEvent")!==s,Te=U&&Se.test(navigator.userAgent),D="touch",at="pen",Pe="mouse",Ve="kinect",wi=25,Ce=1,gt=2,le=4,Ne=8,vi=1,It=2,Rt=4,$t=8,ot=16,Me=It|Rt,Xe=$t|ot,Lt=Me|Xe,or=["x","y"],bi=["clientX","clientY"];function Ke(y,T){var v=this;this.manager=y,this.callback=T,this.element=y.element,this.target=y.options.inputTarget,this.domHandler=function(C){w(y.options.enable,[y])&&v.handler(C)},this.init()}Ke.prototype={handler:function(){},init:function(){this.evEl&&k(this.element,this.evEl,this.domHandler),this.evTarget&&k(this.target,this.evTarget,this.domHandler),this.evWin&&k(K(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&P(this.element,this.evEl,this.domHandler),this.evTarget&&P(this.target,this.evTarget,this.domHandler),this.evWin&&P(K(this.element),this.evWin,this.domHandler)}};function Eo(y){var T,v=y.options.inputClass;return v?T=v:Y?T=pn:Te?T=cr:U?T=_n:T=lr,new T(y,Gu)}function Gu(y,T,v){var C=v.pointers.length,R=v.changedPointers.length,B=T&Ce&&C-R===0,J=T&(le|Ne)&&C-R===0;v.isFirst=!!B,v.isFinal=!!J,B&&(y.session={}),v.eventType=T,Du(y,v),y.emit("hammer.input",v),y.recognize(v),y.session.prevInput=v}function Du(y,T){var v=y.session,C=T.pointers,R=C.length;v.firstInput||(v.firstInput=Co(T)),R>1&&!v.firstMultiple?v.firstMultiple=Co(T):R===1&&(v.firstMultiple=!1);var B=v.firstInput,J=v.firstMultiple,Ie=J?J.center:B.center,Be=T.center=Mo(C);T.timeStamp=u(),T.deltaTime=T.timeStamp-B.timeStamp,T.angle=fn(Ie,Be),T.distance=hr(Ie,Be),Hu(v,T),T.offsetDirection=Ro(T.deltaX,T.deltaY);var $e=Io(T.deltaTime,T.deltaX,T.deltaY);T.overallVelocityX=$e.x,T.overallVelocityY=$e.y,T.overallVelocity=c($e.x)>c($e.y)?$e.x:$e.y,T.scale=J?Wu(J.pointers,C):1,T.rotation=J?zu(J.pointers,C):0,T.maxPointers=v.prevInput?T.pointers.length>v.prevInput.maxPointers?T.pointers.length:v.prevInput.maxPointers:T.pointers.length,Uu(v,T);var Ot=y.element;E(T.srcEvent.target,Ot)&&(Ot=T.srcEvent.target),T.target=Ot}function Hu(y,T){var v=T.center,C=y.offsetDelta||{},R=y.prevDelta||{},B=y.prevInput||{};(T.eventType===Ce||B.eventType===le)&&(R=y.prevDelta={x:B.deltaX||0,y:B.deltaY||0},C=y.offsetDelta={x:v.x,y:v.y}),T.deltaX=R.x+(v.x-C.x),T.deltaY=R.y+(v.y-C.y)}function Uu(y,T){var v=y.lastInterval||T,C=T.timeStamp-v.timeStamp,R,B,J,Ie;if(T.eventType!=Ne&&(C>wi||v.velocity===s)){var Be=T.deltaX-v.deltaX,$e=T.deltaY-v.deltaY,Ot=Io(C,Be,$e);B=Ot.x,J=Ot.y,R=c(Ot.x)>c(Ot.y)?Ot.x:Ot.y,Ie=Ro(Be,$e),y.lastInterval=T}else R=v.velocity,B=v.velocityX,J=v.velocityY,Ie=v.direction;T.velocity=R,T.velocityX=B,T.velocityY=J,T.direction=Ie}function Co(y){for(var T=[],v=0;v<y.pointers.length;)T[v]={clientX:l(y.pointers[v].clientX),clientY:l(y.pointers[v].clientY)},v++;return{timeStamp:u(),pointers:T,center:Mo(T),deltaX:y.deltaX,deltaY:y.deltaY}}function Mo(y){var T=y.length;if(T===1)return{x:l(y[0].clientX),y:l(y[0].clientY)};for(var v=0,C=0,R=0;R<T;)v+=y[R].clientX,C+=y[R].clientY,R++;return{x:l(v/T),y:l(C/T)}}function Io(y,T,v){return{x:T/y||0,y:v/y||0}}function Ro(y,T){return y===T?vi:c(y)>=c(T)?y<0?It:Rt:T<0?$t:ot}function hr(y,T,v){v||(v=or);var C=T[v[0]]-y[v[0]],R=T[v[1]]-y[v[1]];return Math.sqrt(C*C+R*R)}function fn(y,T,v){v||(v=or);var C=T[v[0]]-y[v[0]],R=T[v[1]]-y[v[1]];return Math.atan2(R,C)*180/Math.PI}function zu(y,T){return fn(T[1],T[0],bi)+fn(y[1],y[0],bi)}function Wu(y,T){return hr(T[0],T[1],bi)/hr(y[0],y[1],bi)}var Yu={mousedown:Ce,mousemove:gt,mouseup:le},Vu="mousedown",Xu="mousemove mouseup";function lr(){this.evEl=Vu,this.evWin=Xu,this.pressed=!1,Ke.apply(this,arguments)}x(lr,Ke,{handler:function(T){var v=Yu[T.type];v&Ce&&T.button===0&&(this.pressed=!0),v&gt&&T.which!==1&&(v=le),this.pressed&&(v&le&&(this.pressed=!1),this.callback(this.manager,v,{pointers:[T],changedPointers:[T],pointerType:Pe,srcEvent:T}))}});var $u={pointerdown:Ce,pointermove:gt,pointerup:le,pointercancel:Ne,pointerout:Ne},ju={2:D,3:at,4:Pe,5:Ve},Lo="pointerdown",Fo="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(Lo="MSPointerDown",Fo="MSPointerMove MSPointerUp MSPointerCancel");function pn(){this.evEl=Lo,this.evWin=Fo,Ke.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}x(pn,Ke,{handler:function(T){var v=this.store,C=!1,R=T.type.toLowerCase().replace("ms",""),B=$u[R],J=ju[T.pointerType]||T.pointerType,Ie=J==D,Be=N(v,T.pointerId,"pointerId");B&Ce&&(T.button===0||Ie)?Be<0&&(v.push(T),Be=v.length-1):B&(le|Ne)&&(C=!0),!(Be<0)&&(v[Be]=T,this.callback(this.manager,B,{pointers:v,changedPointers:[T],pointerType:J,srcEvent:T}),C&&v.splice(Be,1))}});var qu={touchstart:Ce,touchmove:gt,touchend:le,touchcancel:Ne},Ku="touchstart",Zu="touchstart touchmove touchend touchcancel";function Oo(){this.evTarget=Ku,this.evWin=Zu,this.started=!1,Ke.apply(this,arguments)}x(Oo,Ke,{handler:function(T){var v=qu[T.type];if(v===Ce&&(this.started=!0),!!this.started){var C=Qu.call(this,T,v);v&(le|Ne)&&C[0].length-C[1].length===0&&(this.started=!1),this.callback(this.manager,v,{pointers:C[0],changedPointers:C[1],pointerType:D,srcEvent:T})}}});function Qu(y,T){var v=H(y.touches),C=H(y.changedTouches);return T&(le|Ne)&&(v=L(v.concat(C),"identifier")),[v,C]}var Ju={touchstart:Ce,touchmove:gt,touchend:le,touchcancel:Ne},ed="touchstart touchmove touchend touchcancel";function cr(){this.evTarget=ed,this.targetIds={},Ke.apply(this,arguments)}x(cr,Ke,{handler:function(T){var v=Ju[T.type],C=td.call(this,T,v);C&&this.callback(this.manager,v,{pointers:C[0],changedPointers:C[1],pointerType:D,srcEvent:T})}});function td(y,T){var v=H(y.touches),C=this.targetIds;if(T&(Ce|gt)&&v.length===1)return C[v[0].identifier]=!0,[v,v];var R,B,J=H(y.changedTouches),Ie=[],Be=this.target;if(B=v.filter(function($e){return E($e.target,Be)}),T===Ce)for(R=0;R<B.length;)C[B[R].identifier]=!0,R++;for(R=0;R<J.length;)C[J[R].identifier]&&Ie.push(J[R]),T&(le|Ne)&&delete C[J[R].identifier],R++;if(Ie.length)return[L(B.concat(Ie),"identifier"),Ie]}var id=2500,No=25;function _n(){Ke.apply(this,arguments);var y=S(this.handler,this);this.touch=new cr(this.manager,y),this.mouse=new lr(this.manager,y),this.primaryTouch=null,this.lastTouches=[]}x(_n,Ke,{handler:function(T,v,C){var R=C.pointerType==D,B=C.pointerType==Pe;if(!(B&&C.sourceCapabilities&&C.sourceCapabilities.firesTouchEvents)){if(R)sd.call(this,v,C);else if(B&&rd.call(this,C))return;this.callback(T,v,C)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function sd(y,T){y&Ce?(this.primaryTouch=T.changedPointers[0].identifier,Bo.call(this,T)):y&(le|Ne)&&Bo.call(this,T)}function Bo(y){var T=y.changedPointers[0];if(T.identifier===this.primaryTouch){var v={x:T.clientX,y:T.clientY};this.lastTouches.push(v);var C=this.lastTouches,R=function(){var B=C.indexOf(v);B>-1&&C.splice(B,1)};setTimeout(R,id)}}function rd(y){for(var T=y.srcEvent.clientX,v=y.srcEvent.clientY,C=0;C<this.lastTouches.length;C++){var R=this.lastTouches[C],B=Math.abs(T-R.x),J=Math.abs(v-R.y);if(B<=No&&J<=No)return!0}return!1}var Go=F(a.style,"touchAction"),Do=Go!==s,Ho="compute",Uo="auto",gn="manipulation",Ai="none",bs="pan-x",As="pan-y",ur=ad();function mn(y,T){this.manager=y,this.set(T)}mn.prototype={set:function(y){y==Ho&&(y=this.compute()),Do&&this.manager.element.style&&ur[y]&&(this.manager.element.style[Go]=y),this.actions=y.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var y=[];return f(this.manager.recognizers,function(T){w(T.options.enable,[T])&&(y=y.concat(T.getTouchAction()))}),nd(y.join(" "))},preventDefaults:function(y){var T=y.srcEvent,v=y.offsetDirection;if(this.manager.session.prevented){T.preventDefault();return}var C=this.actions,R=b(C,Ai)&&!ur[Ai],B=b(C,As)&&!ur[As],J=b(C,bs)&&!ur[bs];if(R){var Ie=y.pointers.length===1,Be=y.distance<2,$e=y.deltaTime<250;if(Ie&&Be&&$e)return}if(!(J&&B)&&(R||B&&v&Me||J&&v&Xe))return this.preventSrc(T)},preventSrc:function(y){this.manager.session.prevented=!0,y.preventDefault()}};function nd(y){if(b(y,Ai))return Ai;var T=b(y,bs),v=b(y,As);return T&&v?Ai:T||v?T?bs:As:b(y,gn)?gn:Uo}function ad(){if(!Do)return!1;var y={},T=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(v){y[v]=T?e.CSS.supports("touch-action",v):!0}),y}var dr=1,mt=2,$i=4,ci=8,jt=ci,Ps=16,Ft=32;function qt(y){this.options=_({},this.defaults,y||{}),this.id=$(),this.manager=null,this.options.enable=A(this.options.enable,!0),this.state=dr,this.simultaneous={},this.requireFail=[]}qt.prototype={defaults:{},set:function(y){return _(this.options,y),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(y){if(d(y,"recognizeWith",this))return this;var T=this.simultaneous;return y=fr(y,this),T[y.id]||(T[y.id]=y,y.recognizeWith(this)),this},dropRecognizeWith:function(y){return d(y,"dropRecognizeWith",this)?this:(y=fr(y,this),delete this.simultaneous[y.id],this)},requireFailure:function(y){if(d(y,"requireFailure",this))return this;var T=this.requireFail;return y=fr(y,this),N(T,y)===-1&&(T.push(y),y.requireFailure(this)),this},dropRequireFailure:function(y){if(d(y,"dropRequireFailure",this))return this;y=fr(y,this);var T=N(this.requireFail,y);return T>-1&&this.requireFail.splice(T,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(y){return!!this.simultaneous[y.id]},emit:function(y){var T=this,v=this.state;function C(R){T.manager.emit(R,y)}v<ci&&C(T.options.event+zo(v)),C(T.options.event),y.additionalEvent&&C(y.additionalEvent),v>=ci&&C(T.options.event+zo(v))},tryEmit:function(y){if(this.canEmit())return this.emit(y);this.state=Ft},canEmit:function(){for(var y=0;y<this.requireFail.length;){if(!(this.requireFail[y].state&(Ft|dr)))return!1;y++}return!0},recognize:function(y){var T=_({},y);if(!w(this.options.enable,[this,T])){this.reset(),this.state=Ft;return}this.state&(jt|Ps|Ft)&&(this.state=dr),this.state=this.process(T),this.state&(mt|$i|ci|Ps)&&this.tryEmit(T)},process:function(y){},getTouchAction:function(){},reset:function(){}};function zo(y){return y&Ps?"cancel":y&ci?"end":y&$i?"move":y&mt?"start":""}function Wo(y){return y==ot?"down":y==$t?"up":y==It?"left":y==Rt?"right":""}function fr(y,T){var v=T.manager;return v?v.get(y):y}function At(){qt.apply(this,arguments)}x(At,qt,{defaults:{pointers:1},attrTest:function(y){var T=this.options.pointers;return T===0||y.pointers.length===T},process:function(y){var T=this.state,v=y.eventType,C=T&(mt|$i),R=this.attrTest(y);return C&&(v&Ne||!R)?T|Ps:C||R?v&le?T|ci:T&mt?T|$i:mt:Ft}});function pr(){At.apply(this,arguments),this.pX=null,this.pY=null}x(pr,At,{defaults:{event:"pan",threshold:10,pointers:1,direction:Lt},getTouchAction:function(){var y=this.options.direction,T=[];return y&Me&&T.push(As),y&Xe&&T.push(bs),T},directionTest:function(y){var T=this.options,v=!0,C=y.distance,R=y.direction,B=y.deltaX,J=y.deltaY;return R&T.direction||(T.direction&Me?(R=B===0?vi:B<0?It:Rt,v=B!=this.pX,C=Math.abs(y.deltaX)):(R=J===0?vi:J<0?$t:ot,v=J!=this.pY,C=Math.abs(y.deltaY))),y.direction=R,v&&C>T.threshold&&R&T.direction},attrTest:function(y){return At.prototype.attrTest.call(this,y)&&(this.state&mt||!(this.state&mt)&&this.directionTest(y))},emit:function(y){this.pX=y.deltaX,this.pY=y.deltaY;var T=Wo(y.direction);T&&(y.additionalEvent=this.options.event+T),this._super.emit.call(this,y)}});function xn(){At.apply(this,arguments)}x(xn,At,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ai]},attrTest:function(y){return this._super.attrTest.call(this,y)&&(Math.abs(y.scale-1)>this.options.threshold||this.state&mt)},emit:function(y){if(y.scale!==1){var T=y.scale<1?"in":"out";y.additionalEvent=this.options.event+T}this._super.emit.call(this,y)}});function yn(){qt.apply(this,arguments),this._timer=null,this._input=null}x(yn,qt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Uo]},process:function(y){var T=this.options,v=y.pointers.length===T.pointers,C=y.distance<T.threshold,R=y.deltaTime>T.time;if(this._input=y,!C||!v||y.eventType&(le|Ne)&&!R)this.reset();else if(y.eventType&Ce)this.reset(),this._timer=h(function(){this.state=jt,this.tryEmit()},T.time,this);else if(y.eventType&le)return jt;return Ft},reset:function(){clearTimeout(this._timer)},emit:function(y){this.state===jt&&(y&&y.eventType&le?this.manager.emit(this.options.event+"up",y):(this._input.timeStamp=u(),this.manager.emit(this.options.event,this._input)))}});function Sn(){At.apply(this,arguments)}x(Sn,At,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ai]},attrTest:function(y){return this._super.attrTest.call(this,y)&&(Math.abs(y.rotation)>this.options.threshold||this.state&mt)}});function Tn(){At.apply(this,arguments)}x(Tn,At,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Me|Xe,pointers:1},getTouchAction:function(){return pr.prototype.getTouchAction.call(this)},attrTest:function(y){var T=this.options.direction,v;return T&(Me|Xe)?v=y.overallVelocity:T&Me?v=y.overallVelocityX:T&Xe&&(v=y.overallVelocityY),this._super.attrTest.call(this,y)&&T&y.offsetDirection&&y.distance>this.options.threshold&&y.maxPointers==this.options.pointers&&c(v)>this.options.velocity&&y.eventType&le},emit:function(y){var T=Wo(y.offsetDirection);T&&this.manager.emit(this.options.event+T,y),this.manager.emit(this.options.event,y)}});function _r(){qt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}x(_r,qt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[gn]},process:function(y){var T=this.options,v=y.pointers.length===T.pointers,C=y.distance<T.threshold,R=y.deltaTime<T.time;if(this.reset(),y.eventType&Ce&&this.count===0)return this.failTimeout();if(C&&R&&v){if(y.eventType!=le)return this.failTimeout();var B=this.pTime?y.timeStamp-this.pTime<T.interval:!0,J=!this.pCenter||hr(this.pCenter,y.center)<T.posThreshold;this.pTime=y.timeStamp,this.pCenter=y.center,!J||!B?this.count=1:this.count+=1,this._input=y;var Ie=this.count%T.taps;if(Ie===0)return this.hasRequireFailures()?(this._timer=h(function(){this.state=jt,this.tryEmit()},T.interval,this),mt):jt}return Ft},failTimeout:function(){return this._timer=h(function(){this.state=Ft},this.options.interval,this),Ft},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==jt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function ui(y,T){return T=T||{},T.recognizers=A(T.recognizers,ui.defaults.preset),new wn(y,T)}ui.VERSION="2.0.7",ui.defaults={domEvents:!1,touchAction:Ho,enable:!0,inputTarget:null,inputClass:null,preset:[[Sn,{enable:!1}],[xn,{enable:!1},["rotate"]],[Tn,{direction:Me}],[pr,{direction:Me},["swipe"]],[_r],[_r,{event:"doubletap",taps:2},["tap"]],[yn]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var od=1,Yo=2;function wn(y,T){this.options=_({},ui.defaults,T||{}),this.options.inputTarget=this.options.inputTarget||y,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=y,this.input=Eo(this),this.touchAction=new mn(this,this.options.touchAction),Vo(this,!0),f(this.options.recognizers,function(v){var C=this.add(new v[0](v[1]));v[2]&&C.recognizeWith(v[2]),v[3]&&C.requireFailure(v[3])},this)}wn.prototype={set:function(y){return _(this.options,y),y.touchAction&&this.touchAction.update(),y.inputTarget&&(this.input.destroy(),this.input.target=y.inputTarget,this.input.init()),this},stop:function(y){this.session.stopped=y?Yo:od},recognize:function(y){var T=this.session;if(!T.stopped){this.touchAction.preventDefaults(y);var v,C=this.recognizers,R=T.curRecognizer;(!R||R&&R.state&jt)&&(R=T.curRecognizer=null);for(var B=0;B<C.length;)v=C[B],T.stopped!==Yo&&(!R||v==R||v.canRecognizeWith(R))?v.recognize(y):v.reset(),!R&&v.state&(mt|$i|ci)&&(R=T.curRecognizer=v),B++}},get:function(y){if(y instanceof qt)return y;for(var T=this.recognizers,v=0;v<T.length;v++)if(T[v].options.event==y)return T[v];return null},add:function(y){if(d(y,"add",this))return this;var T=this.get(y.options.event);return T&&this.remove(T),this.recognizers.push(y),y.manager=this,this.touchAction.update(),y},remove:function(y){if(d(y,"remove",this))return this;if(y=this.get(y),y){var T=this.recognizers,v=N(T,y);v!==-1&&(T.splice(v,1),this.touchAction.update())}return this},on:function(y,T){if(y!==s&&T!==s){var v=this.handlers;return f(M(y),function(C){v[C]=v[C]||[],v[C].push(T)}),this}},off:function(y,T){if(y!==s){var v=this.handlers;return f(M(y),function(C){T?v[C]&&v[C].splice(N(v[C],T),1):delete v[C]}),this}},emit:function(y,T){this.options.domEvents&&hd(y,T);var v=this.handlers[y]&&this.handlers[y].slice();if(!(!v||!v.length)){T.type=y,T.preventDefault=function(){T.srcEvent.preventDefault()};for(var C=0;C<v.length;)v[C](T),C++}},destroy:function(){this.element&&Vo(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Vo(y,T){var v=y.element;if(v.style){var C;f(y.options.cssProps,function(R,B){C=F(v.style,B),T?(y.oldCssProps[C]=v.style[C],v.style[C]=R):v.style[C]=y.oldCssProps[C]||""}),T||(y.oldCssProps={})}}function hd(y,T){var v=t.createEvent("Event");v.initEvent(y,!0,!0),v.gesture=T,T.target.dispatchEvent(v)}_(ui,{INPUT_START:Ce,INPUT_MOVE:gt,INPUT_END:le,INPUT_CANCEL:Ne,STATE_POSSIBLE:dr,STATE_BEGAN:mt,STATE_CHANGED:$i,STATE_ENDED:ci,STATE_RECOGNIZED:jt,STATE_CANCELLED:Ps,STATE_FAILED:Ft,DIRECTION_NONE:vi,DIRECTION_LEFT:It,DIRECTION_RIGHT:Rt,DIRECTION_UP:$t,DIRECTION_DOWN:ot,DIRECTION_HORIZONTAL:Me,DIRECTION_VERTICAL:Xe,DIRECTION_ALL:Lt,Manager:wn,Input:Ke,TouchAction:mn,TouchInput:cr,MouseInput:lr,PointerEventInput:pn,TouchMouseInput:_n,SingleTouchInput:Oo,Recognizer:qt,AttrRecognizer:At,Tap:_r,Pan:pr,Swipe:Tn,Pinch:xn,Rotate:Sn,Press:yn,on:k,off:P,each:f,merge:m,extend:g,assign:_,inherit:x,bindFn:S,prefixed:F});var ld=typeof e<"u"?e:typeof self<"u"?self:{};ld.Hammer=ui,r.exports?r.exports=ui:e[i]=ui})(window,document,"Hammer")})(bc);var Lg=bc.exports;const Ki=rr(Lg);class Ac{constructor(){this.listeners={}}add(e,t,i){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push({isActive:i,callback:t})}exec(e,t){const i=this.listeners[e];if(i){for(const s of i)if((!s.isActive||s.isActive())&&(t.preventDefault(),s.callback()))break}}}const Pc=new Ac,kc=new Ac;function oi(r,e,t){Pc.add(r,e,t)}function on(r,e,t){kc.add(r,e,t)}const Ra={};window.addEventListener("keydown",r=>{const e=r.keyCode;Ra[e]||(Ra[e]=!0,Pc.exec(e,r))});window.addEventListener("keyup",r=>{const e=r.keyCode;Ra[e]=!1,kc.exec(e,r)});const Ec=37,Cc=39,Mc=38,Ic=40,Fg=13,Og=80,Ng=82,Bg=77,Gg=85;function bt(){return state===newGameState||state===playState||state===readyNewState||state===readyRestartState}function Dg(r){console.log("installPauseKeyForDebug called"),oi(Og,()=>(r(),!0),()=>bt()||state===introState)}function Hg(r){console.log("installResumeKeyForDebug called"),oi(Ng,()=>(r(),!0),()=>bt()||state===introState)}function Ug(r){console.log("installMuteKeyForDebug called"),oi(Bg,()=>(r(),!0),bt)}function zg(r){console.log("installUnMuteKeyForDebug called"),oi(Gg,()=>(r(),!0),bt)}oi(Ec,()=>(pacman.setInputDir(DIR_LEFT),!0),bt);oi(Cc,()=>(pacman.setInputDir(DIR_RIGHT),!0),bt);oi(Mc,()=>(pacman.setInputDir(DIR_UP),!0),bt);oi(Ic,()=>(pacman.setInputDir(DIR_DOWN),!0),bt);oi(Fg,()=>("onEnterKeyPressed"in state&&typeof state.onEnterKeyPressed=="function"&&state.onEnterKeyPressed(),!0),()=>!0);on(Ec,()=>RF_INPUT_QUEUE?!1:(pacman.clearInputDir(DIR_LEFT),!0),bt);on(Cc,()=>RF_INPUT_QUEUE?!1:(pacman.clearInputDir(DIR_RIGHT),!0),bt);on(Mc,()=>RF_INPUT_QUEUE?!1:(pacman.clearInputDir(DIR_UP),!0),bt);on(Ic,()=>RF_INPUT_QUEUE?!1:(pacman.clearInputDir(DIR_DOWN),!0),bt);class Wg{constructor(){this.hammer=new Ki(PIXI_RENDERER.app.canvas),this.hammer.get("swipe").set({direction:Ki.DIRECTION_ALL}),this.hammer.on("swipe",e=>{switch(e.direction){case Ki.DIRECTION_UP:this.onDirectionUp();break;case Ki.DIRECTION_DOWN:this.onDirectionDown();break;case Ki.DIRECTION_LEFT:this.onDirectionLeft();break;case Ki.DIRECTION_RIGHT:this.onDirectionRight();break}})}onDirectionUp(){pacman.setInputDir(DIR_UP)}onDirectionDown(){pacman.setInputDir(DIR_DOWN)}onDirectionLeft(){pacman.setInputDir(DIR_LEFT)}onDirectionRight(){pacman.setInputDir(DIR_RIGHT)}}function Yg(){new Wg}class Vg{constructor(e){if(this.audioEnabled=!1,this.loadedResource=e,this.resourcePaused=null,this.configureSoundLibrary(),ytgame!=null&&ytgame.IN_PLAYABLES_ENV)ytgame.system.onAudioEnabledChange(t=>{console.log(`YT, onAudioEnabledChange, ${t}/${this.audioEnabled}`),this.setSoundState(t)}),this.syncYtSoundState();else{console.log("NON-YT, audioEnnabled"),this.audioEnabled=!0;const t=()=>{document.visibilityState==="visible"?this.resume():this.pause()};document.addEventListener("visibilitychange",t)}RF_DEBUG_CONFIG_KEYS&&(zg(()=>{console.log(`DEBUG, onAudioEnabledChange, true/${this.audioEnabled}`),this.setSoundState(!0)}),Ug(()=>{console.log(`DEBUG, onAudioEnabledChange, false/${this.audioEnabled}`),this.setSoundState(!1)}))}configureSoundLibrary(){Howler.autoUnlock=!1}syncYtSoundState(){const e=ytgame.system.isAudioEnabled();console.log("YT, syncYtSoundState, isAudioEnabled, enabled:",this.audioEnabled),this.setSoundState(e)}setSoundState(e){console.log(`PixiSound, setSoundState, ${e}/${this.audioEnabled}`),e?(Howler.mute(!1),console.log("PixiSound, UNMUTED")):(Howler.mute(!0),console.log("PixiSound, MUTED")),this.audioEnabled=e}pause(){console.log("PixiSound.pause, enabled:",this.audioEnabled);const e=new Map;Object.keys(this.loadedResource).forEach(t=>{const i=this.loadedResource[t];i.playing()&&e.set(t,i),i.pause(),console.log(` , ${i}`)}),this.resourcePaused=e}resume(){var e;console.log("PixiSound.resume, enabled:",this.audioEnabled),Howler.ctx&&Howler.ctx.state==="suspended"&&Howler.ctx.resume().then(()=>{console.log("Audio context resumed")}),(e=this.resourcePaused)==null||e.forEach((t,i)=>{t.play()})}stop(e){const t=this.loadedResource[e];if(t===void 0){console.error(`PixiSound key not found: ${e}`);return}t.stop()}play(e,t){const i=this.loadedResource[e];if(i===void 0){console.error(`PixiSound key not found: ${e}`);return}i.loop(t),i.play()}}let Wn=null;function ie(){if(Wn===null){const r=Rg();if(r===void 0)throw new Error("need sound resource to enPixiSound");Wn=new Vg(r)}return Wn}var xe=(r=>(r[r.BLACK=0]="BLACK",r[r.GRAY=1]="GRAY",r[r.LIGHT_GRAY=2]="LIGHT_GRAY",r[r.SKY_BLUE=3]="SKY_BLUE",r[r.GREEN=4]="GREEN",r[r.YELLOW=5]="YELLOW",r[r.RED=6]="RED",r))(xe||{});class Xg{constructor(){this.selectedSkin=5,this.showSkinMenu=!1}setSelectedSkin(e){e!==null&&(this.selectedSkin=e)}hide(){this.showSkinMenu=!1}}var V=(r=>(r.CHERRY="cherry",r.STRAWBERRY="strawberry",r.ORANGE="orange",r.APPLE="apple",r.MELON="melon",r.EGGPLANT="eggplant",r.BANANA="banana",r.DONUT="donut",r.GALAXIAN="galaxian",r.BELL="bell",r.KEY="key",r.FOX="fox",r.PACMAN="pacman",r))(V||{}),lt=(r=>(r[r.CHERRY=1]="CHERRY",r[r.STRAWBERRY=2]="STRAWBERRY",r[r.ORANGE=4]="ORANGE",r[r.APPLE=8]="APPLE",r[r.MELON=16]="MELON",r[r.EGGPLANT=32]="EGGPLANT",r[r.BANANA=64]="BANANA",r[r.DONUT=128]="DONUT",r[r.GALAXIAN=256]="GALAXIAN",r[r.BELL=512]="BELL",r[r.KEY=1024]="KEY",r[r.FOX=2048]="FOX",r))(lt||{});const $g=2048*2-1;class jg{constructor(){this.visible=!1,this.x=0,this.y=0,this.name="cherry",this.eatenFruits=[],this.eatenFruitsDirty=!0,this.receivedAllFruitsEatenPrise=!1}update(e,t,i){this.visible=!0,this.x=e,this.y=t,this.name=i}hide(){this.visible=!1}incrCounter(e){this.eatenFruits.push(e),this.eatenFruitsDirty=!0}resetCounter(){this.eatenFruits=[],this.eatenFruitsDirty=!0,this.receivedAllFruitsEatenPrise=!1}checkAllEaten(){return this.toBitFlags()===$g}toBitFlags(){let e=0;for(const t of this.eatenFruits)switch(t){case"cherry":e|=1;break;case"strawberry":e|=2;break;case"orange":e|=4;break;case"apple":e|=8;break;case"melon":e|=16;break;case"eggplant":e|=32;break;case"banana":e|=64;break;case"donut":e|=128;break;case"galaxian":e|=256;break;case"bell":e|=512;break;case"key":e|=1024;break;case"fox":e|=2048;break;default:t!=="pacman"&&console.error(`toBitFlags failed, unknown fruit-name: ${t}`)}return e}}class qg{constructor(){this.x=0,this.y=0,this.dirEnum=0,this.frame=0}}class Kg{constructor(){this.visible=!1,this.score=0,this.savedAt=null}init(){this.visible=!1,this.score=0}setScore(e){this.score=e,this.visible=!0}hide(){this.visible=!1}}globalThis.MAP_PACMAN_PIXI="                                                                                    Dd..............................oXX.XXX..XXX.XXo.................................................................  .     .  .          .          .          . <> .     .        .      .            .      .        .     .  .          .          .          .  .     .  .....................................o.........  .........or......LR......l......................................................                                                        ";class je{constructor(e,t){this.layer=new de,e.addChild(this.layer);const i=ai();this.texture_ddr=i.getTexture(`${t}_out_coner.png`),this.texture_ddl=i.getTextureRotated(`${t}_out_coner.png`,I.MIRROR_HORIZONTAL),this.texture_dur=i.getTextureRotated(`${t}_out_coner.png`,I.S),this.texture_dul=i.getTextureRotated(`${t}_out_coner.png`,I.W),this.texture_cD=i.getTexture(`${t}_out_middle_A.png`),this.texture_cd=i.getTexture(`${t}_out_middle_B.png`),this.texture_cR=i.getTextureRotated(`${t}_out_middle_A.png`,I.S),this.texture_cr=i.getTextureRotated(`${t}_out_middle_B.png`,I.S),this.texture_cU=i.getTextureRotated(`${t}_out_middle_A.png`,I.W),this.texture_cu=i.getTextureRotated(`${t}_out_middle_B.png`,I.W),this.texture_cL=i.getTextureRotated(`${t}_out_middle_A.png`,I.N),this.texture_cl=i.getTextureRotated(`${t}_out_middle_B.png`,I.N),this.texture_idr=i.getTextureRotated(`${t}_out_inner_coner.png`,I.S),this.texture_idl=i.getTexture(`${t}_out_inner_coner.png`),this.texture_iur=i.getTextureRotated(`${t}_out_inner_coner.png`,I.W),this.texture_iul=i.getTextureRotated(`${t}_out_inner_coner.png`,I.MIRROR_VERTICAL),this.texture_dhd=i.getTexture(`${t}_out_line.png`),this.texture_dhu=i.getTextureRotated(`${t}_out_line.png`,I.W),this.texture_dvr=i.getTextureRotated(`${t}_out_line.png`,I.S),this.texture_dvl=i.getTextureRotated(`${t}_out_line.png`,I.N),this.texture_sdr=i.getTexture(`${t}_in_coner.png`),this.texture_sdl=i.getTextureRotated(`${t}_in_coner.png`,I.N),this.texture_sur=i.getTextureRotated(`${t}_in_coner.png`,I.S),this.texture_sul=i.getTextureRotated(`${t}_in_coner.png`,I.W),this.texture_sdl2=i.getTexture(`${t}_in_coner_B.png`),this.texture_sdr2=i.getTextureRotated(`${t}_in_coner_B.png`,I.S),this.texture_sur2=i.getTextureRotated(`${t}_in_coner_B.png`,I.W),this.texture_sul2=i.getTextureRotated(`${t}_in_coner_B.png`,I.N),this.texture_shd=i.getTexture(`${t}_in_line.png`),this.texture_svr=i.getTextureRotated(`${t}_in_line.png`,I.S),this.texture_shu=i.getTextureRotated(`${t}_in_line.png`,I.W),this.texture_svl=i.getTextureRotated(`${t}_in_line.png`,I.N),this.texture_dol=i.getTexture("//maze/maze_door.png"),this.texture_dor=i.getTexture("//maze/maze_door.png"),this.texture_fill=i.getTexture(`${t}_in_Fill.png`),this.sprites=[],this.positionList=[];for(let s=0;s<MAP_PACMAN_PIXI.length;s++){const n=Math.floor(s/mapCols),a=s%mapCols,o=MAP_PACMAN_PIXI[s];let l=null;switch(o){case"":l=new j(this.texture_ddr);break;case"":l=new j(this.texture_ddl);break;case"":l=new j(this.texture_dur);break;case"":l=new j(this.texture_dul);break;case"D":l=new j(this.texture_cD);break;case"d":l=new j(this.texture_cd);break;case"R":l=new j(this.texture_cR);break;case"r":l=new j(this.texture_cr);break;case"U":l=new j(this.texture_cU);break;case"u":l=new j(this.texture_cu);break;case"L":l=new j(this.texture_cL);break;case"l":l=new j(this.texture_cl);break;case"":l=new j(this.texture_idr);break;case"":l=new j(this.texture_idl);break;case"":l=new j(this.texture_iur);break;case"":l=new j(this.texture_iul);break;case"":l=new j(this.texture_sdr);break;case"":l=new j(this.texture_sdl);break;case"":l=new j(this.texture_sur);break;case"":l=new j(this.texture_sul);break;case"":l=new j(this.texture_sdr2);break;case"":l=new j(this.texture_sdl2);break;case"":l=new j(this.texture_sur2);break;case"":l=new j(this.texture_sul2);break;case"":l=new j(this.texture_svr);break;case"":l=new j(this.texture_svl);break;case"":l=new j(this.texture_shd);break;case"":l=new j(this.texture_shu);break;case"":l=new j(this.texture_dhd);break;case"":l=new j(this.texture_dhu);break;case"":l=new j(this.texture_dvr);break;case"":l=new j(this.texture_dvl);break;case">":l=new j(this.texture_dol);break;case"<":l=new j(this.texture_dor);break;case"X":l=new j(this.texture_fill);break}if(l===null)continue;this.sprites.push(l),l.visible=!1,this.layer.addChild(l);const c=mapMargin+mapPad+a*tileSize,u=mapMargin+mapPad+n*tileSize;this.positionList.push({posX:c,posY:u}),this.layer.visible=!1;for(let h=0;h<this.sprites.length;h++){const d=this.positionList[h],f=this.sprites[h];f.position.x=d.posX*renderScale,f.position.y=(mapCalibTop+d.posY)*renderScale,f.width=tileSize*renderScale,f.height=tileSize*renderScale,f.visible=!0}}}show(){this.layer.visible=!0}hide(){this.layer.visible=!1}}class Zg{constructor(e){this.frames=0,this.layer=new de,e.addChild(this.layer),this.currentMapIndex=0,this.prevMapIndex=null,this.blinkingStartFrame=null,this.mapList=[],this.mapList.push([new je(this.layer,"//maze/maze01")]),this.mapList.push([new je(this.layer,"//maze/maze02")]),this.mapList.push([new je(this.layer,"//maze/maze03")]),this.mapList.push([new je(this.layer,"//maze/maze04")]),this.mapList.push([new je(this.layer,"//maze/maze05")]),this.mapList.push([new je(this.layer,"//maze/maze06")]),this.mapList.push([new je(this.layer,"//maze_1028/maze_1028_01")]),this.mapList.push([new je(this.layer,"//maze_1028/maze_1028_02")]),this.mapList.push([new je(this.layer,"//maze_1028/maze_1028_03")]),this.mapList.push([new je(this.layer,"//maze_1028/maze_1028_04")]),this.mapList.push([new je(this.layer,"//maze_1028/maze_1028_05")]),this.mapList.push([new je(this.layer,"//maze_1028/maze_1028_06")]),this.mapList.push([new je(this.layer,"//maze_1028/maze_1028_07")]),this.mapList.push([new je(this.layer,"//maze_1028/maze_1028_08")]),this.mapList.push([new je(this.layer,"//maze_1028/maze_1028_09")]),this.mapList[this.currentMapIndex][0].show()}show(){this.layer.visible=!0}hide(){this.layer.visible=!1}update(){this.frames+=1}draw(){if(this.prevMapIndex!==null)switch(this.blinkingStartFrame===null&&(this.blinkingStartFrame=this.frames),this.frames-this.blinkingStartFrame){case 5:case 15:case 25:te().game.speedTimer.blinkingEdge=!0,this.mapList[this.prevMapIndex][0].hide(),this.mapList[this.currentMapIndex][0].show();break;case 10:case 20:case 30:te().game.speedTimer.blinkingEdge=!1,this.mapList[this.currentMapIndex][0].hide(),this.mapList[this.prevMapIndex][0].show();break;case 35:te().game.speedTimer.blinkingEdge=!0,this.mapList[this.prevMapIndex][0].hide(),this.mapList[this.currentMapIndex][0].show(),this.prevMapIndex=null,this.blinkingStartFrame=null;break}else{const e=this.mapList[this.currentMapIndex];if(e.length===1)e[0].show();else{const t=10*e.length,i=this.frames%t,s=Math.floor(i/t*e.length);for(let n of e)n.hide();e[s].show()}}this.layer.visible=!0}initMapIndex(e){for(let t of this.mapList)for(let i of t)i.hide();this.currentMapIndex=e,this.prevMapIndex=null,this.blinkingStartFrame=null,this.mapList[this.currentMapIndex][0].show()}setMapIndex(e){this.prevMapIndex=this.currentMapIndex,this.currentMapIndex=e}}class Mr{constructor(e){this.layer=new de,e.addChild(this.layer),this.rfStore=te(),this.size=15,this.isEaten=!1;const t=ai();this.textures_row1=[t.getTexture("//game/ghost_Blinky_up01.png"),t.getTexture("//game/ghost_Blinky_up02.png"),t.getTexture("//game/ghost_Blinky_left01.png"),t.getTexture("//game/ghost_Blinky_left02.png"),t.getTexture("//game/ghost_Blinky_down01.png"),t.getTexture("//game/ghost_Blinky_down02.png"),t.getTexture("//game/ghost_Blinky_right01.png"),t.getTexture("//game/ghost_Blinky_right02.png")],this.final_textures_row1=[t.getTexture("//game/Final_ghost_Blinky_up01.png"),t.getTexture("//game/Final_ghost_Blinky_up02.png"),t.getTexture("//game/Final_ghost_Blinky_left01.png"),t.getTexture("//game/Final_ghost_Blinky_left02.png"),t.getTexture("//game/Final_ghost_Blinky_down01.png"),t.getTexture("//game/Final_ghost_Blinky_down02.png"),t.getTexture("//game/Final_ghost_Blinky_right01.png"),t.getTexture("//game/Final_ghost_Blinky_right02.png")],this.textures_row2=[t.getTexture("//game/ghost_Pinky_up01.png"),t.getTexture("//game/ghost_Pinky_up02.png"),t.getTexture("//game/ghost_Pinky_left01.png"),t.getTexture("//game/ghost_Pinky_left02.png"),t.getTexture("//game/ghost_Pinky_down01.png"),t.getTexture("//game/ghost_Pinky_down02.png"),t.getTexture("//game/ghost_Pinky_right01.png"),t.getTexture("//game/ghost_Pinky_right02.png")],this.final_textures_row2=[t.getTexture("//game/Final_ghost_Pinky_up01.png"),t.getTexture("//game/Final_ghost_Pinky_up02.png"),t.getTexture("//game/Final_ghost_Pinky_left01.png"),t.getTexture("//game/Final_ghost_Pinky_left02.png"),t.getTexture("//game/Final_ghost_Pinky_down01.png"),t.getTexture("//game/Final_ghost_Pinky_down02.png"),t.getTexture("//game/Final_ghost_Pinky_right01.png"),t.getTexture("//game/Final_ghost_Pinky_right02.png")],this.textures_row3=[t.getTexture("//game/ghost_Inky_up01.png"),t.getTexture("//game/ghost_Inky_up02.png"),t.getTexture("//game/ghost_Inky_left01.png"),t.getTexture("//game/ghost_Inky_left02.png"),t.getTexture("//game/ghost_Inky_down01.png"),t.getTexture("//game/ghost_Inky_down02.png"),t.getTexture("//game/ghost_Inky_right01.png"),t.getTexture("//game/ghost_Inky_right02.png")],this.final_textures_row3=[t.getTexture("//game/Final_ghost_Inky_up01.png"),t.getTexture("//game/Final_ghost_Inky_up02.png"),t.getTexture("//game/Final_ghost_Inky_left01.png"),t.getTexture("//game/Final_ghost_Inky_left02.png"),t.getTexture("//game/Final_ghost_Inky_down01.png"),t.getTexture("//game/Final_ghost_Inky_down02.png"),t.getTexture("//game/Final_ghost_Inky_right01.png"),t.getTexture("//game/Final_ghost_Inky_right02.png")],this.textures_row4=[t.getTexture("//game/ghost_Clyde_up01.png"),t.getTexture("//game/ghost_Clyde_up02.png"),t.getTexture("//game/ghost_Clyde_left01.png"),t.getTexture("//game/ghost_Clyde_left02.png"),t.getTexture("//game/ghost_Clyde_down01.png"),t.getTexture("//game/ghost_Clyde_down02.png"),t.getTexture("//game/ghost_Clyde_right01.png"),t.getTexture("//game/ghost_Clyde_right02.png")],this.final_textures_row4=[t.getTexture("//game/Final_ghost_Clyde_up01.png"),t.getTexture("//game/Final_ghost_Clyde_up02.png"),t.getTexture("//game/Final_ghost_Clyde_left01.png"),t.getTexture("//game/Final_ghost_Clyde_left02.png"),t.getTexture("//game/Final_ghost_Clyde_down01.png"),t.getTexture("//game/Final_ghost_Clyde_down02.png"),t.getTexture("//game/Final_ghost_Clyde_right01.png"),t.getTexture("//game/Final_ghost_Clyde_right02.png")],this.textures_row5=[t.getTexture("//game/ghost_eye_up.png"),t.getTexture("//game/ghost_eye_left.png"),t.getTexture("//game/ghost_eye_down.png"),t.getTexture("//game/ghost_eye_right.png"),t.getTexture("//game/ghost_defeated_Blue01.png"),t.getTexture("//game/ghost_defeated_Blue02.png"),t.getTexture("//game/ghost_defeated_White01.png"),t.getTexture("//game/ghost_defeated_White02.png")],this.final_textures_row5=[t.getTexture("//game/ghost_eye_up.png"),t.getTexture("//game/ghost_eye_left.png"),t.getTexture("//game/ghost_eye_down.png"),t.getTexture("//game/ghost_eye_right.png"),t.getTexture("//game/Final_ghost_defeated_Blue01.png"),t.getTexture("//game/Final_ghost_defeated_Blue02.png"),t.getTexture("//game/Final_ghost_defeated_White01.png"),t.getTexture("//game/Final_ghost_defeated_White02.png")],this.sprite=new j,this.sprite.visible=!1,this.layer.addChild(this.sprite)}draw(e,t,i,s,n,a,o,l){let c=1,u=0;if(o)c=5,u=i;else if(n)c=5,u=a?6:4,u+=s;else switch(u=i*2+s,l){case blinky.color:c=1;break;case pinky.color:c=2;break;case inky.color:c=3;break;case clyde.color:c=4;break;default:c=5}let h=null;if(this.rfStore.game.speedTimer.isFinalSpeed())switch(c){case 1:h=this.final_textures_row1;break;case 2:h=this.final_textures_row2;break;case 3:h=this.final_textures_row3;break;case 4:h=this.final_textures_row4;break;case 5:h=this.final_textures_row5;break;default:console.error(`pixi-ghost.draw, unknown row, row:${c}`)}else switch(c){case 1:h=this.textures_row1;break;case 2:h=this.textures_row2;break;case 3:h=this.textures_row3;break;case 4:h=this.textures_row4;break;case 5:h=this.textures_row5;break;default:console.error(`pixi-ghost.draw, unknown row, row:${c}`)}h&&(this.sprite.texture=h[u]);const d=this.size*renderScale,f=this.size*renderScale;this.sprite.anchor.set(.5),this.sprite.position.x=rs(e),this.sprite.position.y=ns(t),this.sprite.width=d,this.sprite.height=f,this.isEaten=!1,this.sprite.visible=!0}setEaten(){this.isEaten=!0,this.sprite.visible=!1}show(){this.isEaten||(this.sprite.visible=!0)}hide(){this.sprite.visible=!1}}class Qg{constructor(e,t,i,s){this.layer=e,this.frames=0,this.visible=!0,this.x=t,this.y=i;let n,a;const o=ai();s?(n=new j(o.getTexture("//game/dot_power_pelet.png")),a=tileSize*1.8):(n=new j(o.getTexture("//game/dot.png")),a=tileSize*2),n.width=a*renderScale,n.height=a*renderScale,n.anchor.set(.5);const l=(mapMargin+mapPad+t*tileSize+midTile.x)*renderScale,c=(mapMargin+mapPad+i*tileSize+midTile.y+mapCalibTop)*renderScale;n.position.x=l,n.position.y=c,this.layer.addChild(n),this.sprite=n}draw(){if(this.frames+=1,this.visible){const e=this.frames%RF_POWER_PELLET_BLINKING_PERIOD_IN_FRAMES;this.sprite.visible=e/RF_POWER_PELLET_BLINKING_PERIOD_IN_FRAMES<.5}else this.sprite.visible=!1}show(){this.visible=!0,this.sprite.visible=!0}hide(){this.visible=!1,this.sprite.visible=!1}}class Jg{constructor(e){this.layer=e,this.pellets=new Map,this.powerPellets=[]}_formatKey(e,t){return e+1e3*t}showPellet(e,t,i){const s=this._formatKey(e,t);let n=this.pellets.get(s);n||(n=new Qg(this.layer,e,t,i),this.pellets.set(s,n),i&&this.powerPellets.push(n)),n.show()}hidePellet(e,t){const i=this._formatKey(e,t),s=this.pellets.get(i);s&&s.hide()}draw(){for(const e of this.powerPellets)e.draw()}}function Ze(r){switch(r){case V.CHERRY:return"//game/fruit_cherry.png";case V.STRAWBERRY:return"//game/fruit_strawberry.png";case V.ORANGE:return"//game/fruit_orange.png";case V.APPLE:return"//game/fruit_apple.png";case V.MELON:return"//game/fruit_melon.png";case V.EGGPLANT:return"//game/fruit_eggplant.png";case V.BANANA:return"//game/fruit_banana.png";case V.DONUT:return"//game/fruit_donut.png";case V.GALAXIAN:return"//game/fruit_key2.png";case V.BELL:return"//game/fruit_bell.png";case V.KEY:return"//game/fruit_key.png";case V.FOX:return"//game/fruit_fox.png";case V.PACMAN:return"//game/fruit_pacman.png";default:const e=`unknown fruit-name: ${r}`;throw console.error(e),new Error(e)}}class em{constructor(e){this.layer=e,this.size=15;const t=ai();this.textures=[t.getTexture(Ze(V.CHERRY)),t.getTexture(Ze(V.STRAWBERRY)),t.getTexture(Ze(V.ORANGE)),t.getTexture(Ze(V.APPLE)),t.getTexture(Ze(V.MELON)),t.getTexture(Ze(V.EGGPLANT)),t.getTexture(Ze(V.BANANA)),t.getTexture(Ze(V.DONUT)),t.getTexture(Ze(V.GALAXIAN)),t.getTexture(Ze(V.BELL)),t.getTexture(Ze(V.KEY)),t.getTexture(Ze(V.FOX)),t.getTexture(Ze(V.PACMAN))],this.sprite=new j,this.sprite.anchor.set(.5),this.layer.addChild(this.sprite)}drawFromModel(e){if(!e.visible){this.sprite.visible=!1;return}this.draw(e.x,e.y,e.name)}draw(e,t,i){switch(i){case V.CHERRY:this.sprite.texture=this.textures[0];break;case V.STRAWBERRY:this.sprite.texture=this.textures[1];break;case V.ORANGE:this.sprite.texture=this.textures[2];break;case V.APPLE:this.sprite.texture=this.textures[3];break;case V.MELON:this.sprite.texture=this.textures[4];break;case V.EGGPLANT:this.sprite.texture=this.textures[5];break;case V.BANANA:this.sprite.texture=this.textures[6];break;case V.DONUT:this.sprite.texture=this.textures[7];break;case V.GALAXIAN:this.sprite.texture=this.textures[8];break;case V.BELL:this.sprite.texture=this.textures[9];break;case V.KEY:this.sprite.texture=this.textures[10];break;case V.FOX:this.sprite.texture=this.textures[11];break;case V.PACMAN:this.sprite.texture=this.textures[12];break;default:console.error(`pixi-fruit.draw, unknown name: ${i}`);return}const s=mapMargin+mapPad+e;this.sprite.position.x=s*renderScale;const n=mapMargin+mapPad+t+mapCalibTop;this.sprite.position.y=n*renderScale,this.sprite.width=this.size*renderScale,this.sprite.height=this.size*renderScale,this.sprite.visible=!0}hide(){this.sprite.visible=!1}}class tm{constructor(e){this.layer=new de,e.addChild(this.layer),this.rfStore=te(),this.size=22*.7,this.scale=1;const t=ai();this.textures=[t.getTexture("//game/pacman_03.png"),t.getTextureRotated("//game/pacman_02.png",I.N),t.getTextureRotated("//game/pacman_01.png",I.N),t.getTexture("//game/pacman_02.png"),t.getTexture("//game/pacman_01.png"),t.getTextureRotated("//game/pacman_02.png",I.S),t.getTextureRotated("//game/pacman_01.png",I.S),t.getTextureRotated("//game/pacman_02.png",I.W),t.getTextureRotated("//game/pacman_01.png",I.W)],this.final_textures=[t.getTexture("//game/Final_pacman_03.png"),t.getTextureRotated("//game/Final_pacman_02.png",I.N),t.getTextureRotated("//game/Final_pacman_01.png",I.N),t.getTexture("//game/Final_pacman_02.png"),t.getTexture("//game/Final_pacman_01.png"),t.getTextureRotated("//game/Final_pacman_02.png",I.S),t.getTextureRotated("//game/Final_pacman_01.png",I.S),t.getTextureRotated("//game/Final_pacman_02.png",I.W),t.getTextureRotated("//game/Final_pacman_01.png",I.W)];const i=[t.getTexture("//game/pacman_dead_01.png"),t.getTexture("//game/pacman_dead_02.png"),t.getTexture("//game/pacman_dead_03.png"),t.getTexture("//game/pacman_dead_04.png"),t.getTexture("//game/pacman_dead_05.png"),t.getTexture("//game/pacman_dead_06.png"),t.getTexture("//game/pacman_dead_07.png"),t.getTexture("//game/pacman_dead_08.png"),t.getTexture("//game/pacman_dead_09.png"),t.getTexture("//game/pacman_dead_10.png")],s=[t.getTexture("//game/Final_pacman_dead_01.png"),t.getTexture("//game/Final_pacman_dead_02.png"),t.getTexture("//game/Final_pacman_dead_03.png"),t.getTexture("//game/Final_pacman_dead_04.png"),t.getTexture("//game/Final_pacman_dead_05.png"),t.getTexture("//game/Final_pacman_dead_06.png"),t.getTexture("//game/Final_pacman_dead_07.png"),t.getTexture("//game/Final_pacman_dead_08.png"),t.getTexture("//game/Final_pacman_dead_09.png"),t.getTexture("//game/Final_pacman_dead_10.png")],n=[t.getTextureRotated("//game/pacman_dead_01.png",I.S),t.getTextureRotated("//game/pacman_dead_02.png",I.S),t.getTextureRotated("//game/pacman_dead_03.png",I.S),t.getTextureRotated("//game/pacman_dead_04.png",I.S),t.getTextureRotated("//game/pacman_dead_05.png",I.S),t.getTextureRotated("//game/pacman_dead_06.png",I.S),t.getTextureRotated("//game/pacman_dead_07.png",I.S),t.getTextureRotated("//game/pacman_dead_08.png",I.S),t.getTextureRotated("//game/pacman_dead_09.png",I.S),t.getTextureRotated("//game/pacman_dead_10.png",I.S)],a=[t.getTextureRotated("//game/Final_pacman_dead_01.png",I.S),t.getTextureRotated("//game/Final_pacman_dead_02.png",I.S),t.getTextureRotated("//game/Final_pacman_dead_03.png",I.S),t.getTextureRotated("//game/Final_pacman_dead_04.png",I.S),t.getTextureRotated("//game/Final_pacman_dead_05.png",I.S),t.getTextureRotated("//game/Final_pacman_dead_06.png",I.S),t.getTextureRotated("//game/Final_pacman_dead_07.png",I.S),t.getTextureRotated("//game/Final_pacman_dead_08.png",I.S),t.getTextureRotated("//game/Final_pacman_dead_09.png",I.S),t.getTextureRotated("//game/Final_pacman_dead_10.png",I.S)],o=[t.getTextureRotated("//game/pacman_dead_01.png",I.W),t.getTextureRotated("//game/pacman_dead_02.png",I.W),t.getTextureRotated("//game/pacman_dead_03.png",I.W),t.getTextureRotated("//game/pacman_dead_04.png",I.W),t.getTextureRotated("//game/pacman_dead_05.png",I.W),t.getTextureRotated("//game/pacman_dead_06.png",I.W),t.getTextureRotated("//game/pacman_dead_07.png",I.W),t.getTextureRotated("//game/pacman_dead_08.png",I.W),t.getTextureRotated("//game/pacman_dead_09.png",I.W),t.getTextureRotated("//game/pacman_dead_10.png",I.W)],l=[t.getTextureRotated("//game/Final_pacman_dead_01.png",I.W),t.getTextureRotated("//game/Final_pacman_dead_02.png",I.W),t.getTextureRotated("//game/Final_pacman_dead_03.png",I.W),t.getTextureRotated("//game/Final_pacman_dead_04.png",I.W),t.getTextureRotated("//game/Final_pacman_dead_05.png",I.W),t.getTextureRotated("//game/Final_pacman_dead_06.png",I.W),t.getTextureRotated("//game/Final_pacman_dead_07.png",I.W),t.getTextureRotated("//game/Final_pacman_dead_08.png",I.W),t.getTextureRotated("//game/Final_pacman_dead_09.png",I.W),t.getTextureRotated("//game/Final_pacman_dead_10.png",I.W)],c=[t.getTextureRotated("//game/pacman_dead_01.png",I.N),t.getTextureRotated("//game/pacman_dead_02.png",I.N),t.getTextureRotated("//game/pacman_dead_03.png",I.N),t.getTextureRotated("//game/pacman_dead_04.png",I.N),t.getTextureRotated("//game/pacman_dead_05.png",I.N),t.getTextureRotated("//game/pacman_dead_06.png",I.N),t.getTextureRotated("//game/pacman_dead_07.png",I.N),t.getTextureRotated("//game/pacman_dead_08.png",I.N),t.getTextureRotated("//game/pacman_dead_09.png",I.N),t.getTextureRotated("//game/pacman_dead_10.png",I.N)],u=[t.getTextureRotated("//game/Final_pacman_dead_01.png",I.N),t.getTextureRotated("//game/Final_pacman_dead_02.png",I.N),t.getTextureRotated("//game/Final_pacman_dead_03.png",I.N),t.getTextureRotated("//game/Final_pacman_dead_04.png",I.N),t.getTextureRotated("//game/Final_pacman_dead_05.png",I.N),t.getTextureRotated("//game/Final_pacman_dead_06.png",I.N),t.getTextureRotated("//game/Final_pacman_dead_07.png",I.N),t.getTextureRotated("//game/Final_pacman_dead_08.png",I.N),t.getTextureRotated("//game/Final_pacman_dead_09.png",I.N),t.getTextureRotated("//game/Final_pacman_dead_10.png",I.N)];this.textures_dying=[i,n,o,c],this.final_textures_dying=[s,a,l,u],this.sprite=new j(this.textures[0]),this.sprite.anchor.set(.5),this.sprite.visible=!1,this.layer.addChild(this.sprite);const h=RF_FONT_FAMILY,d="#ffffff",f="center";this.eatenPointsFS=5,this.eatenPoints=new Wr({text:"0",style:new ii({fontFamily:h,fill:d,align:f})}),this.eatenPoints.anchor.set(.5),this.eatenPoints.position.x=0,this.eatenPoints.position.y=RF_FONT_MARGIN_Y,this.eatenPoints.style.fontSize=this.eatenPointsFS,this.eatenPoints.scale.x=RF_FONT_SCALE_X,this.eatenPoints.scale.y=RF_FONT_SCALE_Y,this.eatenPoints.visible=!1,this.layer.addChild(this.eatenPoints)}draw(e,t,i,s){this.eatenPoints.visible=!1;let n=0;if(i===void 0){console.error("pixiPalyer draw, dirEnum undefined");return}s!==0&&(n=i*2+1+(s-1));let a=this.textures;this.rfStore.game.speedTimer.isFinalSpeed()&&(a=this.final_textures),this.sprite.texture=a[n];const o=this.size*this.scale*renderScale,l=this.size*this.scale*renderScale,c=rs(e),u=ns(t);this.sprite.position.x=c,this.sprite.position.y=u,this.sprite.width=o,this.sprite.height=l,this.sprite.visible=!0,this.layer.visible=!0}drawDyingAnimation(e,t,i,s){this.eatenPoints.visible=!1;let n=this.textures_dying;this.rfStore.game.speedTimer.isFinalSpeed()&&(n=this.final_textures_dying);let a=null;if(a=n[0],a){const c=Math.floor(s*a.length);this.sprite.texture=a[c]}const o=this.size*this.scale*renderScale,l=this.size*this.scale*renderScale;this.sprite.position.x=rs(e),this.sprite.position.y=ns(t),this.sprite.width=o,this.sprite.height=l,this.sprite.visible=!0,this.layer.visible=!0}drawEatenPoints(e,t,i){this.sprite.visible=!1,this.eatenPoints.text=i.toString(),this.eatenPoints.position.x=rs(e),this.eatenPoints.position.y=ns(t),this.eatenPoints.style.fontSize=this.eatenPointsFS*renderScale,this.eatenPoints.visible=!0,this.layer.visible=!0}setScale(e){this.scale=e}show(){this.layer.visible=!0}hide(){this.layer.visible=!1}}class im{constructor(e,t,i,s,n){this.targetObj=e,this.x=t,this.y=i,this.fs=s,this.name=n}scaleAndShow(){const e=this.targetObj;e.position.x=this.x*renderScale,e.position.y=(this.y+RF_FONT_MARGIN_Y)*renderScale,e.style.fontSize=this.fs*renderScale,e.style.letterSpacing=RF_FONT_LETTER_SPACING,e.scale.x=RF_FONT_SCALE_X,e.scale.y=RF_FONT_SCALE_Y,e.visible=!0}}class ne{constructor(e,t,i,s,n,a,o,l,c,u){const h=(u==null?void 0:u.fontFamily)??RF_FONT_FAMILY,d=(u==null?void 0:u.useSkinCoordinate)??!0,f=u==null?void 0:u.onClick;this.text=new Wr({text:t,style:{fontFamily:h,fill:i,align:s}}),this.text.anchor.set(n,a);const p=d?Z(o):o,_=d?Z(l):l;this.scaler=new im(this.text,p,_,c,""),f&&(this.text.interactive=!0,this.text.on("pointerdown",f)),this.text.visible=!1,e.addChild(this.text)}drawFromModel(e){e.visible?(this.setText(e.score.toString()),this.draw()):this.hide()}draw(){this.scaler.scaleAndShow()}hide(){this.text&&(this.text.visible=!1)}setAlpha(e){this.text&&(this.text.alpha=e)}setText(e){this.text&&(this.text.text=e)}setColor(e){this.text&&(this.text.style.fill=e)}}class Rc{constructor(e,t,i,s,n,a){this.targetObj=e,this.x=t,this.y=i,this.w=s,this.h=n,this.name=a}scaleAndShow(e,t){e!==void 0&&t!==void 0&&(this.x=e,this.y=t);const i=this.targetObj;i.position.x=this.x*renderScale,i.position.y=this.y*renderScale,i.width=this.w*renderScale,i.height=this.h*renderScale,i.visible=!0}}class O{constructor(e,t,i,s,n,a,o,l,c,u,h){this.layer=e,h?this.textures=h:this.textures=ai().getTextures(t),this.sprite=new j(this.textures[0]),this.sprite.anchor.set(i,s),this.sprite.alpha=1;let d,f;u!=null&&u.useRawPosition?(d=n,f=a):(d=Z(n),f=Z(a)),this.scaler=new Rc(this.sprite,d,f,Z(o),Z(l)),c&&(this.sprite.interactive=!0,this.sprite.on("pointerdown",c)),this.sprite.visible=!1,this.layer.addChild(this.sprite)}draw(){this.scaler.scaleAndShow()}drawSiknCoord(e,t){this.scaler.scaleAndShow(Z(e),Z(t))}hide(){this.sprite.visible=!1}setTextureIndex(e){this.sprite.texture=this.textures[e]}setAlpha(e){this.sprite.alpha=e}discard(){this.layer.removeChild(this.sprite)}setInteractive(e){this.sprite.interactive=e}}class Vt{constructor(e,t){this.pane=e,this.layer=new de,this.layer.zIndex=t,this.pane.addChild(this.layer)}hide(){this.layer.visible=!1}setAlpha(e){this.layer.alpha=e}}class sm{constructor(e,t){this.pelletCounterText=e,this.activatedAt=t}}class rm extends Vt{constructor(){if(super(PIXI_RENDERER.getRootLayer(),Ct.GAME),this.eatenFruitSSList=[],this.pelletCounterCurrIndex=0,this.pelletCounterList=[],this.eatenFruitPointsVisiableAt=null,this.extraLiveAniFrameStartedAt=null,this.frames=0,console.log("Adding PixiGamePanel"),this.rfStore=te(),this.mapTier=new Zg(this.layer),this.itemLayer=new de,this.layer.addChild(this.itemLayer),this.pelletManager=new Jg(this.itemLayer),this.fruit=new em(this.itemLayer),this.initPelletCounter(),this.initEatenFruitPoints(),this.actorLayer=new de,this.layer.addChild(this.actorLayer),RF_DEBUG_ACTOR_LAYER_GREEN_BG){const s=new ps;s.fill({color:65280}),s.rect(0-skinWidth,0-skinHeight,skinWidth*3,skinHeight*3),this.actorLayer.addChild(s)}this.ghost1=new Mr(this.actorLayer),this.ghost2=new Mr(this.actorLayer),this.ghost3=new Mr(this.actorLayer),this.ghost4=new Mr(this.actorLayer),this.player=new tm(this.actorLayer),this.actorMask=new ps,this.pane.addChild(this.actorMask),this.noticeLayer=new de,this.layer.addChild(this.noticeLayer),this.readyST=new ne(this.noticeLayer,"READY!","#ff0","center",.5,.5,mapMargin+mapPad+115,mapMargin+mapPad+165+mapCalibTop+1,tileSize,{useSkinCoordinate:!1}),this.gameOverST=new ne(this.noticeLayer,"GAME OVER","#f00","center",.5,.5,mapMargin+mapPad+114,mapMargin+mapPad+165+mapCalibTop+1,tileSize,{useSkinCoordinate:!1}),this.footerLayer=new de,this.layer.addChild(this.footerLayer);const e=80*.5,t=3,i=["//game/pacman_02.png","//game/Final_pacman_02.png"];this.extraLive1SS=new O(this.footerLayer,i,0,1,60,skinMainPanelB-30,e,e),this.extraLive2SS=new O(this.footerLayer,i,0,1,60+(e+t),skinMainPanelB-30,e,e),this.extraLive3SS=new O(this.footerLayer,i,0,1,60+(e+t)*2,skinMainPanelB-30,e,e),this.extraLive4SS=new O(this.footerLayer,i,0,1,60+(e+t)*3,skinMainPanelB-30,e,e),this.extraLive5SS=new O(this.footerLayer,i,0,1,60+(e+t)*4,skinMainPanelB-30,e,e),this.fruitRowY=skinMainPanelB-30,this.fruitRowR=skinWidth-30,this.fruitSize=40,this.fruitSpacing=5,this.fruitRowPaddingR=20,this.eatenFruitSSList=[]}initPelletCounter(){const e="#ffffff",t="center";this.pelletCounterCurrIndex=0;for(let i=0;i<RF_PELLET_COUNTER_COUNT;i++){const s=new Wr({text:"0",style:new ii({fill:e,align:t})});s.anchor.set(.5),s.position.x=0,s.position.y=0,s.style.fontSize=RF_PELLET_COUNTER_FONT_SIZE,s.visible=!1,this.layer.addChild(s),this.pelletCounterList.push(new sm(s,0))}}initEatenFruitPoints(){const e=RF_FONT_FAMILY,t="#ffffff",i="center";this.eatenFruitPointsVisiableAt=null,this.eatenFruitPoints=new Wr({text:"0",style:new ii({fontFamily:e,fill:t,align:i})}),this.eatenFruitPoints.anchor.set(.5),this.eatenFruitPoints.position.x=0,this.eatenFruitPoints.position.y=RF_FONT_MARGIN_Y,this.eatenFruitPoints.style.fontSize=10,this.eatenFruitPoints.scale.x=RF_FONT_SCALE_X,this.eatenFruitPoints.scale.y=RF_FONT_SCALE_Y,this.eatenFruitPoints.visible=!1,this.layer.addChild(this.eatenFruitPoints)}update(){this.frames+=1;for(let e of this.pelletCounterList){if(e.activatedAt===0)continue;const t=this.frames-e.activatedAt;t>RF_PELLET_COUNTER_LIFE_IN_FRAMES?(e.pelletCounterText.visible=!1,e.activatedAt=0):e.pelletCounterText.alpha=1-t/RF_PELLET_COUNTER_LIFE_IN_FRAMES}this.eatenFruitPointsVisiableAt!==null&&this.frames-this.eatenFruitPointsVisiableAt>3&&(this.eatenFruitPointsVisiableAt=null,this.eatenFruitPoints&&(this.eatenFruitPoints.visible=!1)),this.mapTier.update()}drawMap(){renderer.drawMap(),this.mapTier.draw(),this.pelletManager.draw(),this.itemLayer.visible=!0}resetFrame(){this.frames=0,this.extraLiveAniFrameStartedAt=null}hideMap(){this.mapTier.hide(),this.itemLayer.visible=!1}showActor(){console.log("showActor"),this.player.show(),this.ghost1.show(),this.ghost2.show(),this.ghost3.show(),this.ghost4.show()}hideActor(){console.log("hideActor"),this.player.hide(),this.ghost1.hide(),this.ghost2.hide(),this.ghost3.hide(),this.ghost4.hide()}drawPlayer(e,t,i,s){this.player.draw(e,t,i,s)}drawDyingPlayer(e){this.player.drawDyingAnimation(pacman.pixel.x,pacman.pixel.y,pacman.dirEnum,e)}drawPlayerEatenPoints(e,t,i){this.player.drawEatenPoints(e,t,i)}drawFruitPoints(e,t,i){if(this.eatenFruitPoints===void 0)throw new Error("eatenFruitPoints undefined");this.eatenFruitPoints.text=i.toString(),this.eatenFruitPoints.position.x=rs(e),this.eatenFruitPoints.position.y=ns(t),this.eatenFruitPointsVisiableAt=this.frames,this.eatenFruitPoints.visible=!0}_nextPelletCounter(){return this.pelletCounterCurrIndex+=1,this.pelletCounterCurrIndex===this.pelletCounterList.length&&(this.pelletCounterCurrIndex=0),this.pelletCounterList[this.pelletCounterCurrIndex]}drawPelletCounter(e,t,i){const s=this._nextPelletCounter();s.activatedAt=this.frames,s.pelletCounterText.text=i.toString(),s.pelletCounterText.position.x=rs(e),s.pelletCounterText.position.y=ns(t),s.pelletCounterText.visible=!0}hidePelletCounter(){for(let e of this.pelletCounterList)e.pelletCounterText.visible=!1,e.activatedAt=0}hidePlayer(){this.player.hide()}setPlayerScale(e){this.player.setScale(e)}showPlayer(){this.player.show()}drawGhost(e,t,i,s,n,a,o,l){l===blinky.color?this.ghost1.draw(e,t,i,s,n,a,o,l):l===pinky.color?this.ghost2.draw(e,t,i,s,n,a,o,l):l===inky.color?this.ghost3.draw(e,t,i,s,n,a,o,l):l===clyde.color&&this.ghost4.draw(e,t,i,s,n,a,o,l),this.actorLayer.visible=!0,this.layer.visible=!0}hideGhosts(){this.ghost1.hide(),this.ghost2.hide(),this.ghost3.hide(),this.ghost4.hide()}hideGhostByName(e){this.ghostByName(e).hide()}ghostByName(e){switch(e){case"blinky":return this.ghost1;case"pinky":return this.ghost2;case"inky":return this.ghost3;case"clyde":return this.ghost4;default:throw new Error("unknown ghost")}}drawFruit(e){e||(e=te().game),this.fruit.drawFromModel(e.fruit)}hideFruit(){this.fruit.hide()}drawReadyMessage(e){if(e){const t=this.frames%30;t<15?(this.readyST.setAlpha(t/15),this.readyST.draw()):(this.readyST.setAlpha((t-15)/15),this.readyST.draw())}else this.readyST.setAlpha(1),this.readyST.draw()}drawGameOverMessage(e){if(e){const t=this.frames%30;t<15?(this.gameOverST.setAlpha(t/15),this.gameOverST.draw()):(this.gameOverST.setAlpha((t-15)/15),this.gameOverST.draw())}else this.gameOverST.setAlpha(1),this.gameOverST.draw()}hideMessage(){this.readyST.hide(),this.gameOverST.hide()}hide(){this.layer.visible=!1}show(){this.layer.visible=!0}showItemLayer(){this.itemLayer.visible=!0}drawFooter(){this.footerLayer.visible=!0,this.rfStore.game.speedTimer.isFinalSpeed()?(this.extraLive1SS.setTextureIndex(1),this.extraLive2SS.setTextureIndex(1),this.extraLive3SS.setTextureIndex(1),this.extraLive4SS.setTextureIndex(1),this.extraLive5SS.setTextureIndex(1)):(this.extraLive1SS.setTextureIndex(0),this.extraLive2SS.setTextureIndex(0),this.extraLive3SS.setTextureIndex(0),this.extraLive4SS.setTextureIndex(0),this.extraLive5SS.setTextureIndex(0)),extraLives>=1?this.extraLiveAniFrameStartedAt!=null&&extraLives===1?this.drawAnimatedExtraLive(this.extraLive1SS):this.extraLive1SS.draw():this.extraLive1SS.hide(),extraLives>=2?this.extraLiveAniFrameStartedAt!=null&&extraLives===2?this.drawAnimatedExtraLive(this.extraLive2SS):this.extraLive2SS.draw():this.extraLive2SS.hide(),extraLives>=3?this.extraLiveAniFrameStartedAt!=null&&extraLives===3?this.drawAnimatedExtraLive(this.extraLive3SS):this.extraLive3SS.draw():this.extraLive3SS.hide(),extraLives>=4?this.extraLiveAniFrameStartedAt!=null&&extraLives===4?this.drawAnimatedExtraLive(this.extraLive4SS):this.extraLive4SS.draw():this.extraLive4SS.hide(),extraLives>=5?this.extraLiveAniFrameStartedAt!=null&&extraLives>=5?this.drawAnimatedExtraLive(this.extraLive5SS):this.extraLive5SS.draw():this.extraLive5SS.hide();const e=te().game.fruit;if(e.eatenFruitsDirty){for(const t of this.eatenFruitSSList)t.discard();this.eatenFruitSSList=[];for(const[t,i]of e.eatenFruits.slice(-7).entries()){const s=new O(this.footerLayer,[Ze(i)],1,1,this.fruitRowR-this.fruitRowPaddingR-(this.fruitSize+this.fruitSpacing)*t,this.fruitRowY,this.fruitSize,this.fruitSize);this.eatenFruitSSList.push(s)}e.eatenFruitsDirty=!1}for(const t of this.eatenFruitSSList)t.draw()}hideFooter(){this.footerLayer.visible=!1}setAlpha(e){this.layer.alpha=e}initMapIndex(e){this.mapTier.initMapIndex(e)}setMapIndex(e){this.mapTier.setMapIndex(e)}addActorMask(e,t,i,s){this.actorMask.clear();const n=gr(e),a=gr(t),o=gr(i),l=gr(s);this.actorMask.rect(n,a,o,l),this.actorMask.fill(16724736),this.actorMask.visible=!0,this.actorLayer.mask=this.actorMask}removeActorMask(){this.actorMask.visible=!1,this.actorLayer.mask=null}triggerExtraLiveAni(){this.extraLiveAniFrameStartedAt=this.frames}drawAnimatedExtraLive(e){if(this.extraLiveAniFrameStartedAt===null){console.error("  at drawAnimatedExtraLive");return}const t=this.frames-this.extraLiveAniFrameStartedAt;t>=0&&t<RF_EXTRA_LIVE_ANI_BLINK_SPAN?e.draw():t>=RF_EXTRA_LIVE_ANI_BLINK_SPAN&&t<RF_EXTRA_LIVE_ANI_BLINK_SPAN*2?e.hide():t>=RF_EXTRA_LIVE_ANI_BLINK_SPAN*2&&t<RF_EXTRA_LIVE_ANI_BLINK_SPAN*3?e.draw():t>=RF_EXTRA_LIVE_ANI_BLINK_SPAN*3&&t<RF_EXTRA_LIVE_ANI_BLINK_SPAN*4?e.hide():t>=RF_EXTRA_LIVE_ANI_BLINK_SPAN*4&&t<RF_EXTRA_LIVE_ANI_BLINK_SPAN*5?e.draw():t>=RF_EXTRA_LIVE_ANI_BLINK_SPAN*5&&t<RF_EXTRA_LIVE_ANI_BLINK_SPAN*6?e.hide():t>=RF_EXTRA_LIVE_ANI_BLINK_SPAN*6&&t<RF_EXTRA_LIVE_ANI_BLINK_SPAN*7?e.draw():t>=RF_EXTRA_LIVE_ANI_BLINK_SPAN*7&&t<RF_EXTRA_LIVE_ANI_BLINK_SPAN*8?e.hide():t>=RF_EXTRA_LIVE_ANI_BLINK_SPAN*8&&t<RF_EXTRA_LIVE_ANI_BLINK_SPAN*9?e.draw():t>=RF_EXTRA_LIVE_ANI_BLINK_SPAN*9&&t<RF_EXTRA_LIVE_ANI_BLINK_SPAN*10?e.hide():(e.draw(),this.extraLiveAniFrameStartedAt=null)}}var Yn=null;function X(){return Yn===null&&(Yn=new rm,console.log("PixiGamePanel ")),Yn}var Ks=(r=>(r[r.NORMAL=0]="NORMAL",r[r.ENERGIZER=2]="ENERGIZER",r[r.GOING_HOME=4]="GOING_HOME",r))(Ks||{});globalThis.E_GHOST_NORMAL_SOUND_FROM_LEVEL=[Q.GHOST_NORMAL,Q.GHOST_NORMAL,Q.GHOST_NORMAL,Q.GHOST_SPURT1,Q.GHOST_SPURT1,Q.GHOST_SPURT2,Q.GHOST_SPURT2,Q.GHOST_SPURT3,Q.GHOST_SPURT4];class nm{constructor(){this.gameStartedAt=null,this.blinkingFired=!1,this.blinkingEdge=!1,this.baseSpeedLevel=null,this.boostedSpeedLevel=0,this.ghostSoundEnabled=!1,this.ghostSoundPoint=0,this.ghostSoundKey=null}init(){this.gameStartedAt=null,this.baseSpeedLevel=level-1,this.boostedSpeedLevel=0,this.blinkingFired=!1,X().initMapIndex(this.baseSpeedLevel)}calcSpeedLevel(){return this.baseSpeedLevel==null||this.boostedSpeedLevel===null?0:this.baseSpeedLevel+this.boostedSpeedLevel}getSpeedNotice(){return RF_SPEED_NOTICE_FROM_LEVEL[this.calcSpeedLevel()]}isFinalSpeed(){return this.calcSpeedLevel()>5}start(){this.gameStartedAt=Date.now(),this.blinkingFired=!1,executive.setUpdatesPerSecond(60*this.calcSpeedRatio()),console.log(`SPEED.START(), speed:${this.calcSpeedRatio()}`),this.startPlayGhostSound()}updateSpeed(){executive.setUpdatesPerSecond(60*this.calcSpeedRatio()),X().setMapIndex(this.calcSpeedLevel()),this.boostedSpeedLevel==1?ie().play(Q.CHANGE_SPEED1,!1):ie().play(Q.CHANGE_SPEED2,!1),this.addGhostSoundPoint(0),console.log(`set-speed, speed:${this.calcSpeedRatio()}`)}checkBoostDisabled(){return level>9||this.boostedSpeedLevel==2}update(){const e=RF_SPEED_BOOST_SPOOL_UP_TIME,t=RF_SPEED_BOOST_SPOOL_UP_TIME*2;if(this.gameStartedAt===null||level>9)return;const i=Date.now()-this.gameStartedAt,s=RF_SPEED_BOOST_ANIMATION_TIME;i<e-s||(e-s<=i&&i<e?this.blinkingFired||(this.blinkingFired=!0):e<=i&&i<t-s?this.boostedSpeedLevel!==1&&(this.blinkingFired=!1,this.boostedSpeedLevel=1,this.updateSpeed()):t-s<=i&&i<t?this.blinkingFired||(this.blinkingFired=!0):t<=i&&this.boostedSpeedLevel!==2&&(this.blinkingFired=!1,this.boostedSpeedLevel=2,this.updateSpeed()))}calcSpeedRatio(){return this.gameStartedAt===null?1:RF_SPEED_RATIO_FROM_LEVEL[this.calcSpeedLevel()]}calcGameAge(){return this.gameStartedAt===null?1:Date.now()-this.gameStartedAt}turnOff(){this.gameStartedAt=null}_tlsGhostNormalSound(){const e=this.calcSpeedLevel();return E_GHOST_NORMAL_SOUND_FROM_LEVEL[e]}_playGhostSound(e,t){if(e===this.ghostSoundKey)return;const i=["play-ghost-sound"];this.ghostSoundKey&&(i.push(`stopping ${this.ghostSoundKey}`),ie().stop(this.ghostSoundKey)),this.ghostSoundKey=e,i.push(`playing ${this.ghostSoundKey}`),t===void 0?ie().play(this.ghostSoundKey,!0):setTimeout(()=>{this.ghostSoundKey!==null&&ie().play(this.ghostSoundKey,!0)},t)}startPlayGhostSound(){this.ghostSoundEnabled=!0,this.ghostSoundPoint=0,this._playGhostSound(Q.GHOST_NORMAL)}stopPlayGhostSound(){this.ghostSoundEnabled=!1,this.ghostSoundPoint=0,this.ghostSoundKey&&ie().stop(this.ghostSoundKey),this.ghostSoundKey=null,ie().stop(Q.GHOST_NORMAL),ie().stop(Q.GHOST_SPURT1),ie().stop(Q.GHOST_SPURT2),ie().stop(Q.GHOST_SPURT3),ie().stop(Q.GHOST_SPURT4),ie().stop(Q.GHOST_BLUE),ie().stop(Q.GHOST_GOING_HOME)}addGhostSoundPoint(e){this.ghostSoundEnabled&&(e>0?this.ghostSoundPoint|=e:this.ghostSoundPoint&=~-e,this.ghostSoundPoint&4?this._playGhostSound(Q.GHOST_GOING_HOME,1e3):this.ghostSoundPoint&2?this._playGhostSound(Q.GHOST_BLUE):this._playGhostSound(this._tlsGhostNormalSound()))}}class am{constructor(){this.score=new Kg,this.player=new qg,this.fruit=new jg,this.speedTimer=new nm}}const Zi="PACMAN_SAVE_DATA";class om{constructor(){this.skin=new Xg,this.game=new am,this.savedAt=null,this.loadGameState()}loadGameState(){if(ytgame!=null&&ytgame.IN_PLAYABLES_ENV)ytgame.game.loadData().then(e=>{if(e){const i=JSON.parse(e).rf_selected_skin;this.skin.setSelectedSkin(i)}});else{const e=localStorage.getItem(Zi);if(e)try{const i=JSON.parse(e).rf_selected_skin;this.skin.setSelectedSkin(i)}catch(t){console.error("Error parsing local save data:",t)}}}saveSkin(){if(ytgame!=null&&ytgame.IN_PLAYABLES_ENV)ytgame.game.loadData().then(e=>{if(e){const t=JSON.parse(e);t.rf_selected_skin=this.skin.selectedSkin,ytgame.game.saveData(JSON.stringify(t))}else{let t={rf_selected_skin:this.skin.selectedSkin,rf_high_scores:[]};ytgame.game.saveData(JSON.stringify(t))}});else{const e=localStorage.getItem(Zi);let t;if(e)try{t=JSON.parse(e),t.rf_selected_skin=this.skin.selectedSkin}catch(i){console.error("Error parsing local save data:",i),t={rf_selected_skin:this.skin.selectedSkin,rf_high_scores:[]}}else t={rf_selected_skin:this.skin.selectedSkin,rf_high_scores:[]};localStorage.setItem(Zi,JSON.stringify(t))}}saveScore(){this.savedAt=Date.now();const e=[this.game.score.score,this.game.fruit.toBitFlags(),this.savedAt];if(ytgame!=null&&ytgame.IN_PLAYABLES_ENV)ytgame.engagement.sendScore({value:this.game.score.score}),ytgame.game.loadData().then(t=>{if(t){const i=JSON.parse(t);let s=i.rf_high_scores;s.push(e),s.sort((n,a)=>n[0]===a[0]?a[1]-n[1]:a[0]-n[0]),s=s.slice(0,RF_MAX_HIGH_SCORE_COUNT),i.rf_high_scores=s,ytgame.game.saveData(JSON.stringify(i))}else{let i={rf_selected_skin:this.skin.selectedSkin,rf_high_scores:[e]};ytgame.game.saveData(JSON.stringify(i))}});else{const t=localStorage.getItem(Zi);let i;if(t)try{i=JSON.parse(t);let s=i.rf_high_scores||[];s.push(e),s.sort((n,a)=>n[0]===a[0]?a[1]-n[1]:a[0]-n[0]),s=s.slice(0,RF_MAX_HIGH_SCORE_COUNT),i.rf_high_scores=s}catch(s){console.error("Error parsing local game state data:",s),i={rf_selected_skin:this.skin.selectedSkin,rf_high_scores:[e]}}else i={rf_selected_skin:this.skin.selectedSkin,rf_high_scores:[e]};localStorage.setItem(Zi,JSON.stringify(i))}}loadHighScores(e){if(ytgame!=null&&ytgame.IN_PLAYABLES_ENV)ytgame.game.loadData().then(t=>{if(t){const i=JSON.parse(t);e(i.rf_high_scores)}else e([])});else{const t=localStorage.getItem(Zi);if(t)try{const i=JSON.parse(t);e(i.rf_high_scores||[])}catch(i){console.error("Error parsing local save data:",i),e([])}else e([])}}}var Vn=null;function te(){return Vn===null&&(Vn=new om),Vn}globalThis.GAME_PACMAN=0;globalThis.gameMode=GAME_PACMAN;globalThis.level=1;globalThis.extraLives=0;var Lc=0;function hm(r,e,t){r<t&&r+e>=t&&Fc()}function Fc(){extraLives++,ie().play(Q.EXTEND_SOUND,!1),X().triggerExtraLiveAni(),renderer.drawMap()}function Yr(r){let e=Lc;for(let t=1;t<=30;t++)hm(e,r,RF_EXTRA_LIVE_POINT*t);e+=r,Oc(e)}function Oc(r){te().game.score.setScore(r),Lc=r}class lm{constructor(){this.pixel={x:0,y:0},this.fruitHistory={},this.scoreDuration=2,this.scoreFramesLeft=0,this.currentFruitIndex=0,this.fruits=[]}isScorePresent(){return this.scoreFramesLeft>0}onNewLevel(){this.buildFruitHistory()}setCurrentFruit(e){this.currentFruitIndex=e}onDotEat(){!this.isPresent()&&RF_FRUIT_GEN_DOT_LIMIT_LIST.includes(map.dotsEaten)&&this.initiate()}reset(){this.scoreFramesLeft=0}getCurrentFruit(){return this.fruits[this.currentFruitIndex]}getPoints(){return this.getCurrentFruit().points}update(){this.scoreFramesLeft&&this.scoreFramesLeft>0&&this.scoreFramesLeft--}isCollide(){return Math.abs(pacman.pixel.y-this.pixel.y)<=midTile.y&&Math.abs(pacman.pixel.x-this.pixel.x)<=midTile.x}testCollide(){if(this.isPresent()&&this.isCollide()){const e=te().game.fruit;ie().play(Q.EATING_FRUIT,!1),Yr(this.getPoints());const t=this.getCurrentFruit().name;t===V.PACMAN?Fc():e.incrCounter(t),e.receivedAllFruitsEatenPrise||e.checkAllEaten()&&(ie().play(Q.FRUIT_ALL_PRISE,!1),Yr(RF_FRUIT_ALL_EATEN_PRISE),e.receivedAllFruitsEatenPrise=!0),this.reset(),this.scoreFramesLeft=this.scoreDuration*60,RF_DEBUG_FRUIT_WIN&&(console.debug("RF_DEBUG_FRUIT_WIN"),switchState(finishState,60))}}buildFruitHistory(){}initiate(){}isPresent(){return!1}}class cm extends lm{constructor(){super(),this.fruits=[{name:V.CHERRY,points:0},{name:V.STRAWBERRY,points:0},{name:V.ORANGE,points:0},{name:V.APPLE,points:0},{name:V.MELON,points:0},{name:V.EGGPLANT,points:0},{name:V.BANANA,points:0},{name:V.DONUT,points:0},{name:V.GALAXIAN,points:0},{name:V.BELL,points:0},{name:V.KEY,points:0},{name:V.FOX,points:0},{name:V.PACMAN,points:0}];for(let e=0;e<13;e++)this.fruits[e].points=RF_FRUIT_POINTS[e];this.order=[0,1,2,3,4,5,6,7,8,9,10,11,12],this.duration=9,this.framesLeft=0,this.savedFramesLeft={}}onNewLevel(){this.setCurrentFruit(this.getFruitIndexFromLevel(level)),super.onNewLevel()}getFruitFromLevel(e){return this.fruits[this.getFruitIndexFromLevel(e)]}getFruitIndexFromLevel(e){return e>13&&(e=13),this.order[e-1]}buildFruitHistory(){this.fruitHistory={};for(let e=1;e<=level;e++)this.fruitHistory[e]=this.fruits[this.getFruitIndexFromLevel(e)]}initiate(){this.pixel.x=tileSize*14-1,this.pixel.y=tileSize*20+midTile.y,this.framesLeft=60*this.duration}isPresent(){return this.framesLeft>0}reset(){super.reset(),this.framesLeft=0}update(){super.update(),this.framesLeft&&this.framesLeft>0&&this.framesLeft--}}globalThis.fruit=new cm;class um{constructor(){this.MODE_PERSONAL=0,this.MODE_GLOBAL=1,this.personalDotLimit={1:()=>0,2:()=>level===1?30:0,3:()=>level===1?60:level===2?50:0},this.globalDotLimit={1:7,2:17,3:32},this.framesSinceLastDot=0,this.mode=this.MODE_PERSONAL,this.ghostCounts={1:0,2:0,3:0},this.globalCount=0}getTimeoutLimit(){return level<5?4*60:3*60}onNewLevel(){this.mode=this.MODE_PERSONAL,this.framesSinceLastDot=0,this.ghostCounts[1]=0,this.ghostCounts[2]=0,this.ghostCounts[3]=0}onRestartLevel(){this.mode=this.MODE_GLOBAL,this.framesSinceLastDot=0,this.globalCount=0}onDotEat(){if(this.framesSinceLastDot=0,this.mode===this.MODE_GLOBAL)this.globalCount++;else for(let e=1;e<=3;e++)if(ghosts[e].mode===GHOST_PACING_HOME){this.ghostCounts[e]++;break}}update(){let e;if(this.mode===this.MODE_PERSONAL){for(let t=1;t<=3;t++)if(e=ghosts[t],e.mode===GHOST_PACING_HOME){if(this.ghostCounts[t]>=this.personalDotLimit[t]()){e.leaveHome();return}break}}else if(this.mode===this.MODE_GLOBAL){if(this.globalCount===this.globalDotLimit[1]&&pinky.mode===GHOST_PACING_HOME){pinky.leaveHome();return}else if(this.globalCount===this.globalDotLimit[2]&&inky.mode===GHOST_PACING_HOME){inky.leaveHome();return}else if(this.globalCount===this.globalDotLimit[3]&&clyde.mode===GHOST_PACING_HOME){this.globalCount=0,this.mode=this.MODE_PERSONAL,clyde.leaveHome();return}}if(this.framesSinceLastDot>this.getTimeoutLimit()){this.framesSinceLastDot=0;for(let t=1;t<=3;t++)if(e=ghosts[t],e.mode===GHOST_PACING_HOME){e.leaveHome();break}}else this.framesSinceLastDot++}}globalThis.ghostReleaser=new um;globalThis.GHOST_CMD_CHASE=0;globalThis.GHOST_CMD_SCATTER=1;class dm{constructor(){this.frame=0,this.command=GHOST_CMD_SCATTER;let e;this.times=[{},{},{}],this.times[0]={[e=7*60]:GHOST_CMD_CHASE,[e+=20*60]:GHOST_CMD_SCATTER,[e+=7*60]:GHOST_CMD_CHASE,[e+=20*60]:GHOST_CMD_SCATTER,[e+=5*60]:GHOST_CMD_CHASE,[e+=20*60]:GHOST_CMD_SCATTER,[e+=5*60]:GHOST_CMD_CHASE},this.times[1]={[e=7*60]:GHOST_CMD_CHASE,[e+=20*60]:GHOST_CMD_SCATTER,[e+=7*60]:GHOST_CMD_CHASE,[e+=20*60]:GHOST_CMD_SCATTER,[e+=5*60]:GHOST_CMD_CHASE,[e+=1033*60]:GHOST_CMD_SCATTER,[e+=1]:GHOST_CMD_CHASE},this.times[2]={[e=5*60]:GHOST_CMD_CHASE,[e+=20*60]:GHOST_CMD_SCATTER,[e+=5*60]:GHOST_CMD_CHASE,[e+=20*60]:GHOST_CMD_SCATTER,[e+=5*60]:GHOST_CMD_CHASE,[e+=1037*60]:GHOST_CMD_SCATTER,[e+=1]:GHOST_CMD_CHASE}}getNewCommand(e){let t;return level===1?t=0:level>=2&&level<=4?t=1:t=2,this.times[t][e]}reset(){this.command=GHOST_CMD_SCATTER,this.frame=0}update(){if(!energizer.isActive()){const e=this.getNewCommand(this.frame);if(e!==void 0){this.command=e;for(let t=0;t<4;t++)ghosts[t].reverse()}this.frame++}}getCommand(){return this.command}setCommand(e){this.command=e}}globalThis.ghostCommander=new dm;class fm{constructor(){this.dotsLeft=[[20,30,40,40,40,50,50,50,60,60,60,70,70,70,100,100,100,100,120,120,120],[10,15,20,20,20,25,25,25,30,30,30,40,40,40,50,50,50,50,60,60,60]],this.waitForClyde=!1}getDotsEatenLimit(e){let t=level;return t>21&&(t=21),244-this.dotsLeft[e-1][t-1]}onNewLevel(){this.waitForClyde=!1}onRestartLevel(){this.waitForClyde=!0}update(){this.waitForClyde&&clyde.mode!==GHOST_PACING_HOME&&(this.waitForClyde=!1),this.waitForClyde?blinky.elroy=0:map.dotsEaten>=this.getDotsEatenLimit(2)?blinky.elroy=2:map.dotsEaten>=this.getDotsEatenLimit(1)?blinky.elroy=1:blinky.elroy=0}}globalThis.elroyTimer=new fm;class pm{constructor(e,t,i){this.width=e,this.height=t,this.scale=i,this.app=new Zl,this.rootLayer=new de}async init(){await this.app.init({background:"#000000",width:this.width*this.scale,height:this.height*this.scale}),this.app.stage.addChild(this.rootLayer),document.getElementById("pixiDiv").appendChild(this.app.canvas)}getRootLayer(){return this.rootLayer}blitMap(){const e=X();te().game.fruit.hide(),e.drawMap(),e.showItemLayer()}}async function _m(){globalThis.PIXI_RENDERER=new pm(skinWidth,skinHeight,1),await globalThis.PIXI_RENDERER.init()}globalThis.STEP_PACMAN=0;globalThis.STEP_GHOST=1;globalThis.STEP_PACMAN_FRIGHT=2;globalThis.STEP_GHOST_FRIGHT=3;globalThis.STEP_GHOST_TUNNEL=4;globalThis.STEP_ELROY1=5;globalThis.STEP_ELROY2=6;const gm=[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,2,1,1,1,1,1,1,2,1,1,1,1],[0,1,1,0,1,1,0,1,0,1,1,0,1,1,0,1],[0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1],[1,1,1,1,2,1,1,1,1,1,1,2,1,1,1,1],[1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1],[1,1,1,1,2,1,1,1,2,1,1,1,1,2,1,1],[0,1,1,0,1,1,0,1,1,0,1,1,0,1,1,1],[0,1,1,0,1,0,1,1,0,1,1,0,1,0,1,1],[1,1,1,1,2,1,1,1,1,1,1,2,1,1,1,1],[1,1,1,1,2,1,1,1,2,1,1,1,1,2,1,1],[1,1,2,1,1,2,1,1,1,2,1,1,1,2,1,1],[1,1,1,1,2,1,1,1,2,1,1,1,1,2,1,1],[1,1,2,1,1,1,2,1,1,1,1,2,1,1,1,1],[0,1,1,1,0,1,1,1,1,1,1,0,1,1,1,1],[0,1,1,0,1,0,1,1,0,1,0,1,0,1,0,1],[1,1,2,1,1,1,2,1,1,1,1,2,1,1,1,1],[1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1],[1,1,1,1,2,1,1,1,1,1,1,2,1,1,1,1],[1,1,1,1,2,1,1,1,2,1,1,1,1,2,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,1,1,0,1,0,1,1,0,1,0,1,0,1,0,1],[1,1,2,1,1,1,2,1,1,1,1,2,1,1,1,1],[1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1]];function dt(r,e,t){if(e<1)throw new Error(`invalid level, level: ${e}`);let i;if(e===1)i=0;else if(e>=2&&e<=4)i=1;else if(e>=5&&e<=20)i=2;else if(e>=21)i=3;else throw new Error(`invalid level, level: ${e}`);return gm[i*7+t][r.frames%16]}class Nc{constructor(){this.targetting=void 0,this.name="",this.color="",this.isVisible=!1,this.dir={x:0,y:0},this.pixel={x:0,y:0},this.tile={x:0,y:0},this.tilePixel={x:0,y:0},this.distToMid={x:0,y:0},this.targetTile={x:0,y:0},this.frames=0,this.steps=0,this.isDrawTarget=!1,this.isDrawPath=!1,this.inManualPositionModel=!1}reset(){this.setDir(this.startDirEnum),this.setPos(this.startPixel.x,this.startPixel.y),this.frames=0,this.steps=0,this.targetting=void 0}setPos(e,t){this.pixel.x=e,this.pixel.y=t,this.commitPos()}getTilePixel(e=this.pixel,t={x:0,y:0}){return t.x=e.x%tileSize,t.y=e.y%tileSize,t.x<0&&(t.x+=tileSize),t.y<0&&(t.y+=tileSize),t}commitPos(){map&&map.teleport(this),this.tile.x=Math.floor(this.pixel.x/tileSize),this.tile.y=Math.floor(this.pixel.y/tileSize),this.getTilePixel(this.pixel,this.tilePixel),this.distToMid.x=midTile.x-this.tilePixel.x,this.distToMid.y=midTile.y-this.tilePixel.y}setDir(e){const t=Bi(this.dir,e);if(e===void 0)throw new Error("  ");return this.dirEnum=e,t}update(e){if(this.getNumSteps===void 0)throw new Error("ghost, getNumSteps undefined");const t=this.getNumSteps();if(e>=t)return;const i=this.step();this.steps+=i,this.steer&&this.steer()}step(){throw new Error("step not implemented")}}globalThis.GHOST_OUTSIDE=0;globalThis.GHOST_EATEN=1;globalThis.GHOST_GOING_HOME=2;globalThis.GHOST_ENTERING_HOME=3;globalThis.GHOST_PACING_HOME=4;globalThis.GHOST_LEAVING_HOME=5;class hn extends Nc{constructor(){super(),this.randomScatter=!1,this.faceDirEnum=this.dirEnum,this.mode=GHOST_OUTSIDE,this.startMode=GHOST_PACING_HOME,this.arriveHomeMode=GHOST_PACING_HOME,this.scared=!1,this.elroy=0,this.sigReverse=!1,this.sigLeaveHome=!1,this.steerFuncs={[GHOST_GOING_HOME]:()=>{this.tile.x===map.doorTile.x&&this.tile.y===map.doorTile.y&&(this.faceDirEnum=DIR_DOWN,this.targetting=void 0,this.pixel.x===map.doorPixel.x?(this.mode!==GHOST_ENTERING_HOME&&playState.addGhostSoundPoint(-Ks.GOING_HOME),this.mode=GHOST_ENTERING_HOME,this.setDir(DIR_DOWN),this.faceDirEnum=this.dirEnum):(this.setDir(DIR_RIGHT),this.faceDirEnum=this.dirEnum))},[GHOST_ENTERING_HOME]:()=>{this.pixel.y===map.homeBottomPixel&&(this.pixel.x===this.startPixel.x?(this.setDir(DIR_UP),this.mode=this.arriveHomeMode):this.setDir(this.startPixel.x<this.pixel.x?DIR_LEFT:DIR_RIGHT),this.faceDirEnum=this.dirEnum)},[GHOST_PACING_HOME]:()=>{this.sigLeaveHome?(this.sigLeaveHome=!1,this.mode=GHOST_LEAVING_HOME,this.pixel.x===map.doorPixel.x?this.setDir(DIR_UP):this.setDir(this.pixel.x<map.doorPixel.x?DIR_RIGHT:DIR_LEFT)):this.pixel.y===map.homeTopPixel?this.setDir(DIR_DOWN):this.pixel.y===map.homeBottomPixel&&this.setDir(DIR_UP),this.faceDirEnum=this.dirEnum},[GHOST_LEAVING_HOME]:()=>{this.pixel.x===map.doorPixel.x&&(this.pixel.y===map.doorPixel.y?(this.mode=GHOST_OUTSIDE,this.setDir(DIR_LEFT)):this.setDir(DIR_UP),this.faceDirEnum=this.dirEnum)}},this.resetGetNumSteps(),this.resetSteer()}resetGetNumSteps(){this.getNumSteps=()=>{let e=STEP_GHOST;return this.mode===GHOST_GOING_HOME||this.mode===GHOST_ENTERING_HOME?2:this.mode===GHOST_LEAVING_HOME||this.mode===GHOST_PACING_HOME?dt(this,1,STEP_GHOST_TUNNEL):(map.isTunnelTile(this.tile.x,this.tile.y)&&this.isSlowInTunnel()?e=STEP_GHOST_TUNNEL:this.scared?e=STEP_GHOST_FRIGHT:this.elroy===1?e=STEP_ELROY1:this.elroy===2&&(e=STEP_ELROY2),dt(this,level||1,e))}}resetSteer(){this.steer=()=>this.defaultSteer()}defaultSteer(){let e=DIR_LEFT,t,i=Br(this.dirEnum),s;if(this.homeSteer(),this.mode!==GHOST_OUTSIDE&&this.mode!==GHOST_GOING_HOME){this.targetting=void 0;return}if(this.distToMid.x===0&&this.distToMid.y===0)this.sigReverse&&(this.faceDirEnum=i,this.sigReverse=!1),this.setDir(this.faceDirEnum);else if(this.dirEnum===DIR_RIGHT&&this.tilePixel.x===midTile.x+1||this.dirEnum===DIR_LEFT&&this.tilePixel.x===midTile.x-1||this.dirEnum===DIR_UP&&this.tilePixel.y===midTile.y-1||this.dirEnum===DIR_DOWN&&this.tilePixel.y===midTile.y+1){const n={x:this.tile.x+this.dir.x,y:this.tile.y+this.dir.y};if(t=al(n,this.dirEnum),this.scared){for(e=Math.floor(Math.random()*4);!t[e];)e=(e+1)%4;this.targetting=void 0}else{this.mode===GHOST_GOING_HOME?(this.targetTile.x=map.doorTile.x,this.targetTile.y=map.doorTile.y):!this.elroy&&ghostCommander.getCommand()===GHOST_CMD_SCATTER?(s=this.isScatterBrain()?actors[Math.floor(Math.random()*4)]:this,s.cornerTile!==void 0&&(this.targetTile.x=s.cornerTile.x,this.targetTile.y=s.cornerTile.y,this.targetting="corner")):this.setTarget();let a=!1;if(this.mode===GHOST_GOING_HOME&&map.getExitDir){const o=map.getExitDir(n.x,n.y);o!==void 0&&o!==i&&(a=!0,e=o)}a||(this.mode!==GHOST_GOING_HOME&&map.constrainGhostTurns&&map.constrainGhostTurns(n,t,this.dirEnum),e=nl(n,this.targetTile,t))}this.faceDirEnum=e}}getAnimFrame(e=this.frames){return Math.floor(e/8)%2}reset(){this.sigReverse=!1,this.sigLeaveHome=!1,this.mode=this.startMode,this.scared=!1,super.reset(),this.faceDirEnum=this.dirEnum}isSlowInTunnel(){return!0}reverse(){this.sigReverse=!0}goHome(){this.mode=GHOST_EATEN,playState.addGhostSoundPoint(Ks.GOING_HOME)}leaveHome(){this.sigLeaveHome=!0}onEnergized(){this.reverse(),this.mode!==GHOST_GOING_HOME&&this.mode!==GHOST_ENTERING_HOME&&(this.scared=!0,this.targetting=void 0)}onEaten(){this.goHome(),this.scared=!1}step(){return this.inManualPositionModel||this.setPos(this.pixel.x+this.dir.x,this.pixel.y+this.dir.y),1}homeSteer(){const e=this.steerFuncs[this.mode];e&&e.apply(this)}isScatterBrain(){let e=!1;return ghostCommander.getCommand(),GHOST_CMD_SCATTER,e}setTarget(){if(this.getTargetTile===void 0)throw new Error("invalid getTargetTile");this.targetTile=this.getTargetTile(),this!==clyde&&(this.targetting="pacman")}}function mm(r){return r<0?-1:r>0?1:0}class xm extends Nc{constructor(){super(),this.inputDirEnum=void 0,this.nextDir={x:0,y:0},this.ai=!1,this.invincible=RF_DEBUG_PACMAN_INVINCIBLE,this.stopped=!1,this.eatPauseFramesLeft=0,this.savedNextDirEnum={},this.savedStopped={},this.savedEatPauseFramesLeft={},this.resetGetNumSteps(),this.resetSteer()}resetGetNumSteps(){this.getNumSteps=()=>{const e=energizer.isActive()?STEP_PACMAN_FRIGHT:STEP_PACMAN;return dt(this,level,e)}}resetSteer(){this.steer=()=>this.defaultSteer()}defaultSteer(){if(this.ai){if(this.distToMid.x!==0||this.distToMid.y!==0)return;const e=al(this.tile,this.dirEnum);this.setTarget!==void 0&&this.setTarget(),this.setNextDir(nl(this.tile,this.targetTile,e))}else this.targetting=void 0;if(this.inputDirEnum===void 0)this.stopped&&this.setDir(this.nextDirEnum);else{const e={x:0,y:0};Bi(e,this.inputDirEnum),Xo(this.tile,e)?(this.setDir(this.inputDirEnum),this.setNextDir(this.inputDirEnum),this.stopped=!1):this.stopped||this.setNextDir(this.inputDirEnum)}}reset(){this.setNextDir(this.startDirEnum),this.stopped=!1,this.inputDirEnum=void 0,this.eatPauseFramesLeft=0,super.reset()}setNextDir(e){e===void 0?console.error("set-next-dir , "):(Bi(this.nextDir,e),this.nextDirEnum=e)}getStepFrame(e){return e===void 0&&(e=this.steps),Math.floor(e/2)%4}getAnimFrame(e){return e===void 0&&(e=this.getStepFrame()),e===3&&(e=1),e}setInputDir(e){this.inputDirEnum=e}clearInputDir(e){(e===void 0||this.inputDirEnum===e)&&(this.inputDirEnum=void 0)}step(){if(this.inManualPositionModel)return 1;if(!map)return this.setPos(this.pixel.x+this.dir.x,this.pixel.y+this.dir.y),1;const e=this.dir.x!==0?"x":"y",t=this.dir.x!==0?"y":"x";return this.stopped=this.stopped||this.distToMid[e]===0&&!Xo(this.tile,this.dir),this.stopped||(this.pixel[e]+=this.dir[e],this.pixel[t]+=mm(this.distToMid[t])),this.commitPos(),this.stopped?0:1}update(e){if(this.getNumSteps===void 0)throw new Error("player, getNumSteps undefined");const t=this.getNumSteps();if(!(e>=t)){if(this.eatPauseFramesLeft>0){e===t-1&&this.eatPauseFramesLeft--;return}if(super.update(e),map){const i=map.getTile(this.tile.x,this.tile.y);(i==="."||i==="o")&&(this.eatPauseFramesLeft=i==="."?1:3,map.onDotEat(this.tile.x,this.tile.y),ghostReleaser.onDotEat(),fruit.onDotEat(),Yr(i==="."?10:50),X().drawPelletCounter(pacman.pixel.x,pacman.pixel.y,map.dotsEaten),i==="o"&&energizer.activate(),ie().play(Q.EATING_COOKIE,!1))}}}setTarget(){blinky.mode===GHOST_GOING_HOME||blinky.scared?(this.targetTile.x=pinky.tile.x,this.targetTile.y=pinky.tile.y,this.targetting="pinky"):(this.targetTile.x=pinky.tile.x+2*(pacman.tile.x-pinky.tile.x),this.targetTile.y=pinky.tile.y+2*(pacman.tile.y-pinky.tile.y),this.targetting="flee")}}function ym(){const r=new hn;r.name="blinky",r.color="#FF0000",r.isVisible=!0,r.startDirEnum=DIR_LEFT,r.startPixel={x:14*tileSize-1,y:14*tileSize+midTile.y},r.cornerTile={x:25,y:0},r.startMode=GHOST_OUTSIDE,r.arriveHomeMode=GHOST_LEAVING_HOME,r.getTargetTile=()=>({x:pacman.tile.x,y:pacman.tile.y}),r.getTargetPixel=()=>({x:pacman.pixel.x,y:pacman.pixel.y}),globalThis.blinky=r}function Sm(){const r=new hn;r.name="pinky",r.color="#FFB8FF",r.isVisible=!0,r.startDirEnum=DIR_DOWN,r.startPixel={x:14*tileSize-1,y:17*tileSize+midTile.y},r.cornerTile={x:2,y:0},r.startMode=GHOST_PACING_HOME,r.arriveHomeMode=GHOST_PACING_HOME,r.getTargetTile=()=>{var e=pacman.tile.x+4*pacman.dir.x,t=pacman.tile.y+4*pacman.dir.y;return pacman.dirEnum===DIR_UP&&(e-=4),{x:e,y:t}},r.getTargetPixel=function(){var e=pacman.pixel.x+4*pacman.dir.x*tileSize,t=pacman.pixel.y+4*pacman.dir.y*tileSize;return pacman.dirEnum===DIR_UP&&(e-=4*tileSize),{x:e,y:t}},globalThis.pinky=r}function Tm(){const r=new hn;r.name="inky",r.color="#00FFFF",r.isVisible=!0,r.startDirEnum=DIR_UP,r.startPixel={x:12*tileSize-1,y:17*tileSize+midTile.y},r.cornerTile={x:27,y:34},r.startMode=GHOST_PACING_HOME,r.arriveHomeMode=GHOST_PACING_HOME,r.getTargetTile=()=>{var e=pacman.tile.x+2*pacman.dir.x,t=pacman.tile.y+2*pacman.dir.y;return pacman.dirEnum===DIR_UP&&(e-=2),{x:blinky.tile.x+2*(e-blinky.tile.x),y:blinky.tile.y+2*(t-blinky.tile.y)}},r.getTargetPixel=()=>{var e=pacman.pixel.x+2*pacman.dir.x*tileSize,t=pacman.pixel.y+2*pacman.dir.y*tileSize;return pacman.dirEnum===DIR_UP&&(e-=2*tileSize),{x:blinky.pixel.x+2*(e-blinky.pixel.x),y:blinky.pixel.y+2*(t-blinky.pixel.y)}},globalThis.inky=r}function wm(){const r=new hn;r.name="clyde",r.color="#FFB851",r.isVisible=!0,r.startDirEnum=DIR_UP,r.startPixel={x:16*tileSize-1,y:17*tileSize+midTile.y},r.cornerTile={x:0,y:34},r.startMode=GHOST_PACING_HOME,r.arriveHomeMode=GHOST_PACING_HOME,r.getTargetTile=()=>{var e=pacman.tile.x-(r.tile.x+r.dir.x),t=pacman.tile.y-(r.tile.y+r.dir.y),i=e*e+t*t;if(i>=64)return r.targetting="pacman",{x:pacman.tile.x,y:pacman.tile.y};if(r.targetting="corner",!r.cornerTile)throw new Error("clyde cornerTile is undefined");return{x:r.cornerTile.x,y:r.cornerTile.y}},r.getTargetPixel=function(){return{x:pacman.pixel.x,y:pacman.pixel.y}},globalThis.clyde=r}function vm(){const r=new xm;r.name="pacman",r.color="#FFFF00",r.startDirEnum=DIR_LEFT,r.startPixel={x:14*tileSize-1,y:26*tileSize+midTile.y},globalThis.pacman=r,globalThis.actors=[blinky,pinky,inky,clyde,r],globalThis.ghosts=[blinky,pinky,inky,clyde]}function bm(){ym(),Sm(),Tm(),wm(),vm()}class Am{constructor(){this.actorSize=(tileSize-1)*2,this.energizerSize=tileSize,this.pointsEarnedTextSize=tileSize,this.flashLevel=!1,this.resets=0,this.messageRow=20,this.pelletSize=2,this.name="Arcade"}drawNoGroutTile(e,t,i,s){throw new Error("no impl.")}drawCenterTileSq(e,t,i,s,n,a,o){throw new Error("no impl.")}toggleLevelFlash(){this.flashLevel=!this.flashLevel}setLevelFlash(e){e!==this.flashLevel&&(this.flashLevel=e,this.drawMap())}erasePellet(e,t,i){X().pelletManager.hidePellet(e,t)}refreshPellet(e,t,i){const s=map.posToIndex(e,t),n=map.currentTiles[s];n===" "?(this.erasePellet(e,t,i),X().pelletManager.hidePellet(e,t)):n==="."?X().pelletManager.showPellet(e,t,!1):n==="o"&&X().pelletManager.showPellet(e,t,!0)}drawMessage(e,t,i,s){throw new Error("not implemented")}drawReadyMessage(){throw new Error("not implemented")}drawEatenPoints(){rfAtlas.drawGhostPoints(null,pacman.pixel.x,pacman.pixel.y,energizer.getPoints())}drawActors(e){let t;if(energizer.isActive()){for(t=0;t<4;t++){const i=ghosts[t];(!e||!e.includes(i.name))&&this.drawGhost(i)}energizer.showingPoints()?this.drawEatenPoints():this.drawPlayer()}else{for(this.drawPlayer(),t=3;t>=0;t--)ghosts[t].isVisible&&this.drawGhost(ghosts[t]);inky.isVisible&&!blinky.isVisible&&this.drawGhost(blinky,.5)}}drawGhost(e,t){if(e.mode===GHOST_EATEN){X().ghostByName(e.name).setEaten();return}const i=e.getAnimFrame(e.frames),s=e.mode===GHOST_GOING_HOME||e.mode===GHOST_ENTERING_HOME,n=e.pixel.y,a=e===blinky&&e.scared?e.pixel.x+1:e.pixel.x;rfAtlas.drawGhostSprite(a,n,i,e.faceDirEnum,e.scared,energizer.isFlash(),s,e.color)}drawPlayer(){const e=pacman.getAnimFrame(pacman.getStepFrame(pacman.steps)),t=rfAtlas.drawPacmanSprite;t(null,pacman.pixel.x,pacman.pixel.y,pacman.dirEnum,e)}drawFruit(){if(fruit.getCurrentFruit()){const e=fruit.getCurrentFruit().name;fruit.isPresent()?rfAtlas.drawFruitSprite(null,fruit.pixel.x,fruit.pixel.y,e):fruit.isScorePresent()&&rfAtlas.drawPacFruitPoints(null,fruit.pixel.x,fruit.pixel.y,fruit.getPoints())}}drawMap(e){if(map)for(let t=0;t<map.numRows;t++)for(let i=0;i<map.numCols;i++)this.refreshPellet(i,t,!0)}drawScore(){}blitMap(){PIXI_RENDERER.blitMap()}}function Pm(){globalThis.renderer=new Am}class km{constructor(){this.pointsDuration=1,this.flashInterval=14,this.count=0,this.active=!1,this.points=100,this.pointsFramesLeft=0,this.savedCount={},this.savedActive={},this.savedPoints={},this.savedPointsFramesLeft={},this.seconds=RF_ENERGIZER_DURATIONS,this.flashes=[5,5,5,5,5,5,5,5,3,5,5,3,3,5,3,3,0,3]}getDuration(){const e=Math.min(level,18);return Math.floor(60*this.seconds[e-1])}getFlashes(){const e=Math.min(level,18);return this.flashes[e-1]}reset(){this.count=0,this.active=!1,this.points=100,this.pointsFramesLeft=0;for(let e=0;e<4;e++)ghosts[e].scared=!1;playState!==null&&state===playState&&playState.addGhostSoundPoint(-Ks.ENERGIZER)}update(){this.active&&(this.count===this.getDuration()?this.reset():this.count++)}activate(){this.active=!0,this.count=0,this.points=100;for(let e=0;e<4;e++)ghosts[e].onEnergized();playState.addGhostSoundPoint(Ks.ENERGIZER),this.getDuration()===0&&this.reset()}isActive(){return this.active}isFlash(){const e=Math.floor((this.getDuration()-this.count)/this.flashInterval);return e<=2*this.getFlashes()-1?e%2===0:!1}getPoints(){return this.points}addPoints(e){this.points*=2,e===void 0&&Yr(this.points),this.pointsFramesLeft=this.pointsDuration*60}showingPoints(){return this.pointsFramesLeft>0}updatePointsTimer(){this.pointsFramesLeft>0&&this.pointsFramesLeft--}}function Em(){globalThis.energizer=new km}class Cm{drawGhostSprite(e,t,i,s,n,a,o,l){X().drawGhost(e,t,s,i,n,a,o,l)}drawPacmanSprite(e,t,i,s,n){X().drawPlayer(t,i,s,n)}drawFruitSprite(e,t,i,s){te().game.fruit.update(t,i,s)}drawGhostPoints(e,t,i,s){X().drawPlayerEatenPoints(t,i,s)}drawPacFruitPoints(e,t,i,s){X().drawFruitPoints(t,i,s)}}function Mm(){globalThis.rfAtlas=new Cm}class Xt{constructor(e){this.name=e}init(){}update(){}draw(){}hide(){}setAlpha(e){}exitTo(e,t){}exitToPrevState(e){}}class Im extends Xt{constructor(e,t,i,s){super(De.FADE_TO),this.nextStateName=t.name,this.frames=0,this.prevState=e,this.nextState=t,this.frameDuration=i,this.midFrameCallback=s,this.midFrame=Math.floor(i/2)}getStateTime(){return this.frames/this.frameDuration*2+(this.frames<this.midFrame?0:-1)}draw(){const e=this.getStateTime();this.frames<this.midFrame?(this.prevState.setAlpha(1-e),this.prevState.draw()):this.frames===this.midFrame||this.frames<=this.frameDuration&&(this.nextState.setAlpha(e),this.nextState.draw())}update(){this.frames+=1,this.frames<this.midFrame?this.prevState.update():this.frames===this.midFrame?(this.midFrameCallback&&this.midFrameCallback(),this.nextState.init()):this.frames<=this.frameDuration?this.nextState.update():(console.log(`rf-fade-next-state, --> ${this.nextState.name}`),state=this.nextState,this.prevState.hide(),this.prevState.setAlpha(1),this.nextState.setAlpha(1))}}var De=(r=>(r.NONE="NONE",r.LOADING="LOADING",r.INTRO="INTRO",r.INFO="INFO",r.NEW_GAME="NEW_GAME",r.READY="READY",r.READY_NEW="READY_NEW",r.READY_RESTART="READY_RESTART",r.PLAY="PLAY",r.DEAD="DEAD",r.OVER="OVER",r.HIGH_SCORE="HIGH_SCORE",r.CONGRA_SCORE="CONGRA_SCORE",r.FINISH="FINISH",r.FADE_TO="FADE_TO",r))(De||{});globalThis.state=new Xt("NONE");globalThis.G_prevState=new Xt("NONE");function Si(r,e,t){console.log(`rf-switch-state, ${state.name} --> ${r.name}`),G_prevState=state,e?state=new Im(state,r,e,t):(t&&t(),state=r),state.init()}globalThis.switchState=Si;class Rm extends Vt{constructor(){super(PIXI_RENDERER.getRootLayer(),Ct.SKIN),this.skinStore=te().skin,this.statesSkinButtonEnabled=[De.INTRO,De.INFO];const e=skinMarginT+65+130+30;this.skinBackSS=new O(this.layer,["asset/assets3/skin_back_00black.png","asset/assets3/skin_back_01gray.png","asset/assets3/skin_back_02lightgray.png","asset/assets3/skin_back_03skyblue.png","asset/assets3/skin_back_04green.png","asset/assets3/skin_back_05yellow.png","asset/assets3/skin_back_06red.png"],0,0,0,0,skinWidth,skinHeight),this.gameScreenSS=new O(this.layer,["asset/assets3/game_screen.png"],.5,0,skinWidth/2,e,700,865),this.infoButtonSS=new O(this.layer,["//btn/btn_info.png"],1,0,skinWidth-75-70-30,skinMainPanelB+35,70,70,t=>{this.onInfoButtonClicked()}),this.skinButtonSS=new O(this.layer,["//btn/btn_skin_00black.png","//btn/btn_skin_01gray.png","//btn/btn_skin_02lightgray.png","//btn/btn_skin_03skyblue.png","//btn/btn_skin_04green.png","//btn/btn_skin_05yellow.png","//btn/btn_skin_06red.png"],1,0,skinWidth-75,skinMainPanelB+35,70,70,t=>{this.onSkinButtonClicked()})}draw(){switch(this.skinStore.selectedSkin){case xe.BLACK:this.skinBackSS.setTextureIndex(0),this.skinButtonSS.setTextureIndex(0);break;case xe.GRAY:this.skinBackSS.setTextureIndex(1),this.skinButtonSS.setTextureIndex(1);break;case xe.LIGHT_GRAY:this.skinBackSS.setTextureIndex(2),this.skinButtonSS.setTextureIndex(2);break;case xe.SKY_BLUE:this.skinBackSS.setTextureIndex(3),this.skinButtonSS.setTextureIndex(3);break;case xe.GREEN:this.skinBackSS.setTextureIndex(4),this.skinButtonSS.setTextureIndex(4);break;case xe.YELLOW:this.skinBackSS.setTextureIndex(5),this.skinButtonSS.setTextureIndex(5);break;case xe.RED:this.skinBackSS.setTextureIndex(6),this.skinButtonSS.setTextureIndex(6);break}this.skinBackSS.draw(),this.gameScreenSS.draw(),this.statesSkinButtonEnabled.includes(state.name)?(this.infoButtonSS.setAlpha(1),this.skinButtonSS.setAlpha(1)):(this.infoButtonSS.setAlpha(.4),this.skinButtonSS.setAlpha(.4)),this.infoButtonSS.draw(),this.skinButtonSS.draw()}hide(){this.layer.visible=!1}onInfoButtonClicked(){this.statesSkinButtonEnabled.includes(state.name)&&state.exitTo(infoState)}onSkinButtonClicked(){this.statesSkinButtonEnabled.includes(state.name)&&(this.skinStore.showSkinMenu=!0)}}var Xn=null;function hi(){return Xn===null&&(Xn=new Rm),Xn}class Lm extends Vt{constructor(){super(PIXI_RENDERER.getRootLayer(),Ct.STATE),this.panelTop=skinMarginT+65;const t=ai().getTexture("asset/assets3/bg_score.png");this.spriteScoreBg=new j(t),this.spriteScoreBg.anchor.set(.5,0),this.spriteScoreBgPps=new Rc(this.spriteScoreBg,screenWidth/2,Z(this.panelTop),Z(380),Z(130),"sprite-score-bg"),this.spriteScoreBg.visible=!1,this.layer.addChild(this.spriteScoreBg),this.titleST=new ne(this.layer,"STAGE","#3CDC00","left",0,0,skinWidth/2-80,this.panelTop+25,9),this.scoreLabelST=new ne(this.layer,"SCORE","#999999","center",.5,0,skinWidth/2-120,this.panelTop+25+55,Z(17)),this.scoreST=new ne(this.layer,"0","#fff","right",1,0,skinWidth/2+380/2-20,this.panelTop+25+50,Z(30))}setTitle(e){this.titleST.setText(e)}draw(){const e=te();this.spriteScoreBgPps.scaleAndShow(),e.game.score.visible?(this.titleST.setText(`STAGE ${level}`),this.titleST.setAlpha(1),this.titleST.draw(),this.scoreLabelST.setAlpha(1),this.scoreLabelST.draw(),this.scoreST.setAlpha(1),this.scoreST.drawFromModel(e.game.score)):(this.titleST.setText("STAGE 0"),this.titleST.setAlpha(.2),this.titleST.draw(),this.scoreLabelST.setAlpha(.2),this.scoreLabelST.draw(),this.scoreST.setText("-"),this.scoreST.setAlpha(.2),this.scoreST.draw())}hide(){this.spriteScoreBg.visible=!1}show(){this.spriteScoreBg.visible=!0}}var $n=null;function li(){return $n===null&&($n=new Lm),$n}class nr extends Xt{constructor(e){super(e),this.triggerFrame=0,this.frames=0,this.paused=!1,this.triggers={}}init(){this.frames=0,this.triggerFrame=0}update(){const e=this.triggers[this.frames];e&&(e.init&&e.init(),this.drawFunc=e.draw,this.updateFunc=e.update,this.triggerFrame=0),this.updateFunc&&this.updateFunc(this.triggerFrame),!this.paused&&(this.frames++,this.triggerFrame++)}pause(){this.paused=!0}resume(){this.paused=!1}draw(){this.drawFunc&&this.drawFunc(this.triggerFrame)}}class Fm extends nr{constructor(){super(De.DEAD),this.gameStore=null,this.pixiSkinPanel=null,this.pixiScorePanel=null,this.pixiGamePanel=null,this.sfxFired=!1,this.triggers={0:{update:()=>{for(let e=0;e<4;e++)actors[e].frames++},draw:()=>{var e,t;this.commonDraw(),(e=this.pixiGamePanel)==null||e.drawFruit(),(t=this.pixiGamePanel)==null||t.showActor()}},60:{draw:()=>{var e,t,i;this.commonDraw(),(e=this.pixiGamePanel)==null||e.hideFruit(),(t=this.pixiGamePanel)==null||t.hideGhosts(),(i=this.pixiGamePanel)==null||i.showPlayer()}},113:{draw:()=>{this.sfxFired||(ie().play(Q.MISS,!1),this.sfxFired=!0)}},120:{draw:e=>{var t,i,s;if(e===void 0)throw new Error("missing t");this.commonDraw(),(t=this.pixiGamePanel)==null||t.hideFruit(),(i=this.pixiGamePanel)==null||i.hideGhosts(),(s=this.pixiGamePanel)==null||s.drawDyingPlayer(e/75)}},195:{draw:()=>{var e,t,i;this.commonDraw(),(e=this.pixiGamePanel)==null||e.hideFruit(),(t=this.pixiGamePanel)==null||t.hideGhosts(),(i=this.pixiGamePanel)==null||i.drawDyingPlayer(1)}},240:{init:()=>{switchState(extraLives===0?overState:readyRestartState)},draw:()=>{var e,t,i;this.commonDraw(),(e=this.pixiGamePanel)==null||e.hideFruit(),(t=this.pixiGamePanel)==null||t.hideGhosts(),(i=this.pixiGamePanel)==null||i.drawDyingPlayer(1)}}}}init(){executive.setUpdatesPerSecond(60),this.gameStore=te().game,this.pixiSkinPanel=hi(),this.pixiScorePanel=li(),this.pixiGamePanel=X(),executive.setUpdatesPerSecond(60),this.sfxFired=!1,super.init()}commonDraw(){var e,t;(e=this.pixiSkinPanel)==null||e.draw(),(t=this.pixiScorePanel)==null||t.draw()}}function Om(){globalThis.deadState=new Fm}function Zt(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Bc(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.__proto__=e}/*!
 * GSAP 3.12.5
 * https://gsap.com
 *
 * @license Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var pt={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},_s={duration:.5,overwrite:!1,delay:0},ho,We,fe,Tt=1e8,ce=1/Tt,La=Math.PI*2,Nm=La/4,Bm=0,Gc=Math.sqrt,Gm=Math.cos,Dm=Math.sin,Oe=function(e){return typeof e=="string"},ye=function(e){return typeof e=="function"},si=function(e){return typeof e=="number"},lo=function(e){return typeof e>"u"},Wt=function(e){return typeof e=="object"},tt=function(e){return e!==!1},co=function(){return typeof window<"u"},Ir=function(e){return ye(e)||Oe(e)},Dc=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},Ye=Array.isArray,Fa=/(?:-?\.?\d|\.)+/gi,Hc=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,is=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,jn=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,Uc=/[+-]=-?[.\d]+/,zc=/[^,'"\[\]\s]+/gi,Hm=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,_e,Gt,Oa,uo,_t={},Vr={},Wc,Yc=function(e){return(Vr=Yi(e,_t))&&nt},fo=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},Zs=function(e,t){return!t&&console.warn(e)},Vc=function(e,t){return e&&(_t[e]=t)&&Vr&&(Vr[e]=t)||_t},Qs=function(){return 0},Um={suppressEvents:!0,isStart:!0,kill:!1},Fr={suppressEvents:!0,kill:!1},zm={suppressEvents:!0},po={},_i=[],Na={},Xc,ct={},qn={},Dh=30,Or=[],_o="",go=function(e){var t=e[0],i,s;if(Wt(t)||ye(t)||(e=[e]),!(i=(t._gsap||{}).harness)){for(s=Or.length;s--&&!Or[s].targetTest(t););i=Or[s]}for(s=e.length;s--;)e[s]&&(e[s]._gsap||(e[s]._gsap=new gu(e[s],i)))||e.splice(s,1);return e},Di=function(e){return e._gsap||go(wt(e))[0]._gsap},$c=function(e,t,i){return(i=e[t])&&ye(i)?e[t]():lo(i)&&e.getAttribute&&e.getAttribute(t)||i},it=function(e,t){return(e=e.split(",")).forEach(t)||e},ve=function(e){return Math.round(e*1e5)/1e5||0},Fe=function(e){return Math.round(e*1e7)/1e7||0},hs=function(e,t){var i=t.charAt(0),s=parseFloat(t.substr(2));return e=parseFloat(e),i==="+"?e+s:i==="-"?e-s:i==="*"?e*s:e/s},Wm=function(e,t){for(var i=t.length,s=0;e.indexOf(t[s])<0&&++s<i;);return s<i},Xr=function(){var e=_i.length,t=_i.slice(0),i,s;for(Na={},_i.length=0,i=0;i<e;i++)s=t[i],s&&s._lazy&&(s.render(s._lazy[0],s._lazy[1],!0)._lazy=0)},jc=function(e,t,i,s){_i.length&&!We&&Xr(),e.render(t,i,We&&t<0&&(e._initted||e._startAt)),_i.length&&!We&&Xr()},qc=function(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match(zc).length<2?t:Oe(e)?e.trim():e},Kc=function(e){return e},vt=function(e,t){for(var i in t)i in e||(e[i]=t[i]);return e},Ym=function(e){return function(t,i){for(var s in i)s in t||s==="duration"&&e||s==="ease"||(t[s]=i[s])}},Yi=function(e,t){for(var i in t)e[i]=t[i];return e},Hh=function r(e,t){for(var i in t)i!=="__proto__"&&i!=="constructor"&&i!=="prototype"&&(e[i]=Wt(t[i])?r(e[i]||(e[i]={}),t[i]):t[i]);return e},$r=function(e,t){var i={},s;for(s in e)s in t||(i[s]=e[s]);return i},Us=function(e){var t=e.parent||_e,i=e.keyframes?Ym(Ye(e.keyframes)):vt;if(tt(e.inherit))for(;t;)i(e,t.vars.defaults),t=t.parent||t._dp;return e},Vm=function(e,t){for(var i=e.length,s=i===t.length;s&&i--&&e[i]===t[i];);return i<0},Zc=function(e,t,i,s,n){var a=e[s],o;if(n)for(o=t[n];a&&a[n]>o;)a=a._prev;return a?(t._next=a._next,a._next=t):(t._next=e[i],e[i]=t),t._next?t._next._prev=t:e[s]=t,t._prev=a,t.parent=t._dp=e,t},ln=function(e,t,i,s){i===void 0&&(i="_first"),s===void 0&&(s="_last");var n=t._prev,a=t._next;n?n._next=a:e[i]===t&&(e[i]=a),a?a._prev=n:e[s]===t&&(e[s]=n),t._next=t._prev=t.parent=null},mi=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},Hi=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var i=e;i;)i._dirty=1,i=i.parent;return e},Xm=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},Ba=function(e,t,i,s){return e._startAt&&(We?e._startAt.revert(Fr):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,s))},$m=function r(e){return!e||e._ts&&r(e.parent)},Uh=function(e){return e._repeat?gs(e._tTime,e=e.duration()+e._rDelay)*e:0},gs=function(e,t){var i=Math.floor(e/=t);return e&&i===e?i-1:i},jr=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},cn=function(e){return e._end=Fe(e._start+(e._tDur/Math.abs(e._ts||e._rts||ce)||0))},un=function(e,t){var i=e._dp;return i&&i.smoothChildTiming&&e._ts&&(e._start=Fe(i._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),cn(e),i._dirty||Hi(i,e)),e},Qc=function(e,t){var i;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(i=jr(e.rawTime(),t),(!t._dur||ar(0,t.totalDuration(),i)-t._tTime>ce)&&t.render(i,!0)),Hi(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(i=e;i._dp;)i.rawTime()>=0&&i.totalTime(i._tTime),i=i._dp;e._zTime=-ce}},Dt=function(e,t,i,s){return t.parent&&mi(t),t._start=Fe((si(i)?i:i||e!==_e?xt(e,i,t):e._time)+t._delay),t._end=Fe(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),Zc(e,t,"_first","_last",e._sort?"_start":0),Ga(t)||(e._recent=t),s||Qc(e,t),e._ts<0&&un(e,e._tTime),e},Jc=function(e,t){return(_t.ScrollTrigger||fo("scrollTrigger",t))&&_t.ScrollTrigger.create(t,e)},eu=function(e,t,i,s,n){if(xo(e,t,n),!e._initted)return 1;if(!i&&e._pt&&!We&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&Xc!==ut.frame)return _i.push(e),e._lazy=[n,s],1},jm=function r(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||r(t))},Ga=function(e){var t=e.data;return t==="isFromStart"||t==="isStart"},qm=function(e,t,i,s){var n=e.ratio,a=t<0||!t&&(!e._start&&jm(e)&&!(!e._initted&&Ga(e))||(e._ts<0||e._dp._ts<0)&&!Ga(e))?0:1,o=e._rDelay,l=0,c,u,h;if(o&&e._repeat&&(l=ar(0,e._tDur,t),u=gs(l,o),e._yoyo&&u&1&&(a=1-a),u!==gs(e._tTime,o)&&(n=1-a,e.vars.repeatRefresh&&e._initted&&e.invalidate())),a!==n||We||s||e._zTime===ce||!t&&e._zTime){if(!e._initted&&eu(e,t,s,i,l))return;for(h=e._zTime,e._zTime=t||(i?ce:0),i||(i=t&&!h),e.ratio=a,e._from&&(a=1-a),e._time=0,e._tTime=l,c=e._pt;c;)c.r(a,c.d),c=c._next;t<0&&Ba(e,t,i,!0),e._onUpdate&&!i&&ft(e,"onUpdate"),l&&e._repeat&&!i&&e.parent&&ft(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===a&&(a&&mi(e,1),!i&&!We&&(ft(e,a?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},Km=function(e,t,i){var s;if(i>t)for(s=e._first;s&&s._start<=i;){if(s.data==="isPause"&&s._start>t)return s;s=s._next}else for(s=e._last;s&&s._start>=i;){if(s.data==="isPause"&&s._start<t)return s;s=s._prev}},ms=function(e,t,i,s){var n=e._repeat,a=Fe(t)||0,o=e._tTime/e._tDur;return o&&!s&&(e._time*=a/e._dur),e._dur=a,e._tDur=n?n<0?1e10:Fe(a*(n+1)+e._rDelay*n):a,o>0&&!s&&un(e,e._tTime=e._tDur*o),e.parent&&cn(e),i||Hi(e.parent,e),e},zh=function(e){return e instanceof qe?Hi(e):ms(e,e._dur)},Zm={_start:0,endTime:Qs,totalDuration:Qs},xt=function r(e,t,i){var s=e.labels,n=e._recent||Zm,a=e.duration()>=Tt?n.endTime(!1):e._dur,o,l,c;return Oe(t)&&(isNaN(t)||t in s)?(l=t.charAt(0),c=t.substr(-1)==="%",o=t.indexOf("="),l==="<"||l===">"?(o>=0&&(t=t.replace(/=/,"")),(l==="<"?n._start:n.endTime(n._repeat>=0))+(parseFloat(t.substr(1))||0)*(c?(o<0?n:i).totalDuration()/100:1)):o<0?(t in s||(s[t]=a),s[t]):(l=parseFloat(t.charAt(o-1)+t.substr(o+1)),c&&i&&(l=l/100*(Ye(i)?i[0]:i).totalDuration()),o>1?r(e,t.substr(0,o-1),i)+l:a+l)):t==null?a:+t},zs=function(e,t,i){var s=si(t[1]),n=(s?2:1)+(e<2?0:1),a=t[n],o,l;if(s&&(a.duration=t[1]),a.parent=i,e){for(o=a,l=i;l&&!("immediateRender"in o);)o=l.vars.defaults||{},l=tt(l.vars.inherit)&&l.parent;a.immediateRender=tt(o.immediateRender),e<2?a.runBackwards=1:a.startAt=t[n-1]}return new be(t[0],a,t[n+1])},Ti=function(e,t){return e||e===0?t(e):t},ar=function(e,t,i){return i<e?e:i>t?t:i},He=function(e,t){return!Oe(e)||!(t=Hm.exec(e))?"":t[1]},Qm=function(e,t,i){return Ti(i,function(s){return ar(e,t,s)})},Da=[].slice,tu=function(e,t){return e&&Wt(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&Wt(e[0]))&&!e.nodeType&&e!==Gt},Jm=function(e,t,i){return i===void 0&&(i=[]),e.forEach(function(s){var n;return Oe(s)&&!t||tu(s,1)?(n=i).push.apply(n,wt(s)):i.push(s)})||i},wt=function(e,t,i){return fe&&!t&&fe.selector?fe.selector(e):Oe(e)&&!i&&(Oa||!xs())?Da.call((t||uo).querySelectorAll(e),0):Ye(e)?Jm(e,i):tu(e)?Da.call(e,0):e?[e]:[]},Ha=function(e){return e=wt(e)[0]||Zs("Invalid scope")||{},function(t){var i=e.current||e.nativeElement||e;return wt(t,i.querySelectorAll?i:i===e?Zs("Invalid scope")||uo.createElement("div"):e)}},iu=function(e){return e.sort(function(){return .5-Math.random()})},su=function(e){if(ye(e))return e;var t=Wt(e)?e:{each:e},i=Ui(t.ease),s=t.from||0,n=parseFloat(t.base)||0,a={},o=s>0&&s<1,l=isNaN(s)||o,c=t.axis,u=s,h=s;return Oe(s)?u=h={center:.5,edges:.5,end:1}[s]||0:!o&&l&&(u=s[0],h=s[1]),function(d,f,p){var _=(p||t).length,g=a[_],m,x,S,w,A,k,P,E,b;if(!g){if(b=t.grid==="auto"?0:(t.grid||[1,Tt])[1],!b){for(P=-Tt;P<(P=p[b++].getBoundingClientRect().left)&&b<_;);b<_&&b--}for(g=a[_]=[],m=l?Math.min(b,_)*u-.5:s%b,x=b===Tt?0:l?_*h/b-.5:s/b|0,P=0,E=Tt,k=0;k<_;k++)S=k%b-m,w=x-(k/b|0),g[k]=A=c?Math.abs(c==="y"?w:S):Gc(S*S+w*w),A>P&&(P=A),A<E&&(E=A);s==="random"&&iu(g),g.max=P-E,g.min=E,g.v=_=(parseFloat(t.amount)||parseFloat(t.each)*(b>_?_-1:c?c==="y"?_/b:b:Math.max(b,_/b))||0)*(s==="edges"?-1:1),g.b=_<0?n-_:n,g.u=He(t.amount||t.each)||0,i=i&&_<0?fu(i):i}return _=(g[d]-g.min)/g.max||0,Fe(g.b+(i?i(_):_)*g.v)+g.u}},Ua=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(i){var s=Fe(Math.round(parseFloat(i)/e)*e*t);return(s-s%1)/t+(si(i)?0:He(i))}},ru=function(e,t){var i=Ye(e),s,n;return!i&&Wt(e)&&(s=i=e.radius||Tt,e.values?(e=wt(e.values),(n=!si(e[0]))&&(s*=s)):e=Ua(e.increment)),Ti(t,i?ye(e)?function(a){return n=e(a),Math.abs(n-a)<=s?n:a}:function(a){for(var o=parseFloat(n?a.x:a),l=parseFloat(n?a.y:0),c=Tt,u=0,h=e.length,d,f;h--;)n?(d=e[h].x-o,f=e[h].y-l,d=d*d+f*f):d=Math.abs(e[h]-o),d<c&&(c=d,u=h);return u=!s||c<=s?e[u]:a,n||u===a||si(a)?u:u+He(a)}:Ua(e))},nu=function(e,t,i,s){return Ti(Ye(e)?!t:i===!0?!!(i=0):!s,function(){return Ye(e)?e[~~(Math.random()*e.length)]:(i=i||1e-5)&&(s=i<1?Math.pow(10,(i+"").length-2):1)&&Math.floor(Math.round((e-i/2+Math.random()*(t-e+i*.99))/i)*i*s)/s})},e0=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(s){return t.reduce(function(n,a){return a(n)},s)}},t0=function(e,t){return function(i){return e(parseFloat(i))+(t||He(i))}},i0=function(e,t,i){return ou(e,t,0,1,i)},au=function(e,t,i){return Ti(i,function(s){return e[~~t(s)]})},s0=function r(e,t,i){var s=t-e;return Ye(e)?au(e,r(0,e.length),t):Ti(i,function(n){return(s+(n-e)%s)%s+e})},r0=function r(e,t,i){var s=t-e,n=s*2;return Ye(e)?au(e,r(0,e.length-1),t):Ti(i,function(a){return a=(n+(a-e)%n)%n||0,e+(a>s?n-a:a)})},Js=function(e){for(var t=0,i="",s,n,a,o;~(s=e.indexOf("random(",t));)a=e.indexOf(")",s),o=e.charAt(s+7)==="[",n=e.substr(s+7,a-s-7).match(o?zc:Fa),i+=e.substr(t,s-t)+nu(o?n:+n[0],o?0:+n[1],+n[2]||1e-5),t=a+1;return i+e.substr(t,e.length-t)},ou=function(e,t,i,s,n){var a=t-e,o=s-i;return Ti(n,function(l){return i+((l-e)/a*o||0)})},n0=function r(e,t,i,s){var n=isNaN(e+t)?0:function(f){return(1-f)*e+f*t};if(!n){var a=Oe(e),o={},l,c,u,h,d;if(i===!0&&(s=1)&&(i=null),a)e={p:e},t={p:t};else if(Ye(e)&&!Ye(t)){for(u=[],h=e.length,d=h-2,c=1;c<h;c++)u.push(r(e[c-1],e[c]));h--,n=function(p){p*=h;var _=Math.min(d,~~p);return u[_](p-_)},i=t}else s||(e=Yi(Ye(e)?[]:{},e));if(!u){for(l in t)mo.call(o,e,l,"get",t[l]);n=function(p){return To(p,o)||(a?e.p:e)}}}return Ti(i,n)},Wh=function(e,t,i){var s=e.labels,n=Tt,a,o,l;for(a in s)o=s[a]-t,o<0==!!i&&o&&n>(o=Math.abs(o))&&(l=a,n=o);return l},ft=function(e,t,i){var s=e.vars,n=s[t],a=fe,o=e._ctx,l,c,u;if(n)return l=s[t+"Params"],c=s.callbackScope||e,i&&_i.length&&Xr(),o&&(fe=o),u=l?n.apply(c,l):n.call(c),fe=a,u},Ns=function(e){return mi(e),e.scrollTrigger&&e.scrollTrigger.kill(!!We),e.progress()<1&&ft(e,"onInterrupt"),e},ss,hu=[],lu=function(e){if(e)if(e=!e.name&&e.default||e,co()||e.headless){var t=e.name,i=ye(e),s=t&&!i&&e.init?function(){this._props=[]}:e,n={init:Qs,render:To,add:mo,kill:T0,modifier:S0,rawVars:0},a={targetTest:0,get:0,getSetter:So,aliases:{},register:0};if(xs(),e!==s){if(ct[t])return;vt(s,vt($r(e,n),a)),Yi(s.prototype,Yi(n,$r(e,a))),ct[s.prop=t]=s,e.targetTest&&(Or.push(s),po[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}Vc(t,s),e.register&&e.register(nt,s,st)}else hu.push(e)},he=255,Bs={aqua:[0,he,he],lime:[0,he,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,he],navy:[0,0,128],white:[he,he,he],olive:[128,128,0],yellow:[he,he,0],orange:[he,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[he,0,0],pink:[he,192,203],cyan:[0,he,he],transparent:[he,he,he,0]},Kn=function(e,t,i){return e+=e<0?1:e>1?-1:0,(e*6<1?t+(i-t)*e*6:e<.5?i:e*3<2?t+(i-t)*(2/3-e)*6:t)*he+.5|0},cu=function(e,t,i){var s=e?si(e)?[e>>16,e>>8&he,e&he]:0:Bs.black,n,a,o,l,c,u,h,d,f,p;if(!s){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),Bs[e])s=Bs[e];else if(e.charAt(0)==="#"){if(e.length<6&&(n=e.charAt(1),a=e.charAt(2),o=e.charAt(3),e="#"+n+n+a+a+o+o+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return s=parseInt(e.substr(1,6),16),[s>>16,s>>8&he,s&he,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),s=[e>>16,e>>8&he,e&he]}else if(e.substr(0,3)==="hsl"){if(s=p=e.match(Fa),!t)l=+s[0]%360/360,c=+s[1]/100,u=+s[2]/100,a=u<=.5?u*(c+1):u+c-u*c,n=u*2-a,s.length>3&&(s[3]*=1),s[0]=Kn(l+1/3,n,a),s[1]=Kn(l,n,a),s[2]=Kn(l-1/3,n,a);else if(~e.indexOf("="))return s=e.match(Hc),i&&s.length<4&&(s[3]=1),s}else s=e.match(Fa)||Bs.transparent;s=s.map(Number)}return t&&!p&&(n=s[0]/he,a=s[1]/he,o=s[2]/he,h=Math.max(n,a,o),d=Math.min(n,a,o),u=(h+d)/2,h===d?l=c=0:(f=h-d,c=u>.5?f/(2-h-d):f/(h+d),l=h===n?(a-o)/f+(a<o?6:0):h===a?(o-n)/f+2:(n-a)/f+4,l*=60),s[0]=~~(l+.5),s[1]=~~(c*100+.5),s[2]=~~(u*100+.5)),i&&s.length<4&&(s[3]=1),s},uu=function(e){var t=[],i=[],s=-1;return e.split(gi).forEach(function(n){var a=n.match(is)||[];t.push.apply(t,a),i.push(s+=a.length+1)}),t.c=i,t},Yh=function(e,t,i){var s="",n=(e+s).match(gi),a=t?"hsla(":"rgba(",o=0,l,c,u,h;if(!n)return e;if(n=n.map(function(d){return(d=cu(d,t,1))&&a+(t?d[0]+","+d[1]+"%,"+d[2]+"%,"+d[3]:d.join(","))+")"}),i&&(u=uu(e),l=i.c,l.join(s)!==u.c.join(s)))for(c=e.replace(gi,"1").split(is),h=c.length-1;o<h;o++)s+=c[o]+(~l.indexOf(o)?n.shift()||a+"0,0,0,0)":(u.length?u:n.length?n:i).shift());if(!c)for(c=e.split(gi),h=c.length-1;o<h;o++)s+=c[o]+n[o];return s+c[h]},gi=function(){var r="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in Bs)r+="|"+e+"\\b";return new RegExp(r+")","gi")}(),a0=/hsl[a]?\(/,du=function(e){var t=e.join(" "),i;if(gi.lastIndex=0,gi.test(t))return i=a0.test(t),e[1]=Yh(e[1],i),e[0]=Yh(e[0],i,uu(e[1])),!0},er,ut=function(){var r=Date.now,e=500,t=33,i=r(),s=i,n=1e3/240,a=n,o=[],l,c,u,h,d,f,p=function _(g){var m=r()-s,x=g===!0,S,w,A,k;if((m>e||m<0)&&(i+=m-t),s+=m,A=s-i,S=A-a,(S>0||x)&&(k=++h.frame,d=A-h.time*1e3,h.time=A=A/1e3,a+=S+(S>=n?4:n-S),w=1),x||(l=c(_)),w)for(f=0;f<o.length;f++)o[f](A,d,k,g)};return h={time:0,frame:0,tick:function(){p(!0)},deltaRatio:function(g){return d/(1e3/(g||60))},wake:function(){Wc&&(!Oa&&co()&&(Gt=Oa=window,uo=Gt.document||{},_t.gsap=nt,(Gt.gsapVersions||(Gt.gsapVersions=[])).push(nt.version),Yc(Vr||Gt.GreenSockGlobals||!Gt.gsap&&Gt||{}),hu.forEach(lu)),u=typeof requestAnimationFrame<"u"&&requestAnimationFrame,l&&h.sleep(),c=u||function(g){return setTimeout(g,a-h.time*1e3+1|0)},er=1,p(2))},sleep:function(){(u?cancelAnimationFrame:clearTimeout)(l),er=0,c=Qs},lagSmoothing:function(g,m){e=g||1/0,t=Math.min(m||33,e)},fps:function(g){n=1e3/(g||240),a=h.time*1e3+n},add:function(g,m,x){var S=m?function(w,A,k,P){g(w,A,k,P),h.remove(S)}:g;return h.remove(g),o[x?"unshift":"push"](S),xs(),S},remove:function(g,m){~(m=o.indexOf(g))&&o.splice(m,1)&&f>=m&&f--},_listeners:o},h}(),xs=function(){return!er&&ut.wake()},ee={},o0=/^[\d.\-M][\d.\-,\s]/,h0=/["']/g,l0=function(e){for(var t={},i=e.substr(1,e.length-3).split(":"),s=i[0],n=1,a=i.length,o,l,c;n<a;n++)l=i[n],o=n!==a-1?l.lastIndexOf(","):l.length,c=l.substr(0,o),t[s]=isNaN(c)?c.replace(h0,"").trim():+c,s=l.substr(o+1).trim();return t},c0=function(e){var t=e.indexOf("(")+1,i=e.indexOf(")"),s=e.indexOf("(",t);return e.substring(t,~s&&s<i?e.indexOf(")",i+1):i)},u0=function(e){var t=(e+"").split("("),i=ee[t[0]];return i&&t.length>1&&i.config?i.config.apply(null,~e.indexOf("{")?[l0(t[1])]:c0(e).split(",").map(qc)):ee._CE&&o0.test(e)?ee._CE("",e):i},fu=function(e){return function(t){return 1-e(1-t)}},pu=function r(e,t){for(var i=e._first,s;i;)i instanceof qe?r(i,t):i.vars.yoyoEase&&(!i._yoyo||!i._repeat)&&i._yoyo!==t&&(i.timeline?r(i.timeline,t):(s=i._ease,i._ease=i._yEase,i._yEase=s,i._yoyo=t)),i=i._next},Ui=function(e,t){return e&&(ye(e)?e:ee[e]||u0(e))||t},Xi=function(e,t,i,s){i===void 0&&(i=function(l){return 1-t(1-l)}),s===void 0&&(s=function(l){return l<.5?t(l*2)/2:1-t((1-l)*2)/2});var n={easeIn:t,easeOut:i,easeInOut:s},a;return it(e,function(o){ee[o]=_t[o]=n,ee[a=o.toLowerCase()]=i;for(var l in n)ee[a+(l==="easeIn"?".in":l==="easeOut"?".out":".inOut")]=ee[o+"."+l]=n[l]}),n},_u=function(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},Zn=function r(e,t,i){var s=t>=1?t:1,n=(i||(e?.3:.45))/(t<1?t:1),a=n/La*(Math.asin(1/s)||0),o=function(u){return u===1?1:s*Math.pow(2,-10*u)*Dm((u-a)*n)+1},l=e==="out"?o:e==="in"?function(c){return 1-o(1-c)}:_u(o);return n=La/n,l.config=function(c,u){return r(e,c,u)},l},Qn=function r(e,t){t===void 0&&(t=1.70158);var i=function(a){return a?--a*a*((t+1)*a+t)+1:0},s=e==="out"?i:e==="in"?function(n){return 1-i(1-n)}:_u(i);return s.config=function(n){return r(e,n)},s};it("Linear,Quad,Cubic,Quart,Quint,Strong",function(r,e){var t=e<5?e+1:e;Xi(r+",Power"+(t-1),e?function(i){return Math.pow(i,t)}:function(i){return i},function(i){return 1-Math.pow(1-i,t)},function(i){return i<.5?Math.pow(i*2,t)/2:1-Math.pow((1-i)*2,t)/2})});ee.Linear.easeNone=ee.none=ee.Linear.easeIn;Xi("Elastic",Zn("in"),Zn("out"),Zn());(function(r,e){var t=1/e,i=2*t,s=2.5*t,n=function(o){return o<t?r*o*o:o<i?r*Math.pow(o-1.5/e,2)+.75:o<s?r*(o-=2.25/e)*o+.9375:r*Math.pow(o-2.625/e,2)+.984375};Xi("Bounce",function(a){return 1-n(1-a)},n)})(7.5625,2.75);Xi("Expo",function(r){return r?Math.pow(2,10*(r-1)):0});Xi("Circ",function(r){return-(Gc(1-r*r)-1)});Xi("Sine",function(r){return r===1?1:-Gm(r*Nm)+1});Xi("Back",Qn("in"),Qn("out"),Qn());ee.SteppedEase=ee.steps=_t.SteppedEase={config:function(e,t){e===void 0&&(e=1);var i=1/e,s=e+(t?0:1),n=t?1:0,a=1-ce;return function(o){return((s*ar(0,a,o)|0)+n)*i}}};_s.ease=ee["quad.out"];it("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(r){return _o+=r+","+r+"Params,"});var gu=function(e,t){this.id=Bm++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:$c,this.set=t?t.getSetter:So},tr=function(){function r(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,ms(this,+t.duration,1,1),this.data=t.data,fe&&(this._ctx=fe,fe.data.push(this)),er||ut.wake()}var e=r.prototype;return e.delay=function(i){return i||i===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+i-this._delay),this._delay=i,this):this._delay},e.duration=function(i){return arguments.length?this.totalDuration(this._repeat>0?i+(i+this._rDelay)*this._repeat:i):this.totalDuration()&&this._dur},e.totalDuration=function(i){return arguments.length?(this._dirty=0,ms(this,this._repeat<0?i:(i-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(i,s){if(xs(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(un(this,i),!n._dp||n.parent||Qc(n,this);n&&n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&i<this._tDur||this._ts<0&&i>0||!this._tDur&&!i)&&Dt(this._dp,this,this._start-this._delay)}return(this._tTime!==i||!this._dur&&!s||this._initted&&Math.abs(this._zTime)===ce||!i&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=i),jc(this,i,s)),this},e.time=function(i,s){return arguments.length?this.totalTime(Math.min(this.totalDuration(),i+Uh(this))%(this._dur+this._rDelay)||(i?this._dur:0),s):this._time},e.totalProgress=function(i,s){return arguments.length?this.totalTime(this.totalDuration()*i,s):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>0?1:0},e.progress=function(i,s){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-i:i)+Uh(this),s):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(i,s){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(i-1)*n,s):this._repeat?gs(this._tTime,n)+1:1},e.timeScale=function(i,s){if(!arguments.length)return this._rts===-ce?0:this._rts;if(this._rts===i)return this;var n=this.parent&&this._ts?jr(this.parent._time,this):this._tTime;return this._rts=+i||0,this._ts=this._ps||i===-ce?0:this._rts,this.totalTime(ar(-Math.abs(this._delay),this._tDur,n),s!==!1),cn(this),Xm(this)},e.paused=function(i){return arguments.length?(this._ps!==i&&(this._ps=i,i?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(xs(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==ce&&(this._tTime-=ce)))),this):this._ps},e.startTime=function(i){if(arguments.length){this._start=i;var s=this.parent||this._dp;return s&&(s._sort||!this.parent)&&Dt(s,this,i-this._delay),this}return this._start},e.endTime=function(i){return this._start+(tt(i)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(i){var s=this.parent||this._dp;return s?i&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?jr(s.rawTime(i),this):this._tTime:this._tTime},e.revert=function(i){i===void 0&&(i=zm);var s=We;return We=i,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(i),this.totalTime(-.01,i.suppressEvents)),this.data!=="nested"&&i.kill!==!1&&this.kill(),We=s,this},e.globalTime=function(i){for(var s=this,n=arguments.length?i:s.rawTime();s;)n=s._start+n/(Math.abs(s._ts)||1),s=s._dp;return!this.parent&&this._sat?this._sat.globalTime(i):n},e.repeat=function(i){return arguments.length?(this._repeat=i===1/0?-2:i,zh(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(i){if(arguments.length){var s=this._time;return this._rDelay=i,zh(this),s?this.time(s):this}return this._rDelay},e.yoyo=function(i){return arguments.length?(this._yoyo=i,this):this._yoyo},e.seek=function(i,s){return this.totalTime(xt(this,i),tt(s))},e.restart=function(i,s){return this.play().totalTime(i?-this._delay:0,tt(s))},e.play=function(i,s){return i!=null&&this.seek(i,s),this.reversed(!1).paused(!1)},e.reverse=function(i,s){return i!=null&&this.seek(i||this.totalDuration(),s),this.reversed(!0).paused(!1)},e.pause=function(i,s){return i!=null&&this.seek(i,s),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(i){return arguments.length?(!!i!==this.reversed()&&this.timeScale(-this._rts||(i?-ce:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-ce,this},e.isActive=function(){var i=this.parent||this._dp,s=this._start,n;return!!(!i||this._ts&&this._initted&&i.isActive()&&(n=i.rawTime(!0))>=s&&n<this.endTime(!0)-ce)},e.eventCallback=function(i,s,n){var a=this.vars;return arguments.length>1?(s?(a[i]=s,n&&(a[i+"Params"]=n),i==="onUpdate"&&(this._onUpdate=s)):delete a[i],this):a[i]},e.then=function(i){var s=this;return new Promise(function(n){var a=ye(i)?i:Kc,o=function(){var c=s.then;s.then=null,ye(a)&&(a=a(s))&&(a.then||a===s)&&(s.then=c),n(a),s.then=c};s._initted&&s.totalProgress()===1&&s._ts>=0||!s._tTime&&s._ts<0?o():s._prom=o})},e.kill=function(){Ns(this)},r}();vt(tr.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-ce,_prom:0,_ps:!1,_rts:1});var qe=function(r){Bc(e,r);function e(i,s){var n;return i===void 0&&(i={}),n=r.call(this,i)||this,n.labels={},n.smoothChildTiming=!!i.smoothChildTiming,n.autoRemoveChildren=!!i.autoRemoveChildren,n._sort=tt(i.sortChildren),_e&&Dt(i.parent||_e,Zt(n),s),i.reversed&&n.reverse(),i.paused&&n.paused(!0),i.scrollTrigger&&Jc(Zt(n),i.scrollTrigger),n}var t=e.prototype;return t.to=function(s,n,a){return zs(0,arguments,this),this},t.from=function(s,n,a){return zs(1,arguments,this),this},t.fromTo=function(s,n,a,o){return zs(2,arguments,this),this},t.set=function(s,n,a){return n.duration=0,n.parent=this,Us(n).repeatDelay||(n.repeat=0),n.immediateRender=!!n.immediateRender,new be(s,n,xt(this,a),1),this},t.call=function(s,n,a){return Dt(this,be.delayedCall(0,s,n),a)},t.staggerTo=function(s,n,a,o,l,c,u){return a.duration=n,a.stagger=a.stagger||o,a.onComplete=c,a.onCompleteParams=u,a.parent=this,new be(s,a,xt(this,l)),this},t.staggerFrom=function(s,n,a,o,l,c,u){return a.runBackwards=1,Us(a).immediateRender=tt(a.immediateRender),this.staggerTo(s,n,a,o,l,c,u)},t.staggerFromTo=function(s,n,a,o,l,c,u,h){return o.startAt=a,Us(o).immediateRender=tt(o.immediateRender),this.staggerTo(s,n,o,l,c,u,h)},t.render=function(s,n,a){var o=this._time,l=this._dirty?this.totalDuration():this._tDur,c=this._dur,u=s<=0?0:Fe(s),h=this._zTime<0!=s<0&&(this._initted||!c),d,f,p,_,g,m,x,S,w,A,k,P;if(this!==_e&&u>l&&s>=0&&(u=l),u!==this._tTime||a||h){if(o!==this._time&&c&&(u+=this._time-o,s+=this._time-o),d=u,w=this._start,S=this._ts,m=!S,h&&(c||(o=this._zTime),(s||!n)&&(this._zTime=s)),this._repeat){if(k=this._yoyo,g=c+this._rDelay,this._repeat<-1&&s<0)return this.totalTime(g*100+s,n,a);if(d=Fe(u%g),u===l?(_=this._repeat,d=c):(_=~~(u/g),_&&_===u/g&&(d=c,_--),d>c&&(d=c)),A=gs(this._tTime,g),!o&&this._tTime&&A!==_&&this._tTime-A*g-this._dur<=0&&(A=_),k&&_&1&&(d=c-d,P=1),_!==A&&!this._lock){var E=k&&A&1,b=E===(k&&_&1);if(_<A&&(E=!E),o=E?0:u%c?c:u,this._lock=1,this.render(o||(P?0:Fe(_*g)),n,!c)._lock=0,this._tTime=u,!n&&this.parent&&ft(this,"onRepeat"),this.vars.repeatRefresh&&!P&&(this.invalidate()._lock=1),o&&o!==this._time||m!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(c=this._dur,l=this._tDur,b&&(this._lock=2,o=E?c:-1e-4,this.render(o,!0),this.vars.repeatRefresh&&!P&&this.invalidate()),this._lock=0,!this._ts&&!m)return this;pu(this,P)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(x=Km(this,Fe(o),Fe(d)),x&&(u-=d-(d=x._start))),this._tTime=u,this._time=d,this._act=!S,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=s,o=0),!o&&d&&!n&&!_&&(ft(this,"onStart"),this._tTime!==u))return this;if(d>=o&&s>=0)for(f=this._first;f;){if(p=f._next,(f._act||d>=f._start)&&f._ts&&x!==f){if(f.parent!==this)return this.render(s,n,a);if(f.render(f._ts>0?(d-f._start)*f._ts:(f._dirty?f.totalDuration():f._tDur)+(d-f._start)*f._ts,n,a),d!==this._time||!this._ts&&!m){x=0,p&&(u+=this._zTime=-ce);break}}f=p}else{f=this._last;for(var M=s<0?s:d;f;){if(p=f._prev,(f._act||M<=f._end)&&f._ts&&x!==f){if(f.parent!==this)return this.render(s,n,a);if(f.render(f._ts>0?(M-f._start)*f._ts:(f._dirty?f.totalDuration():f._tDur)+(M-f._start)*f._ts,n,a||We&&(f._initted||f._startAt)),d!==this._time||!this._ts&&!m){x=0,p&&(u+=this._zTime=M?-ce:ce);break}}f=p}}if(x&&!n&&(this.pause(),x.render(d>=o?0:-ce)._zTime=d>=o?1:-1,this._ts))return this._start=w,cn(this),this.render(s,n,a);this._onUpdate&&!n&&ft(this,"onUpdate",!0),(u===l&&this._tTime>=this.totalDuration()||!u&&o)&&(w===this._start||Math.abs(S)!==Math.abs(this._ts))&&(this._lock||((s||!c)&&(u===l&&this._ts>0||!u&&this._ts<0)&&mi(this,1),!n&&!(s<0&&!o)&&(u||o||!l)&&(ft(this,u===l&&s>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(u<l&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(s,n){var a=this;if(si(n)||(n=xt(this,n,s)),!(s instanceof tr)){if(Ye(s))return s.forEach(function(o){return a.add(o,n)}),this;if(Oe(s))return this.addLabel(s,n);if(ye(s))s=be.delayedCall(0,s);else return this}return this!==s?Dt(this,s,n):this},t.getChildren=function(s,n,a,o){s===void 0&&(s=!0),n===void 0&&(n=!0),a===void 0&&(a=!0),o===void 0&&(o=-Tt);for(var l=[],c=this._first;c;)c._start>=o&&(c instanceof be?n&&l.push(c):(a&&l.push(c),s&&l.push.apply(l,c.getChildren(!0,n,a)))),c=c._next;return l},t.getById=function(s){for(var n=this.getChildren(1,1,1),a=n.length;a--;)if(n[a].vars.id===s)return n[a]},t.remove=function(s){return Oe(s)?this.removeLabel(s):ye(s)?this.killTweensOf(s):(ln(this,s),s===this._recent&&(this._recent=this._last),Hi(this))},t.totalTime=function(s,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Fe(ut.time-(this._ts>0?s/this._ts:(this.totalDuration()-s)/-this._ts))),r.prototype.totalTime.call(this,s,n),this._forcing=0,this):this._tTime},t.addLabel=function(s,n){return this.labels[s]=xt(this,n),this},t.removeLabel=function(s){return delete this.labels[s],this},t.addPause=function(s,n,a){var o=be.delayedCall(0,n||Qs,a);return o.data="isPause",this._hasPause=1,Dt(this,o,xt(this,s))},t.removePause=function(s){var n=this._first;for(s=xt(this,s);n;)n._start===s&&n.data==="isPause"&&mi(n),n=n._next},t.killTweensOf=function(s,n,a){for(var o=this.getTweensOf(s,a),l=o.length;l--;)di!==o[l]&&o[l].kill(s,n);return this},t.getTweensOf=function(s,n){for(var a=[],o=wt(s),l=this._first,c=si(n),u;l;)l instanceof be?Wm(l._targets,o)&&(c?(!di||l._initted&&l._ts)&&l.globalTime(0)<=n&&l.globalTime(l.totalDuration())>n:!n||l.isActive())&&a.push(l):(u=l.getTweensOf(o,n)).length&&a.push.apply(a,u),l=l._next;return a},t.tweenTo=function(s,n){n=n||{};var a=this,o=xt(a,s),l=n,c=l.startAt,u=l.onStart,h=l.onStartParams,d=l.immediateRender,f,p=be.to(a,vt({ease:n.ease||"none",lazy:!1,immediateRender:!1,time:o,overwrite:"auto",duration:n.duration||Math.abs((o-(c&&"time"in c?c.time:a._time))/a.timeScale())||ce,onStart:function(){if(a.pause(),!f){var g=n.duration||Math.abs((o-(c&&"time"in c?c.time:a._time))/a.timeScale());p._dur!==g&&ms(p,g,0,1).render(p._time,!0,!0),f=1}u&&u.apply(p,h||[])}},n));return d?p.render(0):p},t.tweenFromTo=function(s,n,a){return this.tweenTo(n,vt({startAt:{time:xt(this,s)}},a))},t.recent=function(){return this._recent},t.nextLabel=function(s){return s===void 0&&(s=this._time),Wh(this,xt(this,s))},t.previousLabel=function(s){return s===void 0&&(s=this._time),Wh(this,xt(this,s),1)},t.currentLabel=function(s){return arguments.length?this.seek(s,!0):this.previousLabel(this._time+ce)},t.shiftChildren=function(s,n,a){a===void 0&&(a=0);for(var o=this._first,l=this.labels,c;o;)o._start>=a&&(o._start+=s,o._end+=s),o=o._next;if(n)for(c in l)l[c]>=a&&(l[c]+=s);return Hi(this)},t.invalidate=function(s){var n=this._first;for(this._lock=0;n;)n.invalidate(s),n=n._next;return r.prototype.invalidate.call(this,s)},t.clear=function(s){s===void 0&&(s=!0);for(var n=this._first,a;n;)a=n._next,this.remove(n),n=a;return this._dp&&(this._time=this._tTime=this._pTime=0),s&&(this.labels={}),Hi(this)},t.totalDuration=function(s){var n=0,a=this,o=a._last,l=Tt,c,u,h;if(arguments.length)return a.timeScale((a._repeat<0?a.duration():a.totalDuration())/(a.reversed()?-s:s));if(a._dirty){for(h=a.parent;o;)c=o._prev,o._dirty&&o.totalDuration(),u=o._start,u>l&&a._sort&&o._ts&&!a._lock?(a._lock=1,Dt(a,o,u-o._delay,1)._lock=0):l=u,u<0&&o._ts&&(n-=u,(!h&&!a._dp||h&&h.smoothChildTiming)&&(a._start+=u/a._ts,a._time-=u,a._tTime-=u),a.shiftChildren(-u,!1,-1/0),l=0),o._end>n&&o._ts&&(n=o._end),o=c;ms(a,a===_e&&a._time>n?a._time:n,1,1),a._dirty=0}return a._tDur},e.updateRoot=function(s){if(_e._ts&&(jc(_e,jr(s,_e)),Xc=ut.frame),ut.frame>=Dh){Dh+=pt.autoSleep||120;var n=_e._first;if((!n||!n._ts)&&pt.autoSleep&&ut._listeners.length<2){for(;n&&!n._ts;)n=n._next;n||ut.sleep()}}},e}(tr);vt(qe.prototype,{_lock:0,_hasPause:0,_forcing:0});var d0=function(e,t,i,s,n,a,o){var l=new st(this._pt,e,t,0,1,wu,null,n),c=0,u=0,h,d,f,p,_,g,m,x;for(l.b=i,l.e=s,i+="",s+="",(m=~s.indexOf("random("))&&(s=Js(s)),a&&(x=[i,s],a(x,e,t),i=x[0],s=x[1]),d=i.match(jn)||[];h=jn.exec(s);)p=h[0],_=s.substring(c,h.index),f?f=(f+1)%5:_.substr(-5)==="rgba("&&(f=1),p!==d[u++]&&(g=parseFloat(d[u-1])||0,l._pt={_next:l._pt,p:_||u===1?_:",",s:g,c:p.charAt(1)==="="?hs(g,p)-g:parseFloat(p)-g,m:f&&f<4?Math.round:0},c=jn.lastIndex);return l.c=c<s.length?s.substring(c,s.length):"",l.fp=o,(Uc.test(s)||m)&&(l.e=0),this._pt=l,l},mo=function(e,t,i,s,n,a,o,l,c,u){ye(s)&&(s=s(n||0,e,a));var h=e[t],d=i!=="get"?i:ye(h)?c?e[t.indexOf("set")||!ye(e["get"+t.substr(3)])?t:"get"+t.substr(3)](c):e[t]():h,f=ye(h)?c?m0:Su:yo,p;if(Oe(s)&&(~s.indexOf("random(")&&(s=Js(s)),s.charAt(1)==="="&&(p=hs(d,s)+(He(d)||0),(p||p===0)&&(s=p))),!u||d!==s||za)return!isNaN(d*s)&&s!==""?(p=new st(this._pt,e,t,+d||0,s-(d||0),typeof h=="boolean"?y0:Tu,0,f),c&&(p.fp=c),o&&p.modifier(o,this,e),this._pt=p):(!h&&!(t in e)&&fo(t,s),d0.call(this,e,t,d,s,f,l||pt.stringFilter,c))},f0=function(e,t,i,s,n){if(ye(e)&&(e=Ws(e,n,t,i,s)),!Wt(e)||e.style&&e.nodeType||Ye(e)||Dc(e))return Oe(e)?Ws(e,n,t,i,s):e;var a={},o;for(o in e)a[o]=Ws(e[o],n,t,i,s);return a},mu=function(e,t,i,s,n,a){var o,l,c,u;if(ct[e]&&(o=new ct[e]).init(n,o.rawVars?t[e]:f0(t[e],s,n,a,i),i,s,a)!==!1&&(i._pt=l=new st(i._pt,n,e,0,1,o.render,o,0,o.priority),i!==ss))for(c=i._ptLookup[i._targets.indexOf(n)],u=o._props.length;u--;)c[o._props[u]]=l;return o},di,za,xo=function r(e,t,i){var s=e.vars,n=s.ease,a=s.startAt,o=s.immediateRender,l=s.lazy,c=s.onUpdate,u=s.runBackwards,h=s.yoyoEase,d=s.keyframes,f=s.autoRevert,p=e._dur,_=e._startAt,g=e._targets,m=e.parent,x=m&&m.data==="nested"?m.vars.targets:g,S=e._overwrite==="auto"&&!ho,w=e.timeline,A,k,P,E,b,M,N,H,L,F,G,$,K;if(w&&(!d||!n)&&(n="none"),e._ease=Ui(n,_s.ease),e._yEase=h?fu(Ui(h===!0?n:h,_s.ease)):0,h&&e._yoyo&&!e._repeat&&(h=e._yEase,e._yEase=e._ease,e._ease=h),e._from=!w&&!!s.runBackwards,!w||d&&!s.stagger){if(H=g[0]?Di(g[0]).harness:0,$=H&&s[H.prop],A=$r(s,po),_&&(_._zTime<0&&_.progress(1),t<0&&u&&o&&!f?_.render(-1,!0):_.revert(u&&p?Fr:Um),_._lazy=0),a){if(mi(e._startAt=be.set(g,vt({data:"isStart",overwrite:!1,parent:m,immediateRender:!0,lazy:!_&&tt(l),startAt:null,delay:0,onUpdate:c&&function(){return ft(e,"onUpdate")},stagger:0},a))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(We||!o&&!f)&&e._startAt.revert(Fr),o&&p&&t<=0&&i<=0){t&&(e._zTime=t);return}}else if(u&&p&&!_){if(t&&(o=!1),P=vt({overwrite:!1,data:"isFromStart",lazy:o&&!_&&tt(l),immediateRender:o,stagger:0,parent:m},A),$&&(P[H.prop]=$),mi(e._startAt=be.set(g,P)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(We?e._startAt.revert(Fr):e._startAt.render(-1,!0)),e._zTime=t,!o)r(e._startAt,ce,ce);else if(!t)return}for(e._pt=e._ptCache=0,l=p&&tt(l)||l&&!p,k=0;k<g.length;k++){if(b=g[k],N=b._gsap||go(g)[k]._gsap,e._ptLookup[k]=F={},Na[N.id]&&_i.length&&Xr(),G=x===g?k:x.indexOf(b),H&&(L=new H).init(b,$||A,e,G,x)!==!1&&(e._pt=E=new st(e._pt,b,L.name,0,1,L.render,L,0,L.priority),L._props.forEach(function(Se){F[Se]=E}),L.priority&&(M=1)),!H||$)for(P in A)ct[P]&&(L=mu(P,A,e,G,b,x))?L.priority&&(M=1):F[P]=E=mo.call(e,b,P,"get",A[P],G,x,0,s.stringFilter);e._op&&e._op[k]&&e.kill(b,e._op[k]),S&&e._pt&&(di=e,_e.killTweensOf(b,F,e.globalTime(t)),K=!e.parent,di=0),e._pt&&l&&(Na[N.id]=1)}M&&vu(e),e._onInit&&e._onInit(e)}e._onUpdate=c,e._initted=(!e._op||e._pt)&&!K,d&&t<=0&&w.render(Tt,!0,!0)},p0=function(e,t,i,s,n,a,o,l){var c=(e._pt&&e._ptCache||(e._ptCache={}))[t],u,h,d,f;if(!c)for(c=e._ptCache[t]=[],d=e._ptLookup,f=e._targets.length;f--;){if(u=d[f][t],u&&u.d&&u.d._pt)for(u=u.d._pt;u&&u.p!==t&&u.fp!==t;)u=u._next;if(!u)return za=1,e.vars[t]="+=0",xo(e,o),za=0,l?Zs(t+" not eligible for reset"):1;c.push(u)}for(f=c.length;f--;)h=c[f],u=h._pt||h,u.s=(s||s===0)&&!n?s:u.s+(s||0)+a*u.c,u.c=i-u.s,h.e&&(h.e=ve(i)+He(h.e)),h.b&&(h.b=u.s+He(h.b))},_0=function(e,t){var i=e[0]?Di(e[0]).harness:0,s=i&&i.aliases,n,a,o,l;if(!s)return t;n=Yi({},t);for(a in s)if(a in n)for(l=s[a].split(","),o=l.length;o--;)n[l[o]]=n[a];return n},g0=function(e,t,i,s){var n=t.ease||s||"power1.inOut",a,o;if(Ye(t))o=i[e]||(i[e]=[]),t.forEach(function(l,c){return o.push({t:c/(t.length-1)*100,v:l,e:n})});else for(a in t)o=i[a]||(i[a]=[]),a==="ease"||o.push({t:parseFloat(e),v:t[a],e:n})},Ws=function(e,t,i,s,n){return ye(e)?e.call(t,i,s,n):Oe(e)&&~e.indexOf("random(")?Js(e):e},xu=_o+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",yu={};it(xu+",id,stagger,delay,duration,paused,scrollTrigger",function(r){return yu[r]=1});var be=function(r){Bc(e,r);function e(i,s,n,a){var o;typeof s=="number"&&(n.duration=s,s=n,n=null),o=r.call(this,a?s:Us(s))||this;var l=o.vars,c=l.duration,u=l.delay,h=l.immediateRender,d=l.stagger,f=l.overwrite,p=l.keyframes,_=l.defaults,g=l.scrollTrigger,m=l.yoyoEase,x=s.parent||_e,S=(Ye(i)||Dc(i)?si(i[0]):"length"in s)?[i]:wt(i),w,A,k,P,E,b,M,N;if(o._targets=S.length?go(S):Zs("GSAP target "+i+" not found. https://gsap.com",!pt.nullTargetWarn)||[],o._ptLookup=[],o._overwrite=f,p||d||Ir(c)||Ir(u)){if(s=o.vars,w=o.timeline=new qe({data:"nested",defaults:_||{},targets:x&&x.data==="nested"?x.vars.targets:S}),w.kill(),w.parent=w._dp=Zt(o),w._start=0,d||Ir(c)||Ir(u)){if(P=S.length,M=d&&su(d),Wt(d))for(E in d)~xu.indexOf(E)&&(N||(N={}),N[E]=d[E]);for(A=0;A<P;A++)k=$r(s,yu),k.stagger=0,m&&(k.yoyoEase=m),N&&Yi(k,N),b=S[A],k.duration=+Ws(c,Zt(o),A,b,S),k.delay=(+Ws(u,Zt(o),A,b,S)||0)-o._delay,!d&&P===1&&k.delay&&(o._delay=u=k.delay,o._start+=u,k.delay=0),w.to(b,k,M?M(A,b,S):0),w._ease=ee.none;w.duration()?c=u=0:o.timeline=0}else if(p){Us(vt(w.vars.defaults,{ease:"none"})),w._ease=Ui(p.ease||s.ease||"none");var H=0,L,F,G;if(Ye(p))p.forEach(function($){return w.to(S,$,">")}),w.duration();else{k={};for(E in p)E==="ease"||E==="easeEach"||g0(E,p[E],k,p.easeEach);for(E in k)for(L=k[E].sort(function($,K){return $.t-K.t}),H=0,A=0;A<L.length;A++)F=L[A],G={ease:F.e,duration:(F.t-(A?L[A-1].t:0))/100*c},G[E]=F.v,w.to(S,G,H),H+=G.duration;w.duration()<c&&w.to({},{duration:c-w.duration()})}}c||o.duration(c=w.duration())}else o.timeline=0;return f===!0&&!ho&&(di=Zt(o),_e.killTweensOf(S),di=0),Dt(x,Zt(o),n),s.reversed&&o.reverse(),s.paused&&o.paused(!0),(h||!c&&!p&&o._start===Fe(x._time)&&tt(h)&&$m(Zt(o))&&x.data!=="nested")&&(o._tTime=-ce,o.render(Math.max(0,-u)||0)),g&&Jc(Zt(o),g),o}var t=e.prototype;return t.render=function(s,n,a){var o=this._time,l=this._tDur,c=this._dur,u=s<0,h=s>l-ce&&!u?l:s<ce?0:s,d,f,p,_,g,m,x,S,w;if(!c)qm(this,s,n,a);else if(h!==this._tTime||!s||a||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==u){if(d=h,S=this.timeline,this._repeat){if(_=c+this._rDelay,this._repeat<-1&&u)return this.totalTime(_*100+s,n,a);if(d=Fe(h%_),h===l?(p=this._repeat,d=c):(p=~~(h/_),p&&p===Fe(h/_)&&(d=c,p--),d>c&&(d=c)),m=this._yoyo&&p&1,m&&(w=this._yEase,d=c-d),g=gs(this._tTime,_),d===o&&!a&&this._initted&&p===g)return this._tTime=h,this;p!==g&&(S&&this._yEase&&pu(S,m),this.vars.repeatRefresh&&!m&&!this._lock&&this._time!==_&&this._initted&&(this._lock=a=1,this.render(Fe(_*p),!0).invalidate()._lock=0))}if(!this._initted){if(eu(this,u?s:d,a,n,h))return this._tTime=0,this;if(o!==this._time&&!(a&&this.vars.repeatRefresh&&p!==g))return this;if(c!==this._dur)return this.render(s,n,a)}if(this._tTime=h,this._time=d,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=x=(w||this._ease)(d/c),this._from&&(this.ratio=x=1-x),d&&!o&&!n&&!p&&(ft(this,"onStart"),this._tTime!==h))return this;for(f=this._pt;f;)f.r(x,f.d),f=f._next;S&&S.render(s<0?s:S._dur*S._ease(d/this._dur),n,a)||this._startAt&&(this._zTime=s),this._onUpdate&&!n&&(u&&Ba(this,s,n,a),ft(this,"onUpdate")),this._repeat&&p!==g&&this.vars.onRepeat&&!n&&this.parent&&ft(this,"onRepeat"),(h===this._tDur||!h)&&this._tTime===h&&(u&&!this._onUpdate&&Ba(this,s,!0,!0),(s||!c)&&(h===this._tDur&&this._ts>0||!h&&this._ts<0)&&mi(this,1),!n&&!(u&&!o)&&(h||o||m)&&(ft(this,h===l?"onComplete":"onReverseComplete",!0),this._prom&&!(h<l&&this.timeScale()>0)&&this._prom()))}return this},t.targets=function(){return this._targets},t.invalidate=function(s){return(!s||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(s),r.prototype.invalidate.call(this,s)},t.resetTo=function(s,n,a,o,l){er||ut.wake(),this._ts||this.play();var c=Math.min(this._dur,(this._dp._time-this._start)*this._ts),u;return this._initted||xo(this,c),u=this._ease(c/this._dur),p0(this,s,n,a,o,u,c,l)?this.resetTo(s,n,a,o,1):(un(this,0),this.parent||Zc(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(s,n){if(n===void 0&&(n="all"),!s&&(!n||n==="all"))return this._lazy=this._pt=0,this.parent?Ns(this):this;if(this.timeline){var a=this.timeline.totalDuration();return this.timeline.killTweensOf(s,n,di&&di.vars.overwrite!==!0)._first||Ns(this),this.parent&&a!==this.timeline.totalDuration()&&ms(this,this._dur*this.timeline._tDur/a,0,1),this}var o=this._targets,l=s?wt(s):o,c=this._ptLookup,u=this._pt,h,d,f,p,_,g,m;if((!n||n==="all")&&Vm(o,l))return n==="all"&&(this._pt=0),Ns(this);for(h=this._op=this._op||[],n!=="all"&&(Oe(n)&&(_={},it(n,function(x){return _[x]=1}),n=_),n=_0(o,n)),m=o.length;m--;)if(~l.indexOf(o[m])){d=c[m],n==="all"?(h[m]=n,p=d,f={}):(f=h[m]=h[m]||{},p=n);for(_ in p)g=d&&d[_],g&&((!("kill"in g.d)||g.d.kill(_)===!0)&&ln(this,g,"_pt"),delete d[_]),f!=="all"&&(f[_]=1)}return this._initted&&!this._pt&&u&&Ns(this),this},e.to=function(s,n){return new e(s,n,arguments[2])},e.from=function(s,n){return zs(1,arguments)},e.delayedCall=function(s,n,a,o){return new e(n,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:s,onComplete:n,onReverseComplete:n,onCompleteParams:a,onReverseCompleteParams:a,callbackScope:o})},e.fromTo=function(s,n,a){return zs(2,arguments)},e.set=function(s,n){return n.duration=0,n.repeatDelay||(n.repeat=0),new e(s,n)},e.killTweensOf=function(s,n,a){return _e.killTweensOf(s,n,a)},e}(tr);vt(be.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});it("staggerTo,staggerFrom,staggerFromTo",function(r){be[r]=function(){var e=new qe,t=Da.call(arguments,0);return t.splice(r==="staggerFromTo"?5:4,0,0),e[r].apply(e,t)}});var yo=function(e,t,i){return e[t]=i},Su=function(e,t,i){return e[t](i)},m0=function(e,t,i,s){return e[t](s.fp,i)},x0=function(e,t,i){return e.setAttribute(t,i)},So=function(e,t){return ye(e[t])?Su:lo(e[t])&&e.setAttribute?x0:yo},Tu=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},y0=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},wu=function(e,t){var i=t._pt,s="";if(!e&&t.b)s=t.b;else if(e===1&&t.e)s=t.e;else{for(;i;)s=i.p+(i.m?i.m(i.s+i.c*e):Math.round((i.s+i.c*e)*1e4)/1e4)+s,i=i._next;s+=t.c}t.set(t.t,t.p,s,t)},To=function(e,t){for(var i=t._pt;i;)i.r(e,i.d),i=i._next},S0=function(e,t,i,s){for(var n=this._pt,a;n;)a=n._next,n.p===s&&n.modifier(e,t,i),n=a},T0=function(e){for(var t=this._pt,i,s;t;)s=t._next,t.p===e&&!t.op||t.op===e?ln(this,t,"_pt"):t.dep||(i=1),t=s;return!i},w0=function(e,t,i,s){s.mSet(e,t,s.m.call(s.tween,i,s.mt),s)},vu=function(e){for(var t=e._pt,i,s,n,a;t;){for(i=t._next,s=n;s&&s.pr>t.pr;)s=s._next;(t._prev=s?s._prev:a)?t._prev._next=t:n=t,(t._next=s)?s._prev=t:a=t,t=i}e._pt=n},st=function(){function r(t,i,s,n,a,o,l,c,u){this.t=i,this.s=n,this.c=a,this.p=s,this.r=o||Tu,this.d=l||this,this.set=c||yo,this.pr=u||0,this._next=t,t&&(t._prev=this)}var e=r.prototype;return e.modifier=function(i,s,n){this.mSet=this.mSet||this.set,this.set=w0,this.m=i,this.mt=n,this.tween=s},r}();it(_o+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(r){return po[r]=1});_t.TweenMax=_t.TweenLite=be;_t.TimelineLite=_t.TimelineMax=qe;_e=new qe({sortChildren:!1,defaults:_s,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});pt.stringFilter=du;var zi=[],Nr={},v0=[],Vh=0,b0=0,Jn=function(e){return(Nr[e]||v0).map(function(t){return t()})},Wa=function(){var e=Date.now(),t=[];e-Vh>2&&(Jn("matchMediaInit"),zi.forEach(function(i){var s=i.queries,n=i.conditions,a,o,l,c;for(o in s)a=Gt.matchMedia(s[o]).matches,a&&(l=1),a!==n[o]&&(n[o]=a,c=1);c&&(i.revert(),l&&t.push(i))}),Jn("matchMediaRevert"),t.forEach(function(i){return i.onMatch(i,function(s){return i.add(null,s)})}),Vh=e,Jn("matchMedia"))},bu=function(){function r(t,i){this.selector=i&&Ha(i),this.data=[],this._r=[],this.isReverted=!1,this.id=b0++,t&&this.add(t)}var e=r.prototype;return e.add=function(i,s,n){ye(i)&&(n=s,s=i,i=ye);var a=this,o=function(){var c=fe,u=a.selector,h;return c&&c!==a&&c.data.push(a),n&&(a.selector=Ha(n)),fe=a,h=s.apply(a,arguments),ye(h)&&a._r.push(h),fe=c,a.selector=u,a.isReverted=!1,h};return a.last=o,i===ye?o(a,function(l){return a.add(null,l)}):i?a[i]=o:o},e.ignore=function(i){var s=fe;fe=null,i(this),fe=s},e.getTweens=function(){var i=[];return this.data.forEach(function(s){return s instanceof r?i.push.apply(i,s.getTweens()):s instanceof be&&!(s.parent&&s.parent.data==="nested")&&i.push(s)}),i},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(i,s){var n=this;if(i?function(){for(var o=n.getTweens(),l=n.data.length,c;l--;)c=n.data[l],c.data==="isFlip"&&(c.revert(),c.getChildren(!0,!0,!1).forEach(function(u){return o.splice(o.indexOf(u),1)}));for(o.map(function(u){return{g:u._dur||u._delay||u._sat&&!u._sat.vars.immediateRender?u.globalTime(0):-1/0,t:u}}).sort(function(u,h){return h.g-u.g||-1/0}).forEach(function(u){return u.t.revert(i)}),l=n.data.length;l--;)c=n.data[l],c instanceof qe?c.data!=="nested"&&(c.scrollTrigger&&c.scrollTrigger.revert(),c.kill()):!(c instanceof be)&&c.revert&&c.revert(i);n._r.forEach(function(u){return u(i,n)}),n.isReverted=!0}():this.data.forEach(function(o){return o.kill&&o.kill()}),this.clear(),s)for(var a=zi.length;a--;)zi[a].id===this.id&&zi.splice(a,1)},e.revert=function(i){this.kill(i||{})},r}(),A0=function(){function r(t){this.contexts=[],this.scope=t,fe&&fe.data.push(this)}var e=r.prototype;return e.add=function(i,s,n){Wt(i)||(i={matches:i});var a=new bu(0,n||this.scope),o=a.conditions={},l,c,u;fe&&!a.selector&&(a.selector=fe.selector),this.contexts.push(a),s=a.add("onMatch",s),a.queries=i;for(c in i)c==="all"?u=1:(l=Gt.matchMedia(i[c]),l&&(zi.indexOf(a)<0&&zi.push(a),(o[c]=l.matches)&&(u=1),l.addListener?l.addListener(Wa):l.addEventListener("change",Wa)));return u&&s(a,function(h){return a.add(null,h)}),this},e.revert=function(i){this.kill(i||{})},e.kill=function(i){this.contexts.forEach(function(s){return s.kill(i,!0)})},r}(),qr={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach(function(s){return lu(s)})},timeline:function(e){return new qe(e)},getTweensOf:function(e,t){return _e.getTweensOf(e,t)},getProperty:function(e,t,i,s){Oe(e)&&(e=wt(e)[0]);var n=Di(e||{}).get,a=i?Kc:qc;return i==="native"&&(i=""),e&&(t?a((ct[t]&&ct[t].get||n)(e,t,i,s)):function(o,l,c){return a((ct[o]&&ct[o].get||n)(e,o,l,c))})},quickSetter:function(e,t,i){if(e=wt(e),e.length>1){var s=e.map(function(u){return nt.quickSetter(u,t,i)}),n=s.length;return function(u){for(var h=n;h--;)s[h](u)}}e=e[0]||{};var a=ct[t],o=Di(e),l=o.harness&&(o.harness.aliases||{})[t]||t,c=a?function(u){var h=new a;ss._pt=0,h.init(e,i?u+i:u,ss,0,[e]),h.render(1,h),ss._pt&&To(1,ss)}:o.set(e,l);return a?c:function(u){return c(e,l,i?u+i:u,o,1)}},quickTo:function(e,t,i){var s,n=nt.to(e,Yi((s={},s[t]="+=0.1",s.paused=!0,s),i||{})),a=function(l,c,u){return n.resetTo(t,l,c,u)};return a.tween=n,a},isTweening:function(e){return _e.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=Ui(e.ease,_s.ease)),Hh(_s,e||{})},config:function(e){return Hh(pt,e||{})},registerEffect:function(e){var t=e.name,i=e.effect,s=e.plugins,n=e.defaults,a=e.extendTimeline;(s||"").split(",").forEach(function(o){return o&&!ct[o]&&!_t[o]&&Zs(t+" effect requires "+o+" plugin.")}),qn[t]=function(o,l,c){return i(wt(o),vt(l||{},n),c)},a&&(qe.prototype[t]=function(o,l,c){return this.add(qn[t](o,Wt(l)?l:(c=l)&&{},this),c)})},registerEase:function(e,t){ee[e]=Ui(t)},parseEase:function(e,t){return arguments.length?Ui(e,t):ee},getById:function(e){return _e.getById(e)},exportRoot:function(e,t){e===void 0&&(e={});var i=new qe(e),s,n;for(i.smoothChildTiming=tt(e.smoothChildTiming),_e.remove(i),i._dp=0,i._time=i._tTime=_e._time,s=_e._first;s;)n=s._next,(t||!(!s._dur&&s instanceof be&&s.vars.onComplete===s._targets[0]))&&Dt(i,s,s._start-s._delay),s=n;return Dt(_e,i,0),i},context:function(e,t){return e?new bu(e,t):fe},matchMedia:function(e){return new A0(e)},matchMediaRefresh:function(){return zi.forEach(function(e){var t=e.conditions,i,s;for(s in t)t[s]&&(t[s]=!1,i=1);i&&e.revert()})||Wa()},addEventListener:function(e,t){var i=Nr[e]||(Nr[e]=[]);~i.indexOf(t)||i.push(t)},removeEventListener:function(e,t){var i=Nr[e],s=i&&i.indexOf(t);s>=0&&i.splice(s,1)},utils:{wrap:s0,wrapYoyo:r0,distribute:su,random:nu,snap:ru,normalize:i0,getUnit:He,clamp:Qm,splitColor:cu,toArray:wt,selector:Ha,mapRange:ou,pipe:e0,unitize:t0,interpolate:n0,shuffle:iu},install:Yc,effects:qn,ticker:ut,updateRoot:qe.updateRoot,plugins:ct,globalTimeline:_e,core:{PropTween:st,globals:Vc,Tween:be,Timeline:qe,Animation:tr,getCache:Di,_removeLinkedListItem:ln,reverting:function(){return We},context:function(e){return e&&fe&&(fe.data.push(e),e._ctx=fe),fe},suppressOverwrites:function(e){return ho=e}}};it("to,from,fromTo,delayedCall,set,killTweensOf",function(r){return qr[r]=be[r]});ut.add(qe.updateRoot);ss=qr.to({},{duration:0});var P0=function(e,t){for(var i=e._pt;i&&i.p!==t&&i.op!==t&&i.fp!==t;)i=i._next;return i},k0=function(e,t){var i=e._targets,s,n,a;for(s in t)for(n=i.length;n--;)a=e._ptLookup[n][s],a&&(a=a.d)&&(a._pt&&(a=P0(a,s)),a&&a.modifier&&a.modifier(t[s],e,i[n],s))},ea=function(e,t){return{name:e,rawVars:1,init:function(s,n,a){a._onInit=function(o){var l,c;if(Oe(n)&&(l={},it(n,function(u){return l[u]=1}),n=l),t){l={};for(c in n)l[c]=t(n[c]);n=l}k0(o,n)}}}},nt=qr.registerPlugin({name:"attr",init:function(e,t,i,s,n){var a,o,l;this.tween=i;for(a in t)l=e.getAttribute(a)||"",o=this.add(e,"setAttribute",(l||0)+"",t[a],s,n,0,0,a),o.op=a,o.b=l,this._props.push(a)},render:function(e,t){for(var i=t._pt;i;)We?i.set(i.t,i.p,i.b,i):i.r(e,i.d),i=i._next}},{name:"endArray",init:function(e,t){for(var i=t.length;i--;)this.add(e,i,e[i]||0,t[i],0,0,0,0,0,1)}},ea("roundProps",Ua),ea("modifiers"),ea("snap",ru))||qr;be.version=qe.version=nt.version="3.12.5";Wc=1;co()&&xs();ee.Power0;ee.Power1;ee.Power2;ee.Power3;ee.Power4;ee.Linear;ee.Quad;ee.Cubic;ee.Quart;ee.Quint;ee.Strong;ee.Elastic;ee.Back;ee.SteppedEase;ee.Bounce;ee.Sine;ee.Expo;ee.Circ;/*!
 * CSSPlugin 3.12.5
 * https://gsap.com
 *
 * Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var Xh,fi,ls,wo,Ni,$h,vo,E0=function(){return typeof window<"u"},ri={},Li=180/Math.PI,cs=Math.PI/180,Qi=Math.atan2,jh=1e8,bo=/([A-Z])/g,C0=/(left|right|width|margin|padding|x)/i,M0=/[\s,\(]\S/,Ht={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},Ya=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},I0=function(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},R0=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},L0=function(e,t){var i=t.s+t.c*e;t.set(t.t,t.p,~~(i+(i<0?-.5:.5))+t.u,t)},Au=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},Pu=function(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},F0=function(e,t,i){return e.style[t]=i},O0=function(e,t,i){return e.style.setProperty(t,i)},N0=function(e,t,i){return e._gsap[t]=i},B0=function(e,t,i){return e._gsap.scaleX=e._gsap.scaleY=i},G0=function(e,t,i,s,n){var a=e._gsap;a.scaleX=a.scaleY=i,a.renderTransform(n,a)},D0=function(e,t,i,s,n){var a=e._gsap;a[t]=i,a.renderTransform(n,a)},me="transform",rt=me+"Origin",H0=function r(e,t){var i=this,s=this.target,n=s.style,a=s._gsap;if(e in ri&&n){if(this.tfm=this.tfm||{},e!=="transform")e=Ht[e]||e,~e.indexOf(",")?e.split(",").forEach(function(o){return i.tfm[o]=Qt(s,o)}):this.tfm[e]=a.x?a[e]:Qt(s,e),e===rt&&(this.tfm.zOrigin=a.zOrigin);else return Ht.transform.split(",").forEach(function(o){return r.call(i,o,t)});if(this.props.indexOf(me)>=0)return;a.svg&&(this.svgo=s.getAttribute("data-svg-origin"),this.props.push(rt,t,"")),e=me}(n||t)&&this.props.push(e,t,n[e])},ku=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},U0=function(){var e=this.props,t=this.target,i=t.style,s=t._gsap,n,a;for(n=0;n<e.length;n+=3)e[n+1]?t[e[n]]=e[n+2]:e[n+2]?i[e[n]]=e[n+2]:i.removeProperty(e[n].substr(0,2)==="--"?e[n]:e[n].replace(bo,"-$1").toLowerCase());if(this.tfm){for(a in this.tfm)s[a]=this.tfm[a];s.svg&&(s.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),n=vo(),(!n||!n.isStart)&&!i[me]&&(ku(i),s.zOrigin&&i[rt]&&(i[rt]+=" "+s.zOrigin+"px",s.zOrigin=0,s.renderTransform()),s.uncache=1)}},Eu=function(e,t){var i={target:e,props:[],revert:U0,save:H0};return e._gsap||nt.core.getCache(e),t&&t.split(",").forEach(function(s){return i.save(s)}),i},Cu,Va=function(e,t){var i=fi.createElementNS?fi.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):fi.createElement(e);return i&&i.style?i:fi.createElement(e)},Ut=function r(e,t,i){var s=getComputedStyle(e);return s[t]||s.getPropertyValue(t.replace(bo,"-$1").toLowerCase())||s.getPropertyValue(t)||!i&&r(e,ys(t)||t,1)||""},qh="O,Moz,ms,Ms,Webkit".split(","),ys=function(e,t,i){var s=t||Ni,n=s.style,a=5;if(e in n&&!i)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);a--&&!(qh[a]+e in n););return a<0?null:(a===3?"ms":a>=0?qh[a]:"")+e},Xa=function(){E0()&&window.document&&(Xh=window,fi=Xh.document,ls=fi.documentElement,Ni=Va("div")||{style:{}},Va("div"),me=ys(me),rt=me+"Origin",Ni.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",Cu=!!ys("perspective"),vo=nt.core.reverting,wo=1)},ta=function r(e){var t=Va("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,s=this.nextSibling,n=this.style.cssText,a;if(ls.appendChild(t),t.appendChild(this),this.style.display="block",e)try{a=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=r}catch{}else this._gsapBBox&&(a=this._gsapBBox());return i&&(s?i.insertBefore(this,s):i.appendChild(this)),ls.removeChild(t),this.style.cssText=n,a},Kh=function(e,t){for(var i=t.length;i--;)if(e.hasAttribute(t[i]))return e.getAttribute(t[i])},Mu=function(e){var t;try{t=e.getBBox()}catch{t=ta.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===ta||(t=ta.call(e,!0)),t&&!t.width&&!t.x&&!t.y?{x:+Kh(e,["x","cx","x1"])||0,y:+Kh(e,["y","cy","y1"])||0,width:0,height:0}:t},Iu=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&Mu(e))},Vi=function(e,t){if(t){var i=e.style,s;t in ri&&t!==rt&&(t=me),i.removeProperty?(s=t.substr(0,2),(s==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),i.removeProperty(s==="--"?t:t.replace(bo,"-$1").toLowerCase())):i.removeAttribute(t)}},pi=function(e,t,i,s,n,a){var o=new st(e._pt,t,i,0,1,a?Pu:Au);return e._pt=o,o.b=s,o.e=n,e._props.push(i),o},Zh={deg:1,rad:1,turn:1},z0={grid:1,flex:1},xi=function r(e,t,i,s){var n=parseFloat(i)||0,a=(i+"").trim().substr((n+"").length)||"px",o=Ni.style,l=C0.test(t),c=e.tagName.toLowerCase()==="svg",u=(c?"client":"offset")+(l?"Width":"Height"),h=100,d=s==="px",f=s==="%",p,_,g,m;if(s===a||!n||Zh[s]||Zh[a])return n;if(a!=="px"&&!d&&(n=r(e,t,i,"px")),m=e.getCTM&&Iu(e),(f||a==="%")&&(ri[t]||~t.indexOf("adius")))return p=m?e.getBBox()[l?"width":"height"]:e[u],ve(f?n/p*h:n/100*p);if(o[l?"width":"height"]=h+(d?a:s),_=~t.indexOf("adius")||s==="em"&&e.appendChild&&!c?e:e.parentNode,m&&(_=(e.ownerSVGElement||{}).parentNode),(!_||_===fi||!_.appendChild)&&(_=fi.body),g=_._gsap,g&&f&&g.width&&l&&g.time===ut.time&&!g.uncache)return ve(n/g.width*h);if(f&&(t==="height"||t==="width")){var x=e.style[t];e.style[t]=h+s,p=e[u],x?e.style[t]=x:Vi(e,t)}else(f||a==="%")&&!z0[Ut(_,"display")]&&(o.position=Ut(e,"position")),_===e&&(o.position="static"),_.appendChild(Ni),p=Ni[u],_.removeChild(Ni),o.position="absolute";return l&&f&&(g=Di(_),g.time=ut.time,g.width=_[u]),ve(d?p*n/h:p&&n?h/p*n:0)},Qt=function(e,t,i,s){var n;return wo||Xa(),t in Ht&&t!=="transform"&&(t=Ht[t],~t.indexOf(",")&&(t=t.split(",")[0])),ri[t]&&t!=="transform"?(n=sr(e,s),n=t!=="transformOrigin"?n[t]:n.svg?n.origin:Zr(Ut(e,rt))+" "+n.zOrigin+"px"):(n=e.style[t],(!n||n==="auto"||s||~(n+"").indexOf("calc("))&&(n=Kr[t]&&Kr[t](e,t,i)||Ut(e,t)||$c(e,t)||(t==="opacity"?1:0))),i&&!~(n+"").trim().indexOf(" ")?xi(e,t,n,i)+i:n},W0=function(e,t,i,s){if(!i||i==="none"){var n=ys(t,e,1),a=n&&Ut(e,n,1);a&&a!==i?(t=n,i=a):t==="borderColor"&&(i=Ut(e,"borderTopColor"))}var o=new st(this._pt,e.style,t,0,1,wu),l=0,c=0,u,h,d,f,p,_,g,m,x,S,w,A;if(o.b=i,o.e=s,i+="",s+="",s==="auto"&&(_=e.style[t],e.style[t]=s,s=Ut(e,t)||s,_?e.style[t]=_:Vi(e,t)),u=[i,s],du(u),i=u[0],s=u[1],d=i.match(is)||[],A=s.match(is)||[],A.length){for(;h=is.exec(s);)g=h[0],x=s.substring(l,h.index),p?p=(p+1)%5:(x.substr(-5)==="rgba("||x.substr(-5)==="hsla(")&&(p=1),g!==(_=d[c++]||"")&&(f=parseFloat(_)||0,w=_.substr((f+"").length),g.charAt(1)==="="&&(g=hs(f,g)+w),m=parseFloat(g),S=g.substr((m+"").length),l=is.lastIndex-S.length,S||(S=S||pt.units[t]||w,l===s.length&&(s+=S,o.e+=S)),w!==S&&(f=xi(e,t,_,S)||0),o._pt={_next:o._pt,p:x||c===1?x:",",s:f,c:m-f,m:p&&p<4||t==="zIndex"?Math.round:0});o.c=l<s.length?s.substring(l,s.length):""}else o.r=t==="display"&&s==="none"?Pu:Au;return Uc.test(s)&&(o.e=0),this._pt=o,o},Qh={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Y0=function(e){var t=e.split(" "),i=t[0],s=t[1]||"50%";return(i==="top"||i==="bottom"||s==="left"||s==="right")&&(e=i,i=s,s=e),t[0]=Qh[i]||i,t[1]=Qh[s]||s,t.join(" ")},V0=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var i=t.t,s=i.style,n=t.u,a=i._gsap,o,l,c;if(n==="all"||n===!0)s.cssText="",l=1;else for(n=n.split(","),c=n.length;--c>-1;)o=n[c],ri[o]&&(l=1,o=o==="transformOrigin"?rt:me),Vi(i,o);l&&(Vi(i,me),a&&(a.svg&&i.removeAttribute("transform"),sr(i,1),a.uncache=1,ku(s)))}},Kr={clearProps:function(e,t,i,s,n){if(n.data!=="isFromStart"){var a=e._pt=new st(e._pt,t,i,0,0,V0);return a.u=s,a.pr=-10,a.tween=n,e._props.push(i),1}}},ir=[1,0,0,1,0,0],Ru={},Lu=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},Jh=function(e){var t=Ut(e,me);return Lu(t)?ir:t.substr(7).match(Hc).map(ve)},Ao=function(e,t){var i=e._gsap||Di(e),s=e.style,n=Jh(e),a,o,l,c;return i.svg&&e.getAttribute("transform")?(l=e.transform.baseVal.consolidate().matrix,n=[l.a,l.b,l.c,l.d,l.e,l.f],n.join(",")==="1,0,0,1,0,0"?ir:n):(n===ir&&!e.offsetParent&&e!==ls&&!i.svg&&(l=s.display,s.display="block",a=e.parentNode,(!a||!e.offsetParent)&&(c=1,o=e.nextElementSibling,ls.appendChild(e)),n=Jh(e),l?s.display=l:Vi(e,"display"),c&&(o?a.insertBefore(e,o):a?a.appendChild(e):ls.removeChild(e))),t&&n.length>6?[n[0],n[1],n[4],n[5],n[12],n[13]]:n)},$a=function(e,t,i,s,n,a){var o=e._gsap,l=n||Ao(e,!0),c=o.xOrigin||0,u=o.yOrigin||0,h=o.xOffset||0,d=o.yOffset||0,f=l[0],p=l[1],_=l[2],g=l[3],m=l[4],x=l[5],S=t.split(" "),w=parseFloat(S[0])||0,A=parseFloat(S[1])||0,k,P,E,b;i?l!==ir&&(P=f*g-p*_)&&(E=w*(g/P)+A*(-_/P)+(_*x-g*m)/P,b=w*(-p/P)+A*(f/P)-(f*x-p*m)/P,w=E,A=b):(k=Mu(e),w=k.x+(~S[0].indexOf("%")?w/100*k.width:w),A=k.y+(~(S[1]||S[0]).indexOf("%")?A/100*k.height:A)),s||s!==!1&&o.smooth?(m=w-c,x=A-u,o.xOffset=h+(m*f+x*_)-m,o.yOffset=d+(m*p+x*g)-x):o.xOffset=o.yOffset=0,o.xOrigin=w,o.yOrigin=A,o.smooth=!!s,o.origin=t,o.originIsAbsolute=!!i,e.style[rt]="0px 0px",a&&(pi(a,o,"xOrigin",c,w),pi(a,o,"yOrigin",u,A),pi(a,o,"xOffset",h,o.xOffset),pi(a,o,"yOffset",d,o.yOffset)),e.setAttribute("data-svg-origin",w+" "+A)},sr=function(e,t){var i=e._gsap||new gu(e);if("x"in i&&!t&&!i.uncache)return i;var s=e.style,n=i.scaleX<0,a="px",o="deg",l=getComputedStyle(e),c=Ut(e,rt)||"0",u,h,d,f,p,_,g,m,x,S,w,A,k,P,E,b,M,N,H,L,F,G,$,K,Se,U,Y,Te,D,at,Pe,Ve;return u=h=d=_=g=m=x=S=w=0,f=p=1,i.svg=!!(e.getCTM&&Iu(e)),l.translate&&((l.translate!=="none"||l.scale!=="none"||l.rotate!=="none")&&(s[me]=(l.translate!=="none"?"translate3d("+(l.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(l.rotate!=="none"?"rotate("+l.rotate+") ":"")+(l.scale!=="none"?"scale("+l.scale.split(" ").join(",")+") ":"")+(l[me]!=="none"?l[me]:"")),s.scale=s.rotate=s.translate="none"),P=Ao(e,i.svg),i.svg&&(i.uncache?(Se=e.getBBox(),c=i.xOrigin-Se.x+"px "+(i.yOrigin-Se.y)+"px",K=""):K=!t&&e.getAttribute("data-svg-origin"),$a(e,K||c,!!K||i.originIsAbsolute,i.smooth!==!1,P)),A=i.xOrigin||0,k=i.yOrigin||0,P!==ir&&(N=P[0],H=P[1],L=P[2],F=P[3],u=G=P[4],h=$=P[5],P.length===6?(f=Math.sqrt(N*N+H*H),p=Math.sqrt(F*F+L*L),_=N||H?Qi(H,N)*Li:0,x=L||F?Qi(L,F)*Li+_:0,x&&(p*=Math.abs(Math.cos(x*cs))),i.svg&&(u-=A-(A*N+k*L),h-=k-(A*H+k*F))):(Ve=P[6],at=P[7],Y=P[8],Te=P[9],D=P[10],Pe=P[11],u=P[12],h=P[13],d=P[14],E=Qi(Ve,D),g=E*Li,E&&(b=Math.cos(-E),M=Math.sin(-E),K=G*b+Y*M,Se=$*b+Te*M,U=Ve*b+D*M,Y=G*-M+Y*b,Te=$*-M+Te*b,D=Ve*-M+D*b,Pe=at*-M+Pe*b,G=K,$=Se,Ve=U),E=Qi(-L,D),m=E*Li,E&&(b=Math.cos(-E),M=Math.sin(-E),K=N*b-Y*M,Se=H*b-Te*M,U=L*b-D*M,Pe=F*M+Pe*b,N=K,H=Se,L=U),E=Qi(H,N),_=E*Li,E&&(b=Math.cos(E),M=Math.sin(E),K=N*b+H*M,Se=G*b+$*M,H=H*b-N*M,$=$*b-G*M,N=K,G=Se),g&&Math.abs(g)+Math.abs(_)>359.9&&(g=_=0,m=180-m),f=ve(Math.sqrt(N*N+H*H+L*L)),p=ve(Math.sqrt($*$+Ve*Ve)),E=Qi(G,$),x=Math.abs(E)>2e-4?E*Li:0,w=Pe?1/(Pe<0?-Pe:Pe):0),i.svg&&(K=e.getAttribute("transform"),i.forceCSS=e.setAttribute("transform","")||!Lu(Ut(e,me)),K&&e.setAttribute("transform",K))),Math.abs(x)>90&&Math.abs(x)<270&&(n?(f*=-1,x+=_<=0?180:-180,_+=_<=0?180:-180):(p*=-1,x+=x<=0?180:-180)),t=t||i.uncache,i.x=u-((i.xPercent=u&&(!t&&i.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-u)?-50:0)))?e.offsetWidth*i.xPercent/100:0)+a,i.y=h-((i.yPercent=h&&(!t&&i.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-h)?-50:0)))?e.offsetHeight*i.yPercent/100:0)+a,i.z=d+a,i.scaleX=ve(f),i.scaleY=ve(p),i.rotation=ve(_)+o,i.rotationX=ve(g)+o,i.rotationY=ve(m)+o,i.skewX=x+o,i.skewY=S+o,i.transformPerspective=w+a,(i.zOrigin=parseFloat(c.split(" ")[2])||!t&&i.zOrigin||0)&&(s[rt]=Zr(c)),i.xOffset=i.yOffset=0,i.force3D=pt.force3D,i.renderTransform=i.svg?$0:Cu?Fu:X0,i.uncache=0,i},Zr=function(e){return(e=e.split(" "))[0]+" "+e[1]},ia=function(e,t,i){var s=He(t);return ve(parseFloat(t)+parseFloat(xi(e,"x",i+"px",s)))+s},X0=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,Fu(e,t)},ki="0deg",Rs="0px",Ei=") ",Fu=function(e,t){var i=t||this,s=i.xPercent,n=i.yPercent,a=i.x,o=i.y,l=i.z,c=i.rotation,u=i.rotationY,h=i.rotationX,d=i.skewX,f=i.skewY,p=i.scaleX,_=i.scaleY,g=i.transformPerspective,m=i.force3D,x=i.target,S=i.zOrigin,w="",A=m==="auto"&&e&&e!==1||m===!0;if(S&&(h!==ki||u!==ki)){var k=parseFloat(u)*cs,P=Math.sin(k),E=Math.cos(k),b;k=parseFloat(h)*cs,b=Math.cos(k),a=ia(x,a,P*b*-S),o=ia(x,o,-Math.sin(k)*-S),l=ia(x,l,E*b*-S+S)}g!==Rs&&(w+="perspective("+g+Ei),(s||n)&&(w+="translate("+s+"%, "+n+"%) "),(A||a!==Rs||o!==Rs||l!==Rs)&&(w+=l!==Rs||A?"translate3d("+a+", "+o+", "+l+") ":"translate("+a+", "+o+Ei),c!==ki&&(w+="rotate("+c+Ei),u!==ki&&(w+="rotateY("+u+Ei),h!==ki&&(w+="rotateX("+h+Ei),(d!==ki||f!==ki)&&(w+="skew("+d+", "+f+Ei),(p!==1||_!==1)&&(w+="scale("+p+", "+_+Ei),x.style[me]=w||"translate(0, 0)"},$0=function(e,t){var i=t||this,s=i.xPercent,n=i.yPercent,a=i.x,o=i.y,l=i.rotation,c=i.skewX,u=i.skewY,h=i.scaleX,d=i.scaleY,f=i.target,p=i.xOrigin,_=i.yOrigin,g=i.xOffset,m=i.yOffset,x=i.forceCSS,S=parseFloat(a),w=parseFloat(o),A,k,P,E,b;l=parseFloat(l),c=parseFloat(c),u=parseFloat(u),u&&(u=parseFloat(u),c+=u,l+=u),l||c?(l*=cs,c*=cs,A=Math.cos(l)*h,k=Math.sin(l)*h,P=Math.sin(l-c)*-d,E=Math.cos(l-c)*d,c&&(u*=cs,b=Math.tan(c-u),b=Math.sqrt(1+b*b),P*=b,E*=b,u&&(b=Math.tan(u),b=Math.sqrt(1+b*b),A*=b,k*=b)),A=ve(A),k=ve(k),P=ve(P),E=ve(E)):(A=h,E=d,k=P=0),(S&&!~(a+"").indexOf("px")||w&&!~(o+"").indexOf("px"))&&(S=xi(f,"x",a,"px"),w=xi(f,"y",o,"px")),(p||_||g||m)&&(S=ve(S+p-(p*A+_*P)+g),w=ve(w+_-(p*k+_*E)+m)),(s||n)&&(b=f.getBBox(),S=ve(S+s/100*b.width),w=ve(w+n/100*b.height)),b="matrix("+A+","+k+","+P+","+E+","+S+","+w+")",f.setAttribute("transform",b),x&&(f.style[me]=b)},j0=function(e,t,i,s,n){var a=360,o=Oe(n),l=parseFloat(n)*(o&&~n.indexOf("rad")?Li:1),c=l-s,u=s+c+"deg",h,d;return o&&(h=n.split("_")[1],h==="short"&&(c%=a,c!==c%(a/2)&&(c+=c<0?a:-a)),h==="cw"&&c<0?c=(c+a*jh)%a-~~(c/a)*a:h==="ccw"&&c>0&&(c=(c-a*jh)%a-~~(c/a)*a)),e._pt=d=new st(e._pt,t,i,s,c,I0),d.e=u,d.u="deg",e._props.push(i),d},el=function(e,t){for(var i in t)e[i]=t[i];return e},q0=function(e,t,i){var s=el({},i._gsap),n="perspective,force3D,transformOrigin,svgOrigin",a=i.style,o,l,c,u,h,d,f,p;s.svg?(c=i.getAttribute("transform"),i.setAttribute("transform",""),a[me]=t,o=sr(i,1),Vi(i,me),i.setAttribute("transform",c)):(c=getComputedStyle(i)[me],a[me]=t,o=sr(i,1),a[me]=c);for(l in ri)c=s[l],u=o[l],c!==u&&n.indexOf(l)<0&&(f=He(c),p=He(u),h=f!==p?xi(i,l,c,p):parseFloat(c),d=parseFloat(u),e._pt=new st(e._pt,o,l,h,d-h,Ya),e._pt.u=p||0,e._props.push(l));el(o,s)};it("padding,margin,Width,Radius",function(r,e){var t="Top",i="Right",s="Bottom",n="Left",a=(e<3?[t,i,s,n]:[t+n,t+i,s+i,s+n]).map(function(o){return e<2?r+o:"border"+o+r});Kr[e>1?"border"+r:r]=function(o,l,c,u,h){var d,f;if(arguments.length<4)return d=a.map(function(p){return Qt(o,p,c)}),f=d.join(" "),f.split(d[0]).length===5?d[0]:f;d=(u+"").split(" "),f={},a.forEach(function(p,_){return f[p]=d[_]=d[_]||d[(_-1)/2|0]}),o.init(l,f,h)}});var Ou={name:"css",register:Xa,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,i,s,n){var a=this._props,o=e.style,l=i.vars.startAt,c,u,h,d,f,p,_,g,m,x,S,w,A,k,P,E;wo||Xa(),this.styles=this.styles||Eu(e),E=this.styles.props,this.tween=i;for(_ in t)if(_!=="autoRound"&&(u=t[_],!(ct[_]&&mu(_,t,i,s,e,n)))){if(f=typeof u,p=Kr[_],f==="function"&&(u=u.call(i,s,e,n),f=typeof u),f==="string"&&~u.indexOf("random(")&&(u=Js(u)),p)p(this,e,_,u,i)&&(P=1);else if(_.substr(0,2)==="--")c=(getComputedStyle(e).getPropertyValue(_)+"").trim(),u+="",gi.lastIndex=0,gi.test(c)||(g=He(c),m=He(u)),m?g!==m&&(c=xi(e,_,c,m)+m):g&&(u+=g),this.add(o,"setProperty",c,u,s,n,0,0,_),a.push(_),E.push(_,0,o[_]);else if(f!=="undefined"){if(l&&_ in l?(c=typeof l[_]=="function"?l[_].call(i,s,e,n):l[_],Oe(c)&&~c.indexOf("random(")&&(c=Js(c)),He(c+"")||c==="auto"||(c+=pt.units[_]||He(Qt(e,_))||""),(c+"").charAt(1)==="="&&(c=Qt(e,_))):c=Qt(e,_),d=parseFloat(c),x=f==="string"&&u.charAt(1)==="="&&u.substr(0,2),x&&(u=u.substr(2)),h=parseFloat(u),_ in Ht&&(_==="autoAlpha"&&(d===1&&Qt(e,"visibility")==="hidden"&&h&&(d=0),E.push("visibility",0,o.visibility),pi(this,o,"visibility",d?"inherit":"hidden",h?"inherit":"hidden",!h)),_!=="scale"&&_!=="transform"&&(_=Ht[_],~_.indexOf(",")&&(_=_.split(",")[0]))),S=_ in ri,S){if(this.styles.save(_),w||(A=e._gsap,A.renderTransform&&!t.parseTransform||sr(e,t.parseTransform),k=t.smoothOrigin!==!1&&A.smooth,w=this._pt=new st(this._pt,o,me,0,1,A.renderTransform,A,0,-1),w.dep=1),_==="scale")this._pt=new st(this._pt,A,"scaleY",A.scaleY,(x?hs(A.scaleY,x+h):h)-A.scaleY||0,Ya),this._pt.u=0,a.push("scaleY",_),_+="X";else if(_==="transformOrigin"){E.push(rt,0,o[rt]),u=Y0(u),A.svg?$a(e,u,0,k,0,this):(m=parseFloat(u.split(" ")[2])||0,m!==A.zOrigin&&pi(this,A,"zOrigin",A.zOrigin,m),pi(this,o,_,Zr(c),Zr(u)));continue}else if(_==="svgOrigin"){$a(e,u,1,k,0,this);continue}else if(_ in Ru){j0(this,A,_,d,x?hs(d,x+u):u);continue}else if(_==="smoothOrigin"){pi(this,A,"smooth",A.smooth,u);continue}else if(_==="force3D"){A[_]=u;continue}else if(_==="transform"){q0(this,u,e);continue}}else _ in o||(_=ys(_)||_);if(S||(h||h===0)&&(d||d===0)&&!M0.test(u)&&_ in o)g=(c+"").substr((d+"").length),h||(h=0),m=He(u)||(_ in pt.units?pt.units[_]:g),g!==m&&(d=xi(e,_,c,m)),this._pt=new st(this._pt,S?A:o,_,d,(x?hs(d,x+h):h)-d,!S&&(m==="px"||_==="zIndex")&&t.autoRound!==!1?L0:Ya),this._pt.u=m||0,g!==m&&m!=="%"&&(this._pt.b=c,this._pt.r=R0);else if(_ in o)W0.call(this,e,_,c,x?x+u:u);else if(_ in e)this.add(e,_,c||e[_],x?x+u:u,s,n);else if(_!=="parseTransform"){fo(_,u);continue}S||(_ in o?E.push(_,0,o[_]):E.push(_,1,c||e[_])),a.push(_)}}P&&vu(this)},render:function(e,t){if(t.tween._time||!vo())for(var i=t._pt;i;)i.r(e,i.d),i=i._next;else t.styles.revert()},get:Qt,aliases:Ht,getSetter:function(e,t,i){var s=Ht[t];return s&&s.indexOf(",")<0&&(t=s),t in ri&&t!==rt&&(e._gsap.x||Qt(e,"x"))?i&&$h===i?t==="scale"?B0:N0:($h=i||{})&&(t==="scale"?G0:D0):e.style&&!lo(e.style[t])?F0:~t.indexOf("-")?O0:So(e,t)},core:{_removeProperty:Vi,_getMatrix:Ao}};nt.utils.checkPrefix=ys;nt.core.getStyleSaver=Eu;(function(r,e,t,i){var s=it(r+","+e+","+t,function(n){ri[n]=1});it(e,function(n){pt.units[n]="deg",Ru[n]=1}),Ht[s[13]]=r+","+e,it(i,function(n){var a=n.split(":");Ht[a[1]]=s[a[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");it("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(r){pt.units[r]="px"});nt.registerPlugin(Ou);var se=nt.registerPlugin(Ou)||nt;se.core.Tween;class K0{constructor(){this.framePeriod=1e3/60,this.paused=!1,this.running=!1,this.tick=e=>{const t=performance.now();this.gameTime===void 0&&(this.gameTime=t);const i=3;for(this.gameTime=Math.max(this.gameTime,t-i*this.framePeriod),this.paused&&(this.gameTime=t);this.gameTime<t;)state.update(),this.gameTime+=this.framePeriod;se.ticker.tick(),state.draw()}}setUpdatesPerSecond(e){this.framePeriod=1e3/e}init(){this.start()}start(){this.running||(kt.shared.add(this.tick),this.running=!0)}stop(){this.running&&(kt.shared.remove(this.tick),this.running=!1)}}function Z0(){globalThis.executive=new K0}class Q0 extends nr{constructor(){super(De.FINISH),this.pixiGamePanel=null,this.triggers={0:{draw:()=>{var e,t,i,s;renderer.setLevelFlash(!1),renderer.blitMap(),renderer.drawScore(),renderer.drawFruit(),renderer.drawActors(),(e=this.pixiGamePanel)==null||e.hideFruit(),(t=this.pixiGamePanel)==null||t.hideGhosts(),(i=this.pixiGamePanel)==null||i.showPlayer(),(s=this.pixiGamePanel)==null||s.drawMap()}},120:{draw:()=>{this.flashFloorAndDraw(!0)}},132:{draw:()=>{this.flashFloorAndDraw(!1)}},144:{draw:()=>{this.flashFloorAndDraw(!0)}},156:{draw:()=>{this.flashFloorAndDraw(!1)}},168:{draw:()=>{this.flashFloorAndDraw(!0)}},180:{draw:()=>{this.flashFloorAndDraw(!1)}},192:{draw:()=>{this.flashFloorAndDraw(!0)}},216:{init:()=>{level===13?switchState(congraState,60):switchState(readyNewState,60)},draw:()=>{}}}}init(){super.init(),executive.setUpdatesPerSecond(60),this.gameStore=te().game,te().saveScore(),this.pixiGamePanel=X(),this.pixiGamePanel.resetFrame()}flashFloorAndDraw(e){var t,i,s;(t=this.pixiGamePanel)==null||t.showPlayer(),e?(i=this.pixiGamePanel)==null||i.drawMap():(s=this.pixiGamePanel)==null||s.hideMap()}setAlpha(e){X().setAlpha(e)}hide(){var e;(e=this.pixiGamePanel)==null||e.hide()}}function sa(){globalThis.finishState=new Q0}class J0 extends Vt{constructor(){super(PIXI_RENDERER.getRootLayer(),Ct.STATE),this.frames=0,this.pane=PIXI_RENDERER.getRootLayer(),console.log("Adding PixiIntroPanel"),this.introScreenSS=new O(this.layer,["asset/assets3/intro_screen.png"],.5,0,skinWidth/2,skinMainPanelT,700,865,e=>{this.onGameStartPressed()}),this.gameStartButtonSS=new O(this.layer,["//btn/btn_start2_01.png","//btn/btn_start2_02.png"],.5,0,skinWidth/2,skinMainPanelT+600,620,180),this.gameStartST=new ne(this.layer,"PRESS TO PLAY","#ffffff","center",.5,0,skinWidth/2,skinMainPanelT+670,11),this.powerPelletForAniSSVisible=!1,this.powerPelletForAniSS=new O(this.layer,["//game/dot_power_pelet.png"],0,.5,250,890,80*.8*.7,80*.8*.7)}draw(){this.frames+=1,this.layer.visible=!0,this.introScreenSS.draw();const e=20;this.frames%e<e/2?this.gameStartButtonSS.setTextureIndex(0):this.gameStartButtonSS.setTextureIndex(1),this.gameStartButtonSS.draw(),this.gameStartST.draw(),this.powerPelletForAniSSVisible&&this.powerPelletForAniSS.draw()}hidePowerPelletForAniSS(){this.powerPelletForAniSSVisible=!1,this.powerPelletForAniSS.hide()}showPowerPelletForAniSS(){this.powerPelletForAniSSVisible=!0}hide(){this.layer.visible=!1}onGameStartPressed(){console.log("GAME START!!"),state.exitTo(newGameState,60)}setAlpha(e){this.layer.alpha=e}}var ra=null;function ja(){return ra===null&&(ra=new J0),ra}const tl="#fff";class ex extends Vt{constructor(){super(PIXI_RENDERER.getRootLayer(),Ct.SPEED),this.frame=0;const e=295,t=100,i=skinMainPanelB+20,s=60;this.bgScreenScaledSprite=new O(this.layer,["asset/assets3/bg_speed.png"],0,0,s,i,e,t);const n=s+25;this.directionUpSS=new O(this.layer,["//btn/direction_up.png"],.5,.5,n+20,i+100/2-20,20,20),this.directionDownSS=new O(this.layer,["//btn/direction_down.png"],.5,.5,n+20,i+100/2+20,20,20),this.directionLeftSS=new O(this.layer,["//btn/direction_left.png"],.5,.5,n,i+100/2,20,20),this.directionRightSS=new O(this.layer,["//btn/direction_right.png"],.5,.5,n+20+20,i+100/2,20,20);const a=n+20+30+20;this.speedLabelST=new ne(this.layer,"-",tl,"left",0,.5,a,i+37+3,Z(17));let o=a;this.speedBarSSList=[],this.speedBarSSList.push(new O(this.layer,["//speed/speed_intro_start.png","//speed/speed_default_start.png","//speed/speed_01_start.png","//speed/speed_02_start.png","//speed/speed_03_start.png","//speed/speed_04_start.png","//speed/speed_05_start.png","//speed/speed_06_start.png","//speed/speed_final01_start.png","//speed/speed_final02_start.png","//speed/speed_final03_start.png"],0,0,o,i+55,25,15));for(let l=0;l<5;l++)o+=26,this.speedBarSSList.push(new O(this.layer,["//speed/speed_intro_middle.png","//speed/speed_default_middle.png","//speed/speed_01_middle.png","//speed/speed_02_middle.png","//speed/speed_03_middle.png","//speed/speed_04_middle.png","//speed/speed_05_middle.png","//speed/speed_06_middle.png","//speed/speed_final01_middle.png","//speed/speed_final02_middle.png","//speed/speed_final03_middle.png"],0,0,o,i+55,25,15));o+=26,this.speedBarSSList.push(new O(this.layer,["//speed/speed_intro_end.png","//speed/speed_default_end.png","//speed/speed_01_end.png","//speed/speed_02_end.png","//speed/speed_03_end.png","//speed/speed_04_end.png","//speed/speed_05_end.png","//speed/speed_06_end.png","//speed/speed_final01_end.png","//speed/speed_final02_end.png","//speed/speed_final03_end.png"],0,0,o,i+55,25,15))}draw(){switch(this.bgScreenScaledSprite.draw(),this.directionUpSS.setAlpha(.3),this.directionDownSS.setAlpha(.3),this.directionLeftSS.setAlpha(.3),this.directionRightSS.setAlpha(.3),pacman.inputDirEnum){case DIR_UP:this.directionUpSS.setAlpha(1);break;case DIR_DOWN:this.directionDownSS.setAlpha(1);break;case DIR_LEFT:this.directionLeftSS.setAlpha(1);break;case DIR_RIGHT:this.directionRightSS.setAlpha(1);break}this.directionUpSS.draw(),this.directionDownSS.draw(),this.directionLeftSS.draw(),this.directionRightSS.draw();let t=te().game.speedTimer.calcSpeedLevel()+2;const i=te().game.speedTimer.checkBoostDisabled(),s=te().game.speedTimer.calcGameAge()%RF_SPEED_BOOST_SPOOL_UP_TIME,n=RF_SPEED_BOOST_SPOOL_UP_TIME/7;if(s===0||i)this.speedBarSSList[0].setTextureIndex(0),this.speedBarSSList[1].setTextureIndex(0),this.speedBarSSList[2].setTextureIndex(0),this.speedBarSSList[3].setTextureIndex(0),this.speedBarSSList[4].setTextureIndex(0),this.speedBarSSList[5].setTextureIndex(0),this.speedBarSSList[6].setTextureIndex(0);else if(s<n)this.speedBarSSList[0].setTextureIndex(1),this.speedBarSSList[1].setTextureIndex(1),this.speedBarSSList[2].setTextureIndex(1),this.speedBarSSList[3].setTextureIndex(1),this.speedBarSSList[4].setTextureIndex(1),this.speedBarSSList[5].setTextureIndex(1),this.speedBarSSList[6].setTextureIndex(1);else if(s<n*2)this.speedBarSSList[0].setTextureIndex(t),this.speedBarSSList[1].setTextureIndex(1),this.speedBarSSList[2].setTextureIndex(1),this.speedBarSSList[3].setTextureIndex(1),this.speedBarSSList[4].setTextureIndex(1),this.speedBarSSList[5].setTextureIndex(1),this.speedBarSSList[6].setTextureIndex(1);else if(s<n*3)this.speedBarSSList[0].setTextureIndex(t),this.speedBarSSList[1].setTextureIndex(t),this.speedBarSSList[2].setTextureIndex(1),this.speedBarSSList[3].setTextureIndex(1),this.speedBarSSList[4].setTextureIndex(1),this.speedBarSSList[5].setTextureIndex(1),this.speedBarSSList[6].setTextureIndex(1);else if(s<n*4)this.speedBarSSList[0].setTextureIndex(t),this.speedBarSSList[1].setTextureIndex(t),this.speedBarSSList[2].setTextureIndex(t),this.speedBarSSList[3].setTextureIndex(1),this.speedBarSSList[4].setTextureIndex(1),this.speedBarSSList[5].setTextureIndex(1),this.speedBarSSList[6].setTextureIndex(1);else if(s<n*5)this.speedBarSSList[0].setTextureIndex(t),this.speedBarSSList[1].setTextureIndex(t),this.speedBarSSList[2].setTextureIndex(t),this.speedBarSSList[3].setTextureIndex(t),this.speedBarSSList[4].setTextureIndex(1),this.speedBarSSList[5].setTextureIndex(1),this.speedBarSSList[6].setTextureIndex(1);else if(s<n*6)this.speedBarSSList[0].setTextureIndex(t),this.speedBarSSList[1].setTextureIndex(t),this.speedBarSSList[2].setTextureIndex(t),this.speedBarSSList[3].setTextureIndex(t),this.speedBarSSList[4].setTextureIndex(t),this.speedBarSSList[5].setTextureIndex(1),this.speedBarSSList[6].setTextureIndex(1);else if(s<n*7){this.speedBarSSList[0].setTextureIndex(t),this.speedBarSSList[1].setTextureIndex(t),this.speedBarSSList[2].setTextureIndex(t),this.speedBarSSList[3].setTextureIndex(t),this.speedBarSSList[4].setTextureIndex(t),this.speedBarSSList[5].setTextureIndex(t);const o=s%1e3;o<500?this.speedBarSSList[6].setTextureIndex(1):o<600?this.speedBarSSList[6].setTextureIndex(t):o<700?this.speedBarSSList[6].setTextureIndex(1):o<750?this.speedBarSSList[6].setTextureIndex(t):o<800?this.speedBarSSList[6].setTextureIndex(1):o<850?this.speedBarSSList[6].setTextureIndex(t):o<900?this.speedBarSSList[6].setTextureIndex(1):o<925?this.speedBarSSList[6].setTextureIndex(t):o<950?this.speedBarSSList[6].setTextureIndex(1):this.speedBarSSList[6].setTextureIndex(t)}else this.speedBarSSList[0].setTextureIndex(t),this.speedBarSSList[1].setTextureIndex(t),this.speedBarSSList[2].setTextureIndex(t),this.speedBarSSList[3].setTextureIndex(t),this.speedBarSSList[4].setTextureIndex(t),this.speedBarSSList[5].setTextureIndex(t),this.speedBarSSList[6].setTextureIndex(t);te().game.score.visible?(this.speedLabelST.setText(te().game.speedTimer.getSpeedNotice()),this.speedLabelST.setAlpha(1),level>=9?this.speedLabelST.setColor("#f00"):this.speedLabelST.setColor(tl),this.speedLabelST.draw()):(this.speedLabelST.setText("SPEED"),this.speedLabelST.setAlpha(.2),this.speedLabelST.draw());for(let o of this.speedBarSSList)o.draw();this.frame+=1}}var na=null;function dn(){return na===null&&(na=new ex),na}class tx extends Vt{constructor(){super(PIXI_RENDERER.getRootLayer(),Ct.STATE),this.ghostSSList=[],this.dotLineDots=[],this.ghostCharacterSTList=[],this.ghostNicknameSTList=[],this.fruitSSList1=[],this.fruitSSList2=[],this.fruitPointSTList1=[],this.fruitPointSTList2=[],this.powerPelletForAniSSVisible=!1,this.pelletForAniSSCount=16,this.pelletForAniSSList=[],this.pelletForAniSSVisiableList=[],this.frames=0;const e=skinMainPanelT,t=skinMainPanelL,i=skinMainPanelL+skinMainPanelW;this.infoScreenSS=new O(this.layer,["asset/assets3/info_screen.png"],.5,0,skinWidth/2,e,skinMainPanelW,skinMainPanelH,L=>{this.onCloseButtonClicked()}),this.infoCloseButtonSS=new O(this.layer,["asset/assets3/info_btn_close.png"],1,0,i-30,e+35,40,40);const s=e+35+40;this.informationST=new ne(this.layer,"INFORMATION","#3cdc00","center",.5,0,skinWidth/2,s,12);const n=s+100;this.characterST=new ne(this.layer,"CHARACTER","#ffffff","center",0,0,t+190,n,Z(21)),this.nicknameST=new ne(this.layer,"NICKNAME","#ffffff","center",0,0,t+440,n,Z(21));const a=t+90,o=a+70,l=o+70,c=l+240,u=n+70;this.initCharacterRow(u,["//game/ghost_Blinky_left01.png","//game/ghost_Blinky_left02.png"],"SHADOW","BLINKY","#ff0000",a,o,l,c,11);const h=u+70;this.initCharacterRow(h,["//game/ghost_Pinky_down01.png","//game/ghost_Pinky_down02.png"],"SPEEDY","PINKY","#ffa8de",a,o,l,c,13);const d=h+70;this.initCharacterRow(d,["//game/ghost_Inky_up01.png","//game/ghost_Inky_up02.png"],"BASHFUL","INKY","#00cdff",a,o,l,c,11);const f=d+70;this.initCharacterRow(f,["//game/ghost_Clyde_right01.png","//game/ghost_Clyde_right02.png"],"POKEY","CLYDE","#ffa800",a,o,l,c,14);const p=skinMainPanelT+630+14,_=230;this.pelletSS=new O(this.layer,["//game/dot.png"],0,.5,_,p,80,80),this.point10ST=new ne(this.layer,"10","#3cdc00","left",0,.5,_+50,p+7,Z(15)),this.point10ptsST=new ne(this.layer,"PTS","#3cdc00","left",0,.5,_+80,p+3+5,Z(12)),this.powerPelletSS=new O(this.layer,["//game/dot_power_pelet.png"],0,.5,_+120,p,80*.8,80*.8),this.point50ST=new ne(this.layer,"50","#3cdc00","left",0,.5,_+175,p+7,Z(15)),this.point50ptsST=new ne(this.layer,"PTS","#3cdc00","left",0,.5,_+205,p+3+5,Z(12));const g=skinMainPanelT+630+50,m=t+60,x=50,S=30,w=i-100;this.allItemsSt1=new ne(this.layer,"ALL","#ffff00","center",.5,0,w,g+50-3,Z(15)),this.allItemsSt2=new ne(this.layer,"ITEMS","#ffff00","center",.5,0,w,g+70-3,Z(15)),this.allItemsSt3=new ne(this.layer,`+${RF_FRUIT_ALL_EATEN_PRISE}`,"#ffff00","center",.5,0,w,g+90,Z(18)),this.fruitSSList1.push(new O(this.layer,["//game/fruit_cherry.png"],0,0,m,g,x,x)),this.fruitSSList1.push(new O(this.layer,["//game/fruit_strawberry.png"],0,0,m+(x+S)*1,g,x,x)),this.fruitSSList1.push(new O(this.layer,["//game/fruit_orange.png"],0,0,m+(x+S)*2,g,x,x)),this.fruitSSList1.push(new O(this.layer,["//game/fruit_apple.png"],0,0,m+(x+S)*3,g,x,x)),this.fruitSSList1.push(new O(this.layer,["//game/fruit_melon.png"],0,0,m+(x+S)*4,g,x,x)),this.fruitSSList1.push(new O(this.layer,["//game/fruit_eggplant.png"],0,0,m+(x+S)*5,g,x,x));const A=RF_FRUIT_POINTS.slice(0,6);for(const[L,F]of A.entries()){const G=new ne(this.layer,F.toString(),"#3cdc00","center",.5,.5,m+28+(x+S)*L,g+65,Z(15));this.fruitPointSTList1.push(G)}const k=skinMainPanelT+630+50+80;this.fruitSSList2.push(new O(this.layer,["//game/fruit_banana.png"],0,0,m,k,x,x)),this.fruitSSList2.push(new O(this.layer,["//game/fruit_donut.png"],0,0,m+(x+S)*1,k,x,x)),this.fruitSSList2.push(new O(this.layer,["//game/fruit_key2.png"],0,0,m+(x+S)*2,k,x,x)),this.fruitSSList2.push(new O(this.layer,["//game/fruit_bell.png"],0,0,m+(x+S)*3,k,x,x)),this.fruitSSList2.push(new O(this.layer,["//game/fruit_key.png"],0,0,m+(x+S)*4,k,x,x)),this.fruitSSList2.push(new O(this.layer,["//game/fruit_fox.png"],0,0,m+(x+S)*5,k,x,x));const P=RF_FRUIT_POINTS.slice(6,12);for(const[L,F]of P.entries()){const G=new ne(this.layer,F.toString(),"#3cdc00","center",.5,.5,m+28+(x+S)*L,k+65,Z(15));this.fruitPointSTList2.push(G)}const E=100,b=tileSize*g_coeffMapToSkin,M=tileSize*1.8*g_coeffMapToSkin,N=tileSize*2*g_coeffMapToSkin,H=940;this.powerPelletForAniSS=new O(this.layer,["//game/dot_power_pelet.png"],.5,.5,E,H,M,M);for(let L=0;L<this.pelletForAniSSCount;L++){const F=E+(L+1)*b,G=new O(this.layer,["//game/dot.png"],.5,.5,F,H,N,N);this.pelletForAniSSList.push(G),this.pelletForAniSSVisiableList.push(!1)}}initCharacterRow(e,t,i,s,n,a,o,l,c,u){this.ghostSSList.push(new O(this.layer,t,0,.5,a,e,50,50));for(let h=0;h<6;h++)this.dotLineDots.push(new O(this.layer,["asset/assets3/info_dotline.png"],0,.5,o+h*10,e,10,3*3));this.ghostCharacterSTList.push(new ne(this.layer,i,n,"left",0,.5,l-10,e+7,Z(20)));for(let h=0;h<u;h++)this.dotLineDots.push(new O(this.layer,["asset/assets3/info_dotline.png"],0,.5,c-(h+1)*10,e,10,3*3));this.ghostNicknameSTList.push(new ne(this.layer,s,n,"left",0,.5,c,e+7,Z(21)))}hidePelletForAniSS(e){this.pelletForAniSSVisiableList[e]=!1,this.pelletForAniSSList[e].hide()}showPelletForAniSSList(){for(let e=0;e<this.pelletForAniSSCount;e++)this.pelletForAniSSVisiableList[e]=!0}draw(){this.frames+=1,this.layer.visible=!0,this.infoScreenSS.draw(),this.infoCloseButtonSS.draw(),this.informationST.draw(),this.characterST.draw(),this.nicknameST.draw();const e=Math.floor(this.frames/10)%2;for(let t of this.ghostSSList)t.setTextureIndex(e),t.draw();for(let t of this.dotLineDots)t.draw();for(let t of this.ghostCharacterSTList)t.draw();for(let t of this.ghostNicknameSTList)t.draw();this.pelletSS.draw(),this.point10ST.draw(),this.point10ptsST.draw(),this.powerPelletSS.draw(),this.point50ST.draw(),this.point50ptsST.draw();for(let t of this.fruitSSList1)t.draw();for(let t of this.fruitSSList2)t.draw();for(let t of this.fruitPointSTList1)t.draw();for(let t of this.fruitPointSTList2)t.draw();this.powerPelletForAniSSVisible&&this.powerPelletForAniSS.draw();for(let t=0;t<this.pelletForAniSSCount;t++)this.pelletForAniSSVisiableList[t]&&this.pelletForAniSSList[t].draw();this.allItemsSt1.draw(),this.allItemsSt2.draw(),this.allItemsSt3.draw()}hidePowerPelletForAniSS(){this.powerPelletForAniSSVisible=!1,this.powerPelletForAniSS.hide()}showPowerPelletForAniSS(){this.powerPelletForAniSSVisible=!0}onCloseButtonClicked(){state.exitToPrevState(RF_FADE_DURATION)}}var aa=null;function es(){return aa===null&&(aa=new tx),aa}function ix(r){switch(r){case 0:return"1ST";case 1:return"2ND";case 2:return"3RD";default:return(r+1).toString()}}class sx extends Vt{constructor(){super(PIXI_RENDERER.getRootLayer(),Ct.STATE),this.frames=0,this.rfStore=te(),this.bgScreenSS=new O(this.layer,["asset/assets3/score_screen.png"],.5,0,skinWidth/2,skinMainPanelT,skinMainPanelW,skinMainPanelH,i=>{this.onReplayClicked()}),this.titleST=new ne(this.layer,"HIGH SCORES","#ff0000","center",.5,0,skinWidth/2,skinMainPanelT+80,Z(36)),this.colXRank=140,this.colXScore=340,this.colXItem=550;const e=skinMainPanelT+80+36+60;this.titleRankST=new ne(this.layer,"RANK","#ffffff","center",.5,.5,this.colXRank,e,Z(21)),this.titleScoreST=new ne(this.layer,"SCORE","#ffffff","center",.5,.5,this.colXScore-20,e,Z(21)),this.titleItemST=new ne(this.layer,"ITEM","#ffffff","center",.5,.5,this.colXItem,e,Z(21)),this.highScorePanels=[];const t=e+40+50;for(let i=0;i<4;i++){const s=t+i*110,n=new de;this.layer.addChild(n),n.visible=!0;const a=new O(n,["asset/assets3/score_listbg.png"],.5,.5,skinWidth/2,s,620,110),o=new O(n,["asset/assets3/score_ghost.png"],0,.5,25,s,80,90),l=new ne(n,"-","#00cdff","center",.5,.5,this.colXRank,s+10,Z(18)),c=new ne(n,"1000000","#ffff00","center",.5,.5,this.colXScore-20,s+10,Z(22)),u=new O(n,["//game/fruit_cherry_gray.png","//game/fruit_cherry.png"],.5,.5,this.colXItem-36*(.5+2),s-36/2-1,36,36),h=new O(n,["//game/fruit_strawberry_gray.png","//game/fruit_strawberry.png"],.5,.5,this.colXItem-36*(.5+1),s-36/2-1,36,36),d=new O(n,["//game/fruit_orange_gray.png","//game/fruit_orange.png"],.5,.5,this.colXItem-36*.5,s-36/2-1,36,36),f=new O(n,["//game/fruit_apple_gray.png","//game/fruit_apple.png"],.5,.5,this.colXItem+36*.5,s-36/2-1,36,36),p=new O(n,["//game/fruit_melon_gray.png","//game/fruit_melon.png"],.5,.5,this.colXItem+36*(.5+1),s-36/2-1,36,36),_=new O(n,["//game/fruit_eggplant_gray.png","//game/fruit_eggplant.png"],.5,.5,this.colXItem+36*(.5+2),s-36/2-1,36,36),g=new O(n,["//game/fruit_banana_gray.png","//game/fruit_banana.png"],.5,.5,this.colXItem-36*(.5+2),s+36/2+1,36,36),m=new O(n,["//game/fruit_donut_gray.png","//game/fruit_donut.png"],.5,.5,this.colXItem-36*(.5+1),s+36/2+1,36,36),x=new O(n,["//game/fruit_key2_gray.png","//game/fruit_key2.png"],.5,.5,this.colXItem-36*.5,s+36/2+1,36,36),S=new O(n,["//game/fruit_bell_gray.png","//game/fruit_bell.png"],.5,.5,this.colXItem+36*.5,s+36/2+1,36,36),w=new O(n,["//game/fruit_key_gray.png","//game/fruit_key.png"],.5,.5,this.colXItem+36*(.5+1),s+36/2+1,36,36),A=new O(n,["//game/fruit_fox_gray.png","//game/fruit_fox.png"],.5,.5,this.colXItem+36*(.5+2),s+36/2+1,36,36);this.highScorePanels.push({recordLayer:n,bgSS:a,ghostSS:o,rankST:l,scoreST:c,cherrySS:u,strawberrySS:h,orangeSS:d,appleSS:f,melonSS:p,eggplantSS:_,bananaSS:g,donutSS:m,galaxianSS:x,bellSS:S,keySS:w,foxSS:A})}this.replayST=new ne(this.layer,"REPLAY","#ffffff","center",.5,.5,skinWidth/2,skinMainPanelT+730,Z(42))}draw(e){this.frames+=1,this.layer.visible=!0,this.bgScreenSS.draw(),this.titleST.draw(),this.titleRankST.draw(),this.titleScoreST.draw(),this.titleItemST.draw();for(let i=0;i<e.length;i++){const[s,n,a,o]=e[i],l=this.highScorePanels[i];o?(l.bgSS.draw(),l.ghostSS.draw()):(l.bgSS.hide(),l.ghostSS.hide()),l.rankST.setText(ix(s)),l.rankST.draw(),l.scoreST.setText(n.toString()),l.scoreST.draw(),l.cherrySS.setTextureIndex(a&lt.CHERRY?1:0),l.strawberrySS.setTextureIndex(a&lt.STRAWBERRY?1:0),l.orangeSS.setTextureIndex(a&lt.ORANGE?1:0),l.appleSS.setTextureIndex(a&lt.APPLE?1:0),l.melonSS.setTextureIndex(a&lt.MELON?1:0),l.eggplantSS.setTextureIndex(a&lt.EGGPLANT?1:0),l.bananaSS.setTextureIndex(a&lt.BANANA?1:0),l.donutSS.setTextureIndex(a&lt.DONUT?1:0),l.galaxianSS.setTextureIndex(a&lt.GALAXIAN?1:0),l.bellSS.setTextureIndex(a&lt.BELL?1:0),l.keySS.setTextureIndex(a&lt.KEY?1:0),l.foxSS.setTextureIndex(a&lt.FOX?1:0),l.cherrySS.draw(),l.strawberrySS.draw(),l.orangeSS.draw(),l.appleSS.draw(),l.melonSS.draw(),l.eggplantSS.draw(),l.bananaSS.draw(),l.donutSS.draw(),l.galaxianSS.draw(),l.bellSS.draw(),l.keySS.draw(),l.foxSS.draw(),l.recordLayer.visible=!0}const t=this.frames%120;t<60?this.replayST.setAlpha(t/60):this.replayST.setAlpha((120-t)/60),this.replayST.draw()}hide(){this.layer.visible=!1}onReplayClicked(){state.exitTo(introState,RF_FADE_DURATION)}setAlpha(e){this.layer.alpha=e}}var oa=null;function rx(){return oa===null&&(oa=new sx,console.log("PixiHighScorePanel ")),oa}class nx extends Vt{constructor(){super(PIXI_RENDERER.getRootLayer(),Ct.SKIN_MENU),this.rfStore=te(),this.skinStore=te().skin;const e=skinWidth-110,t=skinMarginT+65+skinScorePanelH+30+skinMainPanelH+116;this.skinMenuGraphics=new ps,this.skinMenuGraphics.alpha=0,this.skinMenuGraphics.fill({color:1118481}),this.skinMenuGraphics.rect(0,0,skinWidth,skinHeight),this.skinMenuGraphics.visible=!1,this.skinMenuGraphics.interactive=!0,this.skinMenuGraphics.on("pointerdown",()=>{this.onCloseButtonClicked()}),this.layer.addChild(this.skinMenuGraphics),this.skinBgSS=new O(this.layer,["asset/assets3/skin_bg.png"],.5,1,e,t,100,610),this.skinCloseButtonSS=new O(this.layer,["//btn/skin_btn_close.png"],.5,1,e,t-25,40,40,i=>{this.onCloseButtonClicked()}),this.skin00ButtonSS=new O(this.layer,["//btn/skin_btn_00black.png","//btn/skin_btn_00black_select.png"],.5,1,e,t-25-40-15,60,60,i=>{this.onSkin00ButtonClicked()}),this.skin01ButtonSS=new O(this.layer,["//btn/skin_btn_01gray.png","//btn/skin_btn_01gray_select.png"],.5,1,e,t-25-40-15-75*1,60,60,i=>{this.onSkin01ButtonClicked()}),this.skin02ButtonSS=new O(this.layer,["//btn/skin_btn_02lightgray.png","//btn/skin_btn_02lightgray_select.png"],.5,1,e,t-25-40-15-75*2,60,60,i=>{this.onSkin02ButtonClicked()}),this.skin03ButtonSS=new O(this.layer,["//btn/skin_btn_03skyblue.png","//btn/skin_btn_03skyblue_select.png"],.5,1,e,t-25-40-15-75*3,60,60,i=>{this.onSkin03ButtonClicked()}),this.skin04ButtonSS=new O(this.layer,["//btn/skin_btn_04green.png","//btn/skin_btn_04green_select.png"],.5,1,e,t-25-40-15-75*4,60,60,i=>{this.onSkin04ButtonClicked()}),this.skin05ButtonSS=new O(this.layer,["//btn/skin_btn_05yellow.png","//btn/skin_btn_05yellow_select.png"],.5,1,e,t-25-40-15-75*5,60,60,i=>{this.onSkin05ButtonClicked()}),this.skin06ButtonSS=new O(this.layer,["//btn/skin_btn_06red.png","//btn/skin_btn_06red_select.png"],.5,1,e,t-25-40-15-75*6,60,60,i=>{this.onSkin06ButtonClicked()})}draw(){if(!this.skinStore.showSkinMenu){this.hide();return}switch(this.layer.visible=!0,this.skinMenuGraphics.visible=!0,this.skin00ButtonSS.setTextureIndex(0),this.skin01ButtonSS.setTextureIndex(0),this.skin02ButtonSS.setTextureIndex(0),this.skin03ButtonSS.setTextureIndex(0),this.skin04ButtonSS.setTextureIndex(0),this.skin05ButtonSS.setTextureIndex(0),this.skin06ButtonSS.setTextureIndex(0),this.skinStore.selectedSkin){case xe.BLACK:this.skin00ButtonSS.setTextureIndex(1);break;case xe.GRAY:this.skin01ButtonSS.setTextureIndex(1);break;case xe.LIGHT_GRAY:this.skin02ButtonSS.setTextureIndex(1);break;case xe.SKY_BLUE:this.skin03ButtonSS.setTextureIndex(1);break;case xe.GREEN:this.skin04ButtonSS.setTextureIndex(1);break;case xe.YELLOW:this.skin05ButtonSS.setTextureIndex(1);break;case xe.RED:this.skin06ButtonSS.setTextureIndex(1);break;default:console.error(`Unknown skin color: ${this.skinStore.selectedSkin}`);break}this.skinBgSS.draw(),this.skinCloseButtonSS.draw(),this.skin00ButtonSS.draw(),this.skin01ButtonSS.draw(),this.skin02ButtonSS.draw(),this.skin03ButtonSS.draw(),this.skin04ButtonSS.draw(),this.skin05ButtonSS.draw(),this.skin06ButtonSS.draw()}hide(){this.skinStore.hide(),this.layer.visible=!1}onCloseButtonClicked(){this.skinStore.showSkinMenu=!1}onSkin00ButtonClicked(){this.skinStore.setSelectedSkin(xe.BLACK),this.rfStore.saveSkin()}onSkin01ButtonClicked(){this.skinStore.setSelectedSkin(xe.GRAY),this.rfStore.saveSkin()}onSkin02ButtonClicked(){this.skinStore.setSelectedSkin(xe.LIGHT_GRAY),this.rfStore.saveSkin()}onSkin03ButtonClicked(){this.skinStore.setSelectedSkin(xe.SKY_BLUE),this.rfStore.saveSkin()}onSkin04ButtonClicked(){this.skinStore.setSelectedSkin(xe.GREEN),this.rfStore.saveSkin()}onSkin05ButtonClicked(){this.skinStore.setSelectedSkin(xe.YELLOW),this.rfStore.saveSkin()}onSkin06ButtonClicked(){this.skinStore.setSelectedSkin(xe.RED),this.rfStore.saveSkin()}}var ha=null;function Po(){return ha===null&&(ha=new nx),ha}class ax extends nr{constructor(){super(De.HIGH_SCORE),this.rfStore=te(),this.highScoreRecords=[];const e=()=>{for(let c=0;c<2;c++){pacman.update(c),pacman.frames++;for(let u of ghosts)u.update(c),u.frames++}},t=220,i=1.8,s=17,n=mapWidth*1.5,a=40,o={x:0,y:0},l=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}];this.triggers={0:{init:()=>{X().setPlayerScale(1),energizer.reset(),pacman.inManualPositionModel=!0,pacman.getNumSteps=()=>dt(pacman,5,STEP_PACMAN),pacman.setDir(DIR_LEFT),o.x=n,o.y=t,pacman.setPos(o.x,o.y),se.to(o,{duration:260/60,x:-20,y:t,ease:"linear",onUpdate:()=>{pacman.setPos(o.x,o.y)}});for(let c=0;c<ghosts.length;c++){const u=ghosts[c];u.inManualPositionModel=!0,u.setDir(DIR_LEFT),u.faceDirEnum=DIR_LEFT,u.getNumSteps=()=>dt(u,5,STEP_GHOST);const h=n+a+s*(c+2);l[c].x=h,l[c].y=t,u.setPos(l[c].x,l[c].y),u.scared=!1,se.to(l[c],{duration:260/60,x:a+s*(c+2),y:t,ease:"linear",onUpdate:()=>{u.setPos(l[c].x,l[c].y)}})}},update:()=>{e()},draw:()=>{renderer.drawActors()}},260:{init:()=>{X().setPlayerScale(i),pacman.setDir(DIR_RIGHT),se.to(o,{duration:260/60,x:n,ease:"linear",onUpdate:()=>{pacman.setPos(o.x,o.y)}});for(let c=0;c<ghosts.length;c++){const u=n+a/2+s*(c+2),h=ghosts[c];h.inManualPositionModel=!0,h.setDir(DIR_RIGHT),h.faceDirEnum=DIR_RIGHT,h.scared=!0,se.to(l[c],{duration:260/60,x:u,y:t,ease:"linear",onUpdate:()=>{h.setPos(l[c].x,l[c].y)}})}},update:()=>{e()},draw:()=>{renderer.drawActors()}},610:{init:()=>{this.frames=-1},update:()=>{e(),energizer.update()},draw:()=>{renderer.drawActors()}}}}init(){this.pixiSkinPanel=hi(),this.pixiScorePanel=li(),this.pixiIntroPanel=ja(),this.pixiSpeedPanel=dn(),this.pixiInfoPanel=es(),this.pixiHighScorePanel=rx(),this.pixiGamePanel=X(),this.pixiSkinMenuPanel=Po(),this.rfStore.loadHighScores(e=>{var n,a,o,l,c;const t=[];let i=null;for(let u=0;u<e.length;u++){const h=e[u];h[2]===this.rfStore.savedAt&&(i=u),t.push([u,h[0],h[1],i===u])}this.highScoreRecords=t.slice(0,3),i!==null&&i>2&&this.highScoreRecords.push(t[i]),(n=this.pixiGamePanel)==null||n.hideMap(),(a=this.pixiGamePanel)==null||a.hideFruit(),(o=this.pixiGamePanel)==null||o.hideFooter(),(l=this.pixiGamePanel)==null||l.addActorMask(12,skinMainPanelB-100,697,100),globalThis.map=null,pacman.steer=()=>{};for(let u of ghosts)u.scared=!1,u.mode=GHOST_OUTSIDE,u.steer=()=>{};const s=X().actorLayer;s.scale.set(.7),s.position.y+=165*renderScale,(c=this.pixiGamePanel)==null||c.showActor(),super.init()})}hide(){var e;(e=this.pixiHighScorePanel)==null||e.hide()}draw(){var e,t,i;(e=this.pixiSkinPanel)==null||e.draw(),(t=this.pixiHighScorePanel)==null||t.draw(this.highScoreRecords),(i=this.pixiSkinMenuPanel)==null||i.draw(),super.draw()}exitTo(e,t){Si(e,t,()=>{var s,n,a;X().setPlayerScale(1);const i=X().actorLayer;i.scale.set(1),i.position.x=0,i.position.y=0,(s=this.pixiGamePanel)==null||s.removeActorMask(),(n=this.pixiHighScorePanel)==null||n.hide(),(a=this.pixiGamePanel)==null||a.hide(),pacman.inManualPositionModel=!1,pacman.resetGetNumSteps(),pacman.resetSteer();for(let o of ghosts)o.inManualPositionModel=!1,o.resetGetNumSteps(),o.resetSteer();ie().stop(Q.START_MUSIC)})}setAlpha(e){var t;(t=this.pixiHighScorePanel)==null||t.setAlpha(e)}onEnterKeyPressed(){var e;(e=this.pixiHighScorePanel)==null||e.onReplayClicked()}}function ox(){globalThis.highScoreState=new ax}class hx extends nr{constructor(){super(De.INFO),this.excludedGhostNameList=[];const e=()=>{for(let d=0;d<2;d++){pacman.update(d),pacman.frames++;for(let f of ghosts)f.update(d),f.frames++}},t=Z(600),i=17,s=.2,n=.3,a=.1875,o={x:0,y:0},l=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}];this.triggers={0:{init:()=>{es().showPowerPelletForAniSS(),es().showPelletForAniSSList(),this.excludedGhostNameList=[],energizer.reset(),pacman.inManualPositionModel=!0,pacman.getNumSteps=()=>dt(pacman,5,STEP_PACMAN),pacman.setPos(mapWidth,t),o.x=mapWidth,o.y=t,pacman.setDir(DIR_LEFT),se.to(o,{duration:160/60,x:mapWidth*.12,y:t,ease:"linear",onUpdate:()=>{pacman.setPos(o.x,o.y)}});for(let d=0;d<ghosts.length;d++){const f=ghosts[d];f.inManualPositionModel=!0,f.getNumSteps=()=>dt(f,5,STEP_GHOST);const p=mapWidth+i*(d+2);f.setPos(p,t),f.setDir(DIR_LEFT),f.faceDirEnum=DIR_LEFT,f.scared=!1,l[d].x=p,l[d].y=t,se.to(l[d],{duration:160/60,x:i+i*(d+2),y:t,ease:"linear",onUpdate:()=>{f.setPos(l[d].x,l[d].y)}})}},update:()=>{e()},draw:()=>{renderer.drawActors()}},160:{init:()=>{es().hidePowerPelletForAniSS(),energizer.activate();const d=mapWidth*n;pacman.setDir(DIR_RIGHT),pacman.getNumSteps=()=>dt(pacman,5,STEP_PACMAN_FRIGHT),se.to(o,{duration:40/60,x:d-i*s,ease:"linear",onUpdate:()=>{pacman.setPos(o.x,o.y)}});for(let f=0;f<ghosts.length;f+=1){const p=ghosts[f];if(this.excludedGhostNameList.includes(p.name))continue;p.getNumSteps=()=>dt(p,5,STEP_GHOST_FRIGHT),p.setDir(DIR_RIGHT),p.faceDirEnum=DIR_RIGHT,p.scared=!0;const _=this.excludedGhostNameList.length;se.to(l[f],{duration:40/60,x:d+(f-_)*i,y:t,ease:"linear",onUpdate:()=>{p.setPos(l[f].x,l[f].y)}})}ie().play(Q.EATING_COOKIE,!1)},update:()=>{e()},draw:()=>{renderer.drawActors()}},200:{init:()=>{energizer.addPoints(!0),X().hideGhostByName(ghosts[0].name),this.excludedGhostNameList=[ghosts[0].name],ie().play(Q.EATING_GHOST,!1)},update:()=>{energizer.updatePointsTimer()},draw:()=>{renderer.drawActors(this.excludedGhostNameList)}},260:{init:()=>{const d=mapWidth*(n+a);se.to(o,{duration:40/60,x:d-i*s,ease:"linear",onUpdate:()=>{pacman.setPos(o.x,o.y)}});for(let f=0;f<ghosts.length;f+=1){const p=ghosts[f];if(this.excludedGhostNameList.includes(p.name))continue;const _=this.excludedGhostNameList.length;se.to(l[f],{duration:40/60,x:d+(f-_)*i,y:t,ease:"linear",onUpdate:()=>{p.setPos(l[f].x,l[f].y)}})}},update:()=>{e(),energizer.update()},draw:()=>{renderer.drawActors([ghosts[0].name])}},300:{init:()=>{energizer.addPoints(!0),this.excludedGhostNameList=[ghosts[0].name,ghosts[1].name],X().hideGhostByName(ghosts[0].name),X().hideGhostByName(ghosts[1].name),ie().play(Q.EATING_GHOST,!1)},update:()=>{energizer.updatePointsTimer()},draw:()=>{renderer.drawActors(this.excludedGhostNameList)}},360:{init:()=>{const d=mapWidth*(n+a*2);se.to(o,{duration:40/60,x:d-i*s,ease:"linear",onUpdate:()=>{pacman.setPos(o.x,o.y)}});for(let f=0;f<ghosts.length;f+=1){const p=ghosts[f];if(this.excludedGhostNameList.includes(p.name))continue;const _=this.excludedGhostNameList.length;se.to(l[f],{duration:40/60,x:d+(f-_)*i,y:t,ease:"linear",onUpdate:()=>{p.setPos(l[f].x,l[f].y)}})}},update:()=>{e(),energizer.update()},draw:()=>{renderer.drawActors(this.excludedGhostNameList)}},400:{init:()=>{energizer.addPoints(!0),this.excludedGhostNameList=[ghosts[0].name,ghosts[1].name,ghosts[2].name],X().hideGhostByName(ghosts[0].name),X().hideGhostByName(ghosts[1].name),X().hideGhostByName(ghosts[2].name),ie().play(Q.EATING_GHOST,!1)},update:()=>{energizer.updatePointsTimer()},draw:()=>{renderer.drawActors(this.excludedGhostNameList)}},460:{init:()=>{const d=mapWidth*(n+a*3);se.to(o,{duration:40/60,x:d-i*s,ease:"linear",onUpdate:()=>{pacman.setPos(o.x,o.y)}});for(let f=0;f<ghosts.length;f+=1){const p=ghosts[f];if(this.excludedGhostNameList.includes(p.name))continue;const _=this.excludedGhostNameList.length;se.to(l[f],{duration:40/60,x:d+(f-_)*i,y:t,ease:"linear",onUpdate:()=>{p.setPos(l[f].x,l[f].y)}})}},update:()=>{e(),energizer.update()},draw:()=>{renderer.drawActors(this.excludedGhostNameList)}},500:{init:()=>{energizer.addPoints(!0),this.excludedGhostNameList=[ghosts[0].name,ghosts[1].name,ghosts[2].name,ghosts[3].name],X().hideGhostByName(ghosts[0].name),X().hideGhostByName(ghosts[1].name),X().hideGhostByName(ghosts[2].name),X().hideGhostByName(ghosts[3].name),ie().play(Q.EATING_GHOST,!1)},update:()=>{energizer.updatePointsTimer()},draw:()=>{renderer.drawActors(this.excludedGhostNameList)}},560:{init:()=>{const d=mapWidth;se.to(o,{duration:40/60,x:d-i*s,ease:"linear",onUpdate:()=>{pacman.setPos(o.x,o.y)}});for(let f=0;f<ghosts.length;f+=1){const p=ghosts[f];this.excludedGhostNameList.includes(p.name)||se.to(l[f],{duration:40/60,x:d+(f+1)*i,y:t,ease:"linear",onUpdate:()=>{p.setPos(l[f].x,l[f].y)}})}},update:()=>{e(),energizer.update()},draw:()=>{renderer.drawActors(this.excludedGhostNameList)}},600:{init:()=>{this.frames=-1},update:()=>{e(),energizer.update()},draw:()=>{renderer.drawActors(this.excludedGhostNameList)}}};const c=16,u=55,h=Math.floor((160-u)/c);for(let d=0;d<c;d++)this.triggers[u+h*d]={init:()=>{es().hidePelletForAniSS(c-1-d),ie().play(Q.EATING_COOKIE,!1)},update:()=>{e()},draw:()=>{renderer.drawActors()}}}init(){var e,t,i,s,n;this.pixiSkinPanel=hi(),this.pixiScorePanel=li(),this.pixiInfoPanel=es(),this.pixiSpeedPanel=dn(),this.pixiGamePanel=X(),this.pixiSkinMenuPanel=Po(),(e=this.pixiGamePanel)==null||e.hideMap(),(t=this.pixiGamePanel)==null||t.hideFruit(),(i=this.pixiGamePanel)==null||i.hideFooter(),(s=this.pixiGamePanel)==null||s.addActorMask(0,skinMainPanelT+600-100,700,200),globalThis.map=null,pacman.steer=()=>{};for(let a of ghosts)a.scared=!1,a.mode=GHOST_OUTSIDE,a.steer=()=>{};(n=this.pixiGamePanel)==null||n.showActor(),super.init()}draw(){var e,t,i,s,n;(e=this.pixiSkinPanel)==null||e.draw(),(t=this.pixiScorePanel)==null||t.draw(),(i=this.pixiInfoPanel)==null||i.draw(),(s=this.pixiSpeedPanel)==null||s.draw(),(n=this.pixiSkinMenuPanel)==null||n.draw(),super.draw()}exitToPrevState(e){Si(G_prevState,e,()=>{var t,i,s,n;(t=this.pixiGamePanel)==null||t.removeActorMask(),globalThis.map=mapPacman,(i=this.pixiGamePanel)==null||i.hideActor(),pacman.inManualPositionModel=!1,pacman.resetGetNumSteps(),pacman.resetSteer();for(let a of ghosts)a.inManualPositionModel=!1,a.resetGetNumSteps(),a.resetSteer();(s=this.pixiGamePanel)==null||s.hide(),(n=this.pixiInfoPanel)==null||n.hide()})}setAlpha(e){var t;(t=this.pixiInfoPanel)==null||t.setAlpha(e)}}function lx(){globalThis.infoState=new hx}class cx extends nr{constructor(){super(De.INTRO),this.excludedGhostNameList=[];const e=()=>{for(let c=0;c<2;c++){pacman.update(c),pacman.frames++;for(let u of ghosts)u.update(c),u.frames++}},t=220,i=17,s=.2,n=.3,a=.1875,o={x:0,y:0},l=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}];this.triggers={0:{init:()=>{this.excludedGhostNameList=[],energizer.reset(),pacman.inManualPositionModel=!0,pacman.getNumSteps=()=>dt(pacman,5,STEP_PACMAN),pacman.setPos(mapWidth,t),o.x=mapWidth,o.y=t,pacman.setDir(DIR_LEFT),se.to(o,{duration:160/60,x:i,y:t,ease:"linear",onUpdate:()=>{pacman.setPos(o.x,o.y)}});for(let c=0;c<ghosts.length;c++){const u=ghosts[c];u.inManualPositionModel=!0,u.getNumSteps=()=>dt(u,5,STEP_GHOST);const h=mapWidth+i*(c+2);u.setPos(h,t),u.setDir(DIR_LEFT),u.faceDirEnum=DIR_LEFT,u.scared=!1,l[c].x=h,l[c].y=t,se.to(l[c],{duration:160/60,x:i+i*(c+2),y:t,ease:"linear",onUpdate:()=>{u.setPos(l[c].x,l[c].y)}})}},update:()=>{e()},draw:()=>{renderer.drawActors()}},160:{init:()=>{ja().hidePowerPelletForAniSS(),energizer.activate();const c=mapWidth*n;pacman.setDir(DIR_RIGHT),pacman.getNumSteps=function(){return dt(pacman,5,STEP_GHOST)},se.to(o,{duration:40/60,x:c-i*s,ease:"linear",onUpdate:()=>{pacman.setPos(o.x,o.y)}});for(let u=0;u<ghosts.length;u+=1){const h=ghosts[u];if(this.excludedGhostNameList.includes(h.name))continue;h.getNumSteps=function(){return dt(h,5,STEP_GHOST_FRIGHT)},h.setDir(DIR_RIGHT),h.faceDirEnum=DIR_RIGHT,h.scared=!0;const d=this.excludedGhostNameList.length;se.to(l[u],{duration:40/60,x:c+(u-d)*i,y:t,ease:"linear",onUpdate:()=>{h.setPos(l[u].x,l[u].y)}})}},update:()=>{e()},draw:()=>{renderer.drawActors()}},200:{init:()=>{energizer.addPoints(!0),X().hideGhostByName(ghosts[0].name),this.excludedGhostNameList=[ghosts[0].name]},update:()=>{energizer.updatePointsTimer()},draw:()=>{renderer.drawActors(this.excludedGhostNameList)}},260:{init:()=>{const c=mapWidth*(n+a);se.to(o,{duration:40/60,x:c-i*s,ease:"linear",onUpdate:()=>{pacman.setPos(o.x,o.y)}});for(let u=0;u<ghosts.length;u+=1){const h=ghosts[u];if(this.excludedGhostNameList.includes(h.name))continue;const d=this.excludedGhostNameList.length;se.to(l[u],{duration:40/60,x:c+(u-d)*i,y:t,ease:"linear",onUpdate:()=>{h.setPos(l[u].x,l[u].y)}})}},update:()=>{e(),energizer.update()},draw:()=>{renderer.drawActors([ghosts[0].name])}},300:{init:()=>{energizer.addPoints(!0),this.excludedGhostNameList=[ghosts[0].name,ghosts[1].name],X().hideGhostByName(ghosts[0].name),X().hideGhostByName(ghosts[1].name)},update:()=>{energizer.updatePointsTimer()},draw:()=>{renderer.drawActors(this.excludedGhostNameList)}},360:{init:()=>{const c=mapWidth*(n+a*2);se.to(o,{duration:40/60,x:c-i*s,ease:"linear",onUpdate:()=>{pacman.setPos(o.x,o.y)}});for(let u=0;u<ghosts.length;u+=1){const h=ghosts[u];if(this.excludedGhostNameList.includes(h.name))continue;const d=this.excludedGhostNameList.length;se.to(l[u],{duration:40/60,x:c+(u-d)*i,y:t,ease:"linear",onUpdate:()=>{h.setPos(l[u].x,l[u].y)}})}},update:()=>{e(),energizer.update()},draw:()=>{renderer.drawActors(this.excludedGhostNameList)}},400:{init:()=>{energizer.addPoints(!0),this.excludedGhostNameList=[ghosts[0].name,ghosts[1].name,ghosts[2].name],X().hideGhostByName(ghosts[0].name),X().hideGhostByName(ghosts[1].name),X().hideGhostByName(ghosts[2].name)},update:()=>{energizer.updatePointsTimer()},draw:()=>{renderer.drawActors(this.excludedGhostNameList)}},460:{init:()=>{const c=mapWidth*(n+a*3);se.to(o,{duration:40/60,x:c-i*s,ease:"linear",onUpdate:()=>{pacman.setPos(o.x,o.y)}});for(let u=0;u<ghosts.length;u+=1){const h=ghosts[u];if(this.excludedGhostNameList.includes(h.name))continue;const d=this.excludedGhostNameList.length;se.to(l[u],{duration:40/60,x:c+(u-d)*i,y:t,ease:"linear",onUpdate:()=>{h.setPos(l[u].x,l[u].y)}})}},update:()=>{e(),energizer.update()},draw:()=>{renderer.drawActors(this.excludedGhostNameList)}},500:{init:()=>{energizer.addPoints(!0),this.excludedGhostNameList=[ghosts[0].name,ghosts[1].name,ghosts[2].name,ghosts[3].name],X().hideGhostByName(ghosts[0].name),X().hideGhostByName(ghosts[1].name),X().hideGhostByName(ghosts[2].name),X().hideGhostByName(ghosts[3].name)},update:()=>{energizer.updatePointsTimer()},draw:()=>{renderer.drawActors(this.excludedGhostNameList)}},560:{init:()=>{const c=mapWidth;se.to(o,{duration:40/60,x:c-i*s,ease:"linear",onUpdate:()=>{pacman.setPos(o.x,o.y)}});for(let u=0;u<ghosts.length;u+=1){const h=ghosts[u];this.excludedGhostNameList.includes(h.name)||se.to(l[u],{duration:40/60,x:c+(u+1)*i,y:t,ease:"linear",onUpdate:()=>{h.setPos(l[u].x,l[u].y)}})}},update:()=>{e(),energizer.update()},draw:()=>{renderer.drawActors(this.excludedGhostNameList)}},600:{init:()=>{this.frames=-1},update:()=>{e(),energizer.update()},draw:()=>{renderer.drawActors(this.excludedGhostNameList)}}}}init(){var i,s,n,a,o;this.pixiSkinPanel=hi(),this.pixiScorePanel=li(),this.pixiIntroPanel=ja(),this.pixiSpeedPanel=dn(),this.pixiGamePanel=X(),this.pixiSkinMenuPanel=Po(),te().game.score.init(),this.pixiScorePanel.setTitle("STAGE"),ie().play(Q.COFFEE_BREAK_MUSIC,!0),(i=this.pixiGamePanel)==null||i.hideMap(),(s=this.pixiGamePanel)==null||s.hideFruit(),(n=this.pixiGamePanel)==null||n.hideFooter();const e=290;(a=this.pixiGamePanel)==null||a.addActorMask(e,skinMainPanelT+400,700-e,200),globalThis.map=null,pacman.steer=()=>{};for(let l of ghosts)l.scared=!1,l.mode=GHOST_OUTSIDE,l.steer=()=>{};const t=X().actorLayer;t.scale.set(.7),t.position.x+=70*renderScale,t.position.y+=60*renderScale,(o=this.pixiGamePanel)==null||o.showActor(),super.init()}draw(){var e,t,i,s,n;(e=this.pixiSkinPanel)==null||e.draw(),(t=this.pixiScorePanel)==null||t.draw(),(i=this.pixiIntroPanel)==null||i.draw(),(s=this.pixiSpeedPanel)==null||s.draw(),(n=this.pixiSkinMenuPanel)==null||n.draw(),super.draw()}exitTo(e){Si(e,RF_FADE_DURATION,()=>{var i,s,n,a;se.globalTimeline.clear();const t=X().actorLayer;t.scale.set(1),t.position.x=0,t.position.y=0,(i=this.pixiGamePanel)==null||i.removeActorMask(),(s=this.pixiSkinMenuPanel)==null||s.hide(),(n=this.pixiIntroPanel)==null||n.hide(),(a=this.pixiGamePanel)==null||a.hide(),pacman.inManualPositionModel=!1,pacman.resetGetNumSteps(),pacman.resetSteer();for(let o of ghosts)o.inManualPositionModel=!1,o.resetGetNumSteps(),o.resetSteer();ie().stop(Q.COFFEE_BREAK_MUSIC)})}setAlpha(e){var t;(t=this.pixiIntroPanel)==null||t.setAlpha(e)}onEnterKeyPressed(){var e;(e=this.pixiIntroPanel)==null||e.onGameStartPressed()}}function ux(){globalThis.introState=new cx}class dx{constructor(e,t,i,s,n){this.x=e,this.y=t,this.w=i,this.h=s,this.name=n}scaleAndShow(e){e.position.x=this.x*renderScale,e.position.y=this.y*renderScale,e.width=this.w*renderScale,e.height=this.h*renderScale,e.visible=!0}}class Nu{constructor(e,t,i,s,n,a,o,l,c,u,h){this.layer=e,h?this.sprites=h.map(p=>new j(p)):this.sprites=t.map(p=>new j(ai().getTexture(p)));for(let p of this.sprites)p.anchor.set(i,s),p.alpha=1;this.sprite=this.sprites[0];let d,f;u!=null&&u.useRawPosition?(d=n,f=a):(d=Z(n),f=Z(a)),this.scaler=new dx(d,f,Z(o),Z(l)),c&&(this.sprite.interactive=!0,this.sprite.on("pointerdown",c));for(let p of this.sprites)p.visible=!1,this.layer.addChild(p)}draw(){this.scaler.scaleAndShow(this.sprite)}hide(){this.sprite.visible=!1}setTextureIndex(e){this.sprite.visible=!1,this.sprite=this.sprites[e],this.scaler.scaleAndShow(this.sprite)}setAlpha(e){this.sprite.alpha=e}discard(){this.layer.removeChild(this.sprite)}}class fx extends Vt{constructor(){super(PIXI_RENDERER.getRootLayer(),Ct.SKIN),this.frames=0,this.progress=0,this.isOnYourMark=!1,this.bgSS=new O(this.layer,[],0,0,0,0,720,1600,i=>{this.onEnter(i)},void 0,[q.from("loading_bg.png")]),this.bgSS.setInteractive(!1);let e=330+skinMarginT;const t=[q.from("asset/loading/loading_pac.gif"),q.from("asset/loading/loading_pac02.gif")];this.loadingPacManSS=new Nu(this.layer,[],0,0,240,e,240,250,void 0,void 0,t),e+=310,this.loadingST=new ne(this.layer,"LOADING...","#ff0","center",.5,.5,skinWidth/2,e,tileSize-.5),e=skinMarginT+620+50+50,this.progressBarY=e,this.progressBarXStart=skinWidth/2+220,this.progressBarXSpan=23.5,this.loadingMazeSS=new O(this.layer,[],.5,.5,skinWidth/2,e,550,110,void 0,void 0,[q.from("loading_maze.png")]),this.dotListSS=[];for(let i=0;i<20;i++){const s=this.progressBarXStart-i*this.progressBarXSpan;this.dotListSS.push(new O(this.layer,[],.5,.5,s,e,80*.8*.7,80*.8*.7,void 0,void 0,[q.from("dot.png")]))}this.pacmanSS=new O(this.layer,[],.5,.5,skinWidth/2+220,e,50,50,void 0,void 0,[q.from("pacman_01.png"),q.from("pacman_02.png"),q.from("pacman_03.png")]),this.loadingLogoSS=new O(this.layer,[],.5,.5,skinWidth/2,skinMarginT+880,340,160,void 0,void 0,[q.from("loading_logo.png")])}draw(){if(this.frames+=1,this.layer.visible=!0,this.bgSS.draw(),this.loadingPacManSS.draw(),this.isOnYourMark){this.loadingMazeSS.hide(),this.pacmanSS.hide();for(let t of this.dotListSS)t.hide()}else{this.loadingMazeSS.draw();const t=this.dotListSS.length,i=Math.floor(this.progress*t);for(let s=0;s<i;s++)this.dotListSS[s].hide();for(let s=i;s<t;s++)this.dotListSS[s].draw();this.pacmanSS.setTextureIndex(Math.floor(this.frames/3)%3),this.pacmanSS.drawSiknCoord(this.progressBarXStart-(this.progressBarXSpan*20-20)*this.progress,this.progressBarY)}const e=this.frames%120;e<60?this.loadingST.setAlpha(e/60):this.loadingST.setAlpha((120-e)/60),this.loadingST.draw(),this.loadingLogoSS.draw()}hide(){this.layer.visible=!1}onYourMark(){this.loadingPacManSS.setTextureIndex(1),this.isOnYourMark=!0,this.loadingST.setText("TAP TO ENTER"),this.bgSS.setInteractive(!0),ytgame==null||ytgame.game.gameReady()}onEnter(e){ie(),state.exitTo(introState)}onUpdateLoadingProgress(e){this.progress=e}onEnterKeyPressed(){this.isOnYourMark&&this.onEnter()}}class px extends Xt{constructor(){super(De.LOADING)}init(){Cg(()=>{this.onLoadingImageLoaded()}),Mg(()=>{this.onAssetLoaded()})}draw(){var e;(e=this.pixiLoadingPanel)==null||e.draw()}update(){}onLoadingImageLoaded(){this.pixiLoadingPanel=new fx}onAssetLoaded(){var e;(e=this.pixiLoadingPanel)==null||e.onYourMark()}exitTo(e){Si(e,RF_FADE_DURATION,()=>{var t;(t=this.pixiLoadingPanel)==null||t.hide()})}onUpdateImageLoadingProgress(e){var t;(t=this.pixiLoadingPanel)==null||t.onUpdateLoadingProgress(.5*e)}onUpdateAudioLoadingProgress(e){var t;(t=this.pixiLoadingPanel)==null||t.onUpdateLoadingProgress(.5+.5*e)}onEnterKeyPressed(){var e;(e=this.pixiLoadingPanel)==null||e.onEnterKeyPressed()}}function _x(){globalThis.loadingState=new px}class gx extends Xt{constructor(){super(De.NEW_GAME),this.frames=0,this.duration=2,this.startLevel=1,this.gameStore=null,this.pixiSkinPanel=null,this.pixiScorePanel=null,this.pixiGamePanel=null}init(){var e,t,i,s;this.gameStore=te().game,this.pixiSkinPanel=hi(),this.pixiScorePanel=li(),this.pixiGamePanel=X(),(e=this.pixiGamePanel)==null||e.show(),(t=this.pixiGamePanel)==null||t.hideFruit(),(i=this.pixiGamePanel)==null||i.hideActor(),this.frames=0,level=this.startLevel-1,extraLives=RF_EXTRA_LIVES,Oc(0),this.gameStore.fruit.resetCounter(),(s=this.pixiGamePanel)==null||s.drawMap(),readyNewState.init()}setStartLevel(e){this.startLevel=e}draw(){var e,t,i,s,n;(e=this.pixiSkinPanel)==null||e.draw(),(t=this.pixiScorePanel)==null||t.draw(),(i=this.pixiGamePanel)==null||i.drawMap(),(s=this.pixiGamePanel)==null||s.drawReadyMessage(!0),(n=this.pixiGamePanel)==null||n.drawFooter()}update(){this.frames++,this.frames===this.duration*60&&(extraLives--,state=readyNewState)}setAlpha(e){var t;(t=this.pixiGamePanel)==null||t.setAlpha(e)}}function mx(){globalThis.newGameState=new gx}class xx extends Xt{constructor(){super(De.OVER),this.frames=0}init(){var e;this.frames=0,this.pixiSkinPanel=hi(),this.pixiScorePanel=li(),this.pixiGamePanel=X(),(e=this.pixiGamePanel)==null||e.hideActor(),te().saveScore()}exitTo(e,t){Si(e,t,()=>{var i;(i=this.pixiGamePanel)==null||i.hideMessage(),te().game.speedTimer.turnOff()})}draw(){var e;(e=this.pixiGamePanel)==null||e.drawGameOverMessage(!1),super.draw()}update(){var e;this.frames+=1,(e=this.pixiGamePanel)==null||e.update(),this.frames===60&&this.exitTo(highScoreState,60)}}function yx(){globalThis.overState=new xx}class Sx extends Xt{constructor(){super(De.PLAY),this.frames=0,this.gameStore=te().game,this.pixiSkinPanel=null,this.pixiScorePanel=null,this.pixiGamePanel=null,this.pixiSpeedPanel=null}init(){var e,t;this.pixiSkinPanel=hi(),this.pixiScorePanel=li(),this.pixiGamePanel=X(),this.pixiSpeedPanel=dn(),(e=this.pixiGamePanel)==null||e.addActorMask(skinMainPanelL,skinMainPanelT,skinMainPanelW,skinMainPanelH),this.gameStore.speedTimer.start(),(t=this.pixiGamePanel)==null||t.hideMessage()}draw(){var t,i,s,n,a,o;(t=this.pixiSkinPanel)==null||t.draw(),(i=this.pixiScorePanel)==null||i.draw(),renderer.setLevelFlash(!1),renderer.blitMap(),renderer.drawScore(),renderer.drawFruit(),renderer.drawActors();const e=te().game;(s=this.pixiGamePanel)==null||s.drawFruit(e),(n=this.pixiGamePanel)==null||n.showActor(),(a=this.pixiGamePanel)==null||a.drawFooter(),(o=this.pixiSpeedPanel)==null||o.draw()}exitTo(e,t){Si(e,t,()=>{var i,s;(i=this.pixiGamePanel)==null||i.removeActorMask(),(s=this.pixiGamePanel)==null||s.hidePelletCounter(),this.gameStore.speedTimer.stopPlayGhostSound()})}isPacmanCollide(){for(let e=0;e<4;e++){const t=ghosts[e];if(t.tile.x===pacman.tile.x&&t.tile.y===pacman.tile.y&&t.mode===GHOST_OUTSIDE)return t.scared?(ie().play(Q.EATING_GHOST,!1),energizer.addPoints(),t.onEaten()):pacman.invincible||this.exitTo(deadState),!0}return!1}update(){var i;this.frames++,this.gameStore.speedTimer.update();let e=!1;const t=2;if(energizer.showingPoints()){for(let s=0;s<t;s++)for(let n=0;n<4;n++)(ghosts[n].mode===GHOST_GOING_HOME||ghosts[n].mode===GHOST_ENTERING_HOME)&&ghosts[n].update(s);energizer.updatePointsTimer(),e=!0}else for(let s=0;s<4;s++)ghosts[s].mode===GHOST_EATEN&&(ghosts[s].mode=GHOST_GOING_HOME,ghosts[s].targetting="door");if(!e){ghostReleaser.update(),ghostCommander.update(),elroyTimer.update(),fruit.update(),energizer.update();for(let s=0;s<t;s++){if(pacman.update(s),fruit.testCollide(),map.allDotsEaten()){this.exitTo(finishState);break}if(this.isPacmanCollide())break;for(let n=0;n<4;n++)actors[n].update(s);if(this.isPacmanCollide())break}for(let s=0;s<5;s++)actors[s].frames++}(i=this.pixiGamePanel)==null||i.update()}setAlpha(e){var t;(t=this.pixiGamePanel)==null||t.setAlpha(e)}addGhostSoundPoint(e){this.gameStore.speedTimer.addGhostSoundPoint(e)}}function Tx(){globalThis.playState=new Sx}class ko extends Xt{constructor(e){super(e),this.frames=0,this.duration=2,this.pixiSkinPanel=null,this.pixiScorePanel=null,this.pixiGamePanel=null}init(){this.pixiSkinPanel=hi(),this.pixiScorePanel=li(),this.pixiGamePanel=X(),te().game.speedTimer.init(),this.frames=0;for(let e=0;e<5;e++)actors[e].reset();ghostCommander.reset(),fruit.reset(),energizer.reset(),map.resetTimeEaten()}update(){var e;this.frames++,this.frames===this.duration*60&&switchState(playState),(e=this.pixiGamePanel)==null||e.update()}draw(){var e,t,i,s,n;renderer.drawActors(),(e=this.pixiSkinPanel)==null||e.draw(),(t=this.pixiScorePanel)==null||t.draw(),(i=this.pixiGamePanel)==null||i.drawMap(),(s=this.pixiGamePanel)==null||s.showActor(),(n=this.pixiGamePanel)==null||n.drawFooter()}setAlpha(e){var t;(t=this.pixiGamePanel)==null||t.setAlpha(e)}}function wx(){globalThis.readyState=new ko(De.READY)}class vx extends ko{constructor(){super(De.READY_NEW)}init(){var e;this.pixiSkinPanel=hi(),this.pixiScorePanel=li(),this.pixiGamePanel=X(),(e=this.pixiGamePanel)==null||e.hideActor(),level+=1,globalThis.map=mapPacman,map.resetCurrent(),fruit.onNewLevel(),X().drawMap(),ghostReleaser.onNewLevel(),elroyTimer.onNewLevel(),level===1&&ie().play(Q.START_MUSIC,!1),super.init()}draw(){var e;(e=this.pixiGamePanel)==null||e.drawReadyMessage(!0),super.draw()}}function bx(){globalThis.readyNewState=new vx}class Ax extends ko{constructor(){super(De.READY_RESTART)}init(){extraLives--,ghostReleaser.onRestartLevel(),elroyTimer.onRestartLevel(),X().drawMap(),super.init()}draw(){var e;(e=this.pixiGamePanel)==null||e.drawReadyMessage(!1),super.draw()}}function Px(){globalThis.readyRestartState=new Ax}var Bu={exports:{}};(function(r){(function(){function e(_,g){document.addEventListener?_.addEventListener("scroll",g,!1):_.attachEvent("scroll",g)}function t(_){document.body?_():document.addEventListener?document.addEventListener("DOMContentLoaded",function g(){document.removeEventListener("DOMContentLoaded",g),_()}):document.attachEvent("onreadystatechange",function g(){(document.readyState=="interactive"||document.readyState=="complete")&&(document.detachEvent("onreadystatechange",g),_())})}function i(_){this.g=document.createElement("div"),this.g.setAttribute("aria-hidden","true"),this.g.appendChild(document.createTextNode(_)),this.h=document.createElement("span"),this.i=document.createElement("span"),this.m=document.createElement("span"),this.j=document.createElement("span"),this.l=-1,this.h.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.i.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.j.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.m.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.h.appendChild(this.m),this.i.appendChild(this.j),this.g.appendChild(this.h),this.g.appendChild(this.i)}function s(_,g){_.g.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+g+";"}function n(_){var g=_.g.offsetWidth,m=g+100;return _.j.style.width=m+"px",_.i.scrollLeft=m,_.h.scrollLeft=_.h.scrollWidth+100,_.l!==g?(_.l=g,!0):!1}function a(_,g){function m(){var S=x;n(S)&&S.g.parentNode!==null&&g(S.l)}var x=_;e(_.h,m),e(_.i,m),n(_)}function o(_,g,m){g=g||{},m=m||window,this.family=_,this.style=g.style||"normal",this.weight=g.weight||"normal",this.stretch=g.stretch||"normal",this.context=m}var l=null,c=null,u=null,h=null;function d(_){return c===null&&(f(_)&&/Apple/.test(window.navigator.vendor)?(_=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent),c=!!_&&603>parseInt(_[1],10)):c=!1),c}function f(_){return h===null&&(h=!!_.document.fonts),h}function p(_,g){var m=_.style,x=_.weight;if(u===null){var S=document.createElement("div");try{S.style.font="condensed 100px sans-serif"}catch{}u=S.style.font!==""}return[m,x,u?_.stretch:"","100px",g].join(" ")}o.prototype.load=function(_,g){var m=this,x=_||"BESbswy",S=0,w=g||3e3,A=new Date().getTime();return new Promise(function(k,P){if(f(m.context)&&!d(m.context)){var E=new Promise(function(M,N){function H(){new Date().getTime()-A>=w?N(Error(""+w+"ms timeout exceeded")):m.context.document.fonts.load(p(m,'"'+m.family+'"'),x).then(function(L){1<=L.length?M():setTimeout(H,25)},N)}H()}),b=new Promise(function(M,N){S=setTimeout(function(){N(Error(""+w+"ms timeout exceeded"))},w)});Promise.race([b,E]).then(function(){clearTimeout(S),k(m)},P)}else t(function(){function M(){var D;(D=G!=-1&&$!=-1||G!=-1&&K!=-1||$!=-1&&K!=-1)&&((D=G!=$&&G!=K&&$!=K)||(l===null&&(D=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),l=!!D&&(536>parseInt(D[1],10)||parseInt(D[1],10)===536&&11>=parseInt(D[2],10))),D=l&&(G==Se&&$==Se&&K==Se||G==U&&$==U&&K==U||G==Y&&$==Y&&K==Y)),D=!D),D&&(Te.parentNode!==null&&Te.parentNode.removeChild(Te),clearTimeout(S),k(m))}function N(){if(new Date().getTime()-A>=w)Te.parentNode!==null&&Te.parentNode.removeChild(Te),P(Error(""+w+"ms timeout exceeded"));else{var D=m.context.document.hidden;(D===!0||D===void 0)&&(G=H.g.offsetWidth,$=L.g.offsetWidth,K=F.g.offsetWidth,M()),S=setTimeout(N,50)}}var H=new i(x),L=new i(x),F=new i(x),G=-1,$=-1,K=-1,Se=-1,U=-1,Y=-1,Te=document.createElement("div");Te.dir="ltr",s(H,p(m,"sans-serif")),s(L,p(m,"serif")),s(F,p(m,"monospace")),Te.appendChild(H.g),Te.appendChild(L.g),Te.appendChild(F.g),m.context.document.body.appendChild(Te),Se=H.g.offsetWidth,U=L.g.offsetWidth,Y=F.g.offsetWidth,N(),a(H,function(D){G=D,M()}),s(H,p(m,'"'+m.family+'",sans-serif')),a(L,function(D){$=D,M()}),s(L,p(m,'"'+m.family+'",serif')),a(F,function(D){K=D,M()}),s(F,p(m,'"'+m.family+'",monospace'))})})},r.exports=o})()})(Bu);var kx=Bu.exports;const Ex=rr(kx);class Cx extends Vt{constructor(){super(PIXI_RENDERER.getRootLayer(),Ct.CONGRA),this.frames=0,this.rfStore=te(),this.bgSS=new O(this.layer,["asset/assets3/game_Congratulations_bg.png"],.5,0,skinWidth/2,skinMainPanelT,skinMainPanelW,skinMainPanelH,e=>{console.log("XXX")}),this.congraPacManSS=new Nu(this.layer,[],.5,0,skinWidth/2,skinMainPanelT+40,700,760,void 0,void 0,[q.from("asset/assets3/game_Congratulations_ani.gif")])}draw(){this.bgSS.draw(),this.congraPacManSS.draw(),this.layer.visible=!0}hide(){console.log("  "),this.layer.visible=!1}setAlpha(e){this.layer.alpha=e}}var la=null;function Mx(){return la===null&&(la=new Cx),la}class Ix extends Xt{constructor(){super(De.CONGRA_SCORE),this.frames=0}init(){this.frames=0,this.pixiCongraPanel=Mx(),globalThis.map=null,super.init()}draw(){var e;(e=this.pixiCongraPanel)==null||e.draw(),super.draw()}hide(){var e;(e=this.pixiCongraPanel)==null||e.hide()}exitTo(e,t){Si(e,t,()=>{})}setAlpha(e){var t;(t=this.pixiCongraPanel)==null||t.setAlpha(e)}update(){this.frames+=1,this.frames===60&&this.exitTo(highScoreState,60)}}function Rx(){globalThis.congraState=new Ix}function il(){const n=document.getElementById("pixiDiv"),a=window.innerWidth/window.innerHeight;if(.45<a&&a<=.6)var o=window.innerWidth/720;else if(.6<a)var o=window.innerHeight/1200;else var l=window.innerWidth/720,c=window.innerHeight/1600,o=Math.min(l,c);n&&(n.style.width=`${720*o}px`,n.style.height=`${1600*o}px`)}function sl(){console.log("onPause called"),ie().pause(),executive.stop()}function rl(){console.log("onResume called"),ytgame!=null&&ytgame.IN_PLAYABLES_ENV&&ie().syncYtSoundState(),ie().resume(),executive.start()}async function Lx(){ytgame!=null&&ytgame.SDK_VERSION&&console.log(`YT, GAME version: ${ytgame.SDK_VERSION}`),window.addEventListener("resize",il),il(),new Ex(RF_FONT_FAMILY).load().then(()=>{bm(),Mm(),Em(),Z0(),Rx(),Om(),sa(),sa(),sa(),ox(),lx(),ux(),_x(),mx(),yx(),Tx(),bx(),Px(),wx(),Pm(),_m().then(()=>{console.log("RF_PACMAN_VERSION: "+RF_PACMAN_VERSION),Yg(),gameMode=GAME_PACMAN,switchState(loadingState),executive.init(),ytgame==null||ytgame.system.onPause(()=>{sl()}),ytgame==null||ytgame.system.onResume(()=>{rl()}),RF_DEBUG_CONFIG_KEYS&&(Dg(()=>{sl()}),Hg(()=>{rl()})),ytgame==null||ytgame.game.firstFrameReady()})})}Lx();export{Rh as $,jl as A,Je as B,de as C,ue as D,W as E,oh as F,lh as G,Af as H,Rn as I,Ae as J,bl as K,oe as L,re as M,ae as N,cp as O,Ue as P,Ip as Q,ke as R,Ap as S,kt as T,Hr as U,ds as V,ii as W,T_ as X,Ca as Y,ac as Z,gh as _,Yt as a,k_ as a0,ps as a1,pe as a2,Qd as a3,Ea as a4,Mh as a5,hc as a6,wp as b,js as c,Df as d,ze as e,_h as f,ec as g,Vl as h,Fl as i,ni as j,Ch as k,q as l,Gf as m,qo as n,Zd as o,Ep as p,Fp as q,uf as r,ei as s,wl as t,Ge as u,zt as v,Ee as w,j as x,Uf as y,np as z};
